function getPasteEvent(){var e=document.createElement("input"),t="onpaste";e.setAttribute(t,"");return typeof e[t]==="function"?"paste":"input"}function fuelTextExactCI(e,t){return(e.textContent||e.innerText||$(e).text()||"").toLowerCase()===(t||"").toLowerCase()}function timeAgo(e){switch(typeof e){case"number":break;case"string":e=+(new Date(e));break;case"object":if(e.constructor===Date){e=e.getTime()}break;default:e=+(new Date)}var t=[[60,"seconds",1],[120,"1 minute ago","1 minute from now"],[3600,"minutes",60],[7200,"1 hour ago","1 hour from now"],[86400,"hours",3600],[172800,"Yesterday","Tomorrow"],[604800,"days",86400],[1209600,"Last week","Next week"],[2419200,"weeks",604800],[4838400,"Last month","Next month"],[29030400,"months",2419200],[58060800,"Last year","Next year"],[290304e4,"years",29030400],[580608e4,"Last century","Next century"],[580608e5,"centuries",290304e4]];var n=(+(new Date)-e)/1e3,r="ago",i=1;if(Math.floor(n)===0){return"Just now"}if(n<0){n=Math.abs(n);r="from now";i=2}var s=0,o;while(o=t[s++]){if(n<o[0]){if(typeof o[2]=="string"){return o[i]}else{return Math.floor(n/o[2])+" "+o[1]+" "+r}}}return e}(function(){var e=Math,t=function(e){return e>>0},n=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"",r=/android/gi.test(navigator.appVersion),i=/iphone|ipad/gi.test(navigator.appVersion),s=/playbook/gi.test(navigator.appVersion),o=/hp-tablet/gi.test(navigator.appVersion),u="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,a="ontouchstart"in window&&!o,f=n+"Transform"in document.documentElement.style,l=i||s,c=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,17)}}(),h=function(){return window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}(),p="onorientationchange"in window?"orientationchange":"resize",d=a?"touchstart":"mousedown",v=a?"touchmove":"mousemove",m=a?"touchend":"mouseup",g=a?"touchcancel":"mouseup",y="translate"+(u?"3d(":"("),b=u?",0)":")",w=function(e,t){var r=this,i=document,s;r.wrapper=typeof e=="object"?e:i.getElementById(e);r.wrapper.style.overflow="hidden";r.scroller=r.wrapper.children[0];r.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,onRefresh:null,onBeforeScrollStart:function(e){e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(s in t){r.options[s]=t[s]}r.x=r.options.x;r.y=r.options.y;r.options.useTransform=f?r.options.useTransform:false;r.options.hScrollbar=r.options.hScroll&&r.options.hScrollbar;r.options.vScrollbar=r.options.vScroll&&r.options.vScrollbar;r.options.useTransition=l&&r.options.useTransition;r.scroller.style[n+"TransitionProperty"]=r.options.useTransform?"-"+n.toLowerCase()+"-transform":"top left";r.scroller.style[n+"TransitionDuration"]="0";r.scroller.style[n+"TransformOrigin"]="0 0";if(r.options.useTransition){r.scroller.style[n+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"}if(r.options.useTransform){r.scroller.style[n+"Transform"]=y+r.x+"px,"+r.y+"px"+b}else{r.scroller.style.cssText+=";position:absolute;top:"+r.y+"px;left:"+r.x+"px"}r.refresh();r._bind(p,window);r._bind(d);if(!a){r._bind("mouseout",r.wrapper)}};w.prototype={enabled:true,x:0,y:0,steps:[],scale:1,handleEvent:function(e){var t=this;switch(e.type){case d:if(!a&&e.button!==0){return}t._start(e);break;case v:t._move(e);break;case m:case g:t._end(e);break;case p:t._resize();break;case"mouseout":t._mouseout(e);break;case"webkitTransitionEnd":t._transitionEnd(e);break}},_resize:function(){this.refresh()},_pos:function(e,r){e=this.hScroll?e:0;r=this.vScroll?r:0;if(this.options.useTransform){this.scroller.style[n+"Transform"]=y+e+"px,"+r+"px"+b+" scale("+this.scale+")"}else{e=t(e);r=t(r);this.scroller.style.left=e+"px";this.scroller.style.top=r+"px"}this.x=e;this.y=r},_start:function(e){var t=this,r=a?e.touches[0]:e,i,s,o;if(!t.enabled){return}if(t.options.onBeforeScrollStart){t.options.onBeforeScrollStart.call(t,e)}if(t.options.useTransition){t._transitionTime(0)}t.moved=false;t.animating=false;t.zoomed=false;t.distX=0;t.distY=0;t.absDistX=0;t.absDistY=0;t.dirX=0;t.dirY=0;if(t.options.momentum){if(t.options.useTransform){i=getComputedStyle(t.scroller,null)[n+"Transform"].replace(/[^0-9-.,]/g,"").split(",");s=i[4]*1;o=i[5]*1}else{s=getComputedStyle(t.scroller,null).left.replace(/[^0-9-]/g,"")*1;o=getComputedStyle(t.scroller,null).top.replace(/[^0-9-]/g,"")*1}if(s!=t.x||o!=t.y){if(t.options.useTransition){t._unbind("webkitTransitionEnd")}else{h(t.aniTime)}t.steps=[];t._pos(s,o)}}t.startX=t.x;t.startY=t.y;t.pointX=r.pageX;t.pointY=r.pageY;t.startTime=e.timeStamp||Date.now();if(t.options.onScrollStart){t.options.onScrollStart.call(t,e)}t._bind(v);t._bind(m);t._bind(g)},_move:function(t){var n=this,r=a?t.touches[0]:t,i=r.pageX-n.pointX,s=r.pageY-n.pointY,o=n.x+i,u=n.y+s,f=t.timeStamp||Date.now();if(n.options.onBeforeScrollMove){n.options.onBeforeScrollMove.call(n,t)}n.pointX=r.pageX;n.pointY=r.pageY;if(o>0||o<n.maxScrollX){o=n.options.bounce?n.x+i/2:o>=0||n.maxScrollX>=0?0:n.maxScrollX}if(u>0||u<n.maxScrollY){u=n.options.bounce?n.y+s/2:u>=0||n.maxScrollY>=0?0:n.maxScrollY}n.distX+=i;n.distY+=s;n.absDistX=e.abs(n.distX);n.absDistY=e.abs(n.distY);if(n.absDistX<6&&n.absDistY<6){return}if(n.options.lockDirection){if(n.absDistX>n.absDistY+5){u=n.y;s=0}else{if(n.absDistY>n.absDistX+5){o=n.x;i=0}}}n.moved=true;n._pos(o,u);n.dirX=i>0?-1:i<0?1:0;n.dirY=s>0?-1:s<0?1:0;if(f-n.startTime>300){n.startTime=f;n.startX=n.x;n.startY=n.y}if(n.options.onScrollMove){n.options.onScrollMove.call(n,t)}},_end:function(n){if(a&&n.touches.length!=0){return}var r=this,i=a?n.changedTouches[0]:n,s,o,u={dist:0,time:0},f={dist:0,time:0},l=(n.timeStamp||Date.now())-r.startTime,c=r.x,h=r.y,p;r._unbind(v);r._unbind(m);r._unbind(g);if(r.options.onBeforeScrollEnd){r.options.onBeforeScrollEnd.call(r,n)}if(!r.moved){if(a){s=i.target;while(s.nodeType!=1){s=s.parentNode}if(s.tagName!="SELECT"&&s.tagName!="INPUT"&&s.tagName!="TEXTAREA"){o=document.createEvent("MouseEvents");o.initMouseEvent("click",true,true,n.view,1,i.screenX,i.screenY,i.clientX,i.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,0,null);o._fake=true;s.dispatchEvent(o)}}r._resetPos(200);if(r.options.onTouchEnd){r.options.onTouchEnd.call(r,n)}return}if(l<300&&r.options.momentum){u=c?r._momentum(c-r.startX,l,-r.x,r.scrollerW-r.wrapperW+r.x,r.options.bounce?r.wrapperW:0):u;f=h?r._momentum(h-r.startY,l,-r.y,r.maxScrollY<0?r.scrollerH-r.wrapperH+r.y:0,r.options.bounce?r.wrapperH:0):f;c=r.x+u.dist;h=r.y+f.dist;if(r.x>0&&c>0||r.x<r.maxScrollX&&c<r.maxScrollX){u={dist:0,time:0}}if(r.y>0&&h>0||r.y<r.maxScrollY&&h<r.maxScrollY){f={dist:0,time:0}}}if(u.dist||f.dist){p=e.max(e.max(u.time,f.time),10);r.scrollTo(t(c),t(h),p);if(r.options.onTouchEnd){r.options.onTouchEnd.call(r,n)}return}r._resetPos(200);if(r.options.onTouchEnd){r.options.onTouchEnd.call(r,n)}},_resetPos:function(e){var t=this,n=t.x>=0?0:t.x<t.maxScrollX?t.maxScrollX:t.x,r=t.y>=0||t.maxScrollY>0?0:t.y<t.maxScrollY?t.maxScrollY:t.y;if(n==t.x&&r==t.y){if(t.moved){if(t.options.onScrollEnd){t.options.onScrollEnd.call(t)}t.moved=false}return}t.scrollTo(n,r,e||0)},_mouseout:function(e){var t=e.relatedTarget;if(!t){this._end(e);return}while(t=t.parentNode){if(t==this.wrapper){return}}this._end(e)},_transitionEnd:function(e){var t=this;if(e.target!=t.scroller){return}t._unbind("webkitTransitionEnd");t._startAni()},_startAni:function(){var t=this,n=t.x,r=t.y,i=Date.now(),s,o,u;if(t.animating){return}if(!t.steps.length){t._resetPos(400);return}s=t.steps.shift();if(s.x==n&&s.y==r){s.time=0}t.animating=true;t.moved=true;if(t.options.useTransition){t._transitionTime(s.time);t._pos(s.x,s.y);t.animating=false;if(s.time){t._bind("webkitTransitionEnd")}else{t._resetPos(0)}return}u=function(){var a=Date.now(),f,l;if(a>=i+s.time){t._pos(s.x,s.y);t.animating=false;if(t.options.onAnimationEnd){t.options.onAnimationEnd.call(t)}t._startAni();return}a=(a-i)/s.time-1;o=e.sqrt(1-a*a);f=(s.x-n)*o+n;l=(s.y-r)*o+r;t._pos(f,l);if(t.animating){t.aniTime=c(u)}};u()},_transitionTime:function(e){this.scroller.style[n+"TransitionDuration"]=e+"ms"},_momentum:function(n,r,i,s,o){var u=6e-4,a=e.abs(n)/r,f=a*a/(2*u),l=0,c=0;if(n>0&&f>i){c=o/(6/(f/a*u));i=i+c;a=a*i/f;f=i}else{if(n<0&&f>s){c=o/(6/(f/a*u));s=s+c;a=a*s/f;f=s}}f=f*(n<0?-1:1);l=a/u;return{dist:f,time:t(l)}},_offset:function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent){t-=e.offsetLeft;n-=e.offsetTop}return{left:t,top:n}},_bind:function(e,t,n){(t||this.scroller).addEventListener(e,this,!!n)},_unbind:function(e,t,n){(t||this.scroller).removeEventListener(e,this,!!n)},destroy:function(){var e=this;e.scroller.style[n+"Transform"]="";e._unbind(p,window);e._unbind(d);e._unbind(v);e._unbind(m);e._unbind(g);e._unbind("mouseout",e.wrapper);if(e.options.useTransition){e._unbind("webkitTransitionEnd")}if(e.options.onDestroy){e.options.onDestroy.call(e)}},refresh:function(){var e=this,t;e.wrapperW=e.wrapper.clientWidth;e.wrapperH=e.wrapper.clientHeight;e.scrollerW=e.scroller.offsetWidth;e.scrollerH=e.scroller.offsetHeight;e.maxScrollX=e.wrapperW-e.scrollerW;e.maxScrollY=e.wrapperH-e.scrollerH;e.dirX=0;e.dirY=0;e.hScroll=e.options.hScroll&&e.maxScrollX<0;e.vScroll=e.options.vScroll&&(!e.options.bounceLock&&!e.hScroll||e.scrollerH>e.wrapperH);t=e._offset(e.wrapper);e.wrapperOffsetLeft=-t.left;e.wrapperOffsetTop=-t.top;e.scroller.style[n+"TransitionDuration"]="0";e._resetPos(200)},scrollTo:function(e,t,n,r){var i=this,s=e,o,u;i.stop();if(!s.length){s=[{x:e,y:t,time:n,relative:r}]}for(o=0,u=s.length;o<u;o++){if(s[o].relative){s[o].x=i.x-s[o].x;s[o].y=i.y-s[o].y}i.steps.push({x:s[o].x,y:s[o].y,time:s[o].time||0})}i._startAni()},scrollToElement:function(t,n){var r=this,i;t=t.nodeType?t:r.scroller.querySelector(t);if(!t){return}i=r._offset(t);i.left+=r.wrapperOffsetLeft;i.top+=r.wrapperOffsetTop;i.left=i.left>0?0:i.left<r.maxScrollX?r.maxScrollX:i.left;i.top=i.top>0?0:i.top<r.maxScrollY?r.maxScrollY:i.top;n=n===undefined?e.max(e.abs(i.left)*2,e.abs(i.top)*2):n;r.scrollTo(i.left,i.top,n)},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(v);this._unbind(m);this._unbind(g)},enable:function(){this.enabled=true},stop:function(){h(this.aniTime);this.steps=[];this.moved=false;this.animating=false}};if(typeof exports!=="undefined"){exports.iScroll=w}else{window.iScroll=w}})();!function(e){var t=function(e){this.value={h:1,s:1,b:1,a:1};this.setColor(e)};t.prototype={constructor:t,setColor:function(t){t=t.toLowerCase();var n=this;e.each(r.stringParsers,function(e,i){var s=i.re.exec(t),o=s&&i.parse(s),u=i.space||"rgba";if(o){if(u==="hsla"){n.value=r.RGBtoHSB.apply(null,r.HSLtoRGB.apply(null,o))}else{n.value=r.RGBtoHSB.apply(null,o)}return false}})},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setLightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=parseInt((1-e)*100,10)/100},toRGB:function(e,t,n,r){if(!e){e=this.value.h;t=this.value.s;n=this.value.b}e*=360;var i,s,o,u,a;e=e%360/60;a=n*t;u=a*(1-Math.abs(e%2-1));i=s=o=n-a;e=~~e;i+=[a,u,0,0,u,a][e];s+=[u,a,a,u,0,0][e];o+=[0,0,u,a,a,u][e];return{r:Math.round(i*255),g:Math.round(s*255),b:Math.round(o*255),a:r||this.value.a}},toHex:function(e,t,n,r){var i=this.toRGB(e,t,n,r);return"#"+(1<<24|parseInt(i.r)<<16|parseInt(i.g)<<8|parseInt(i.b)).toString(16).substr(1)},toHSL:function(e,t,n,r){if(!e){e=this.value.h;t=this.value.s;n=this.value.b}var i=e,s=(2-t)*n,o=t*n;if(s>0&&s<=1){o/=s}else{o/=2-s}s/=2;if(o>1){o=1}return{h:i,s:o,l:s,a:r||this.value.a}}};var n=function(t,n){this.element=e(t);var i=n.format||this.element.data("color-format")||"hex";this.format=r.translateFormats[i];this.isInput=this.element.is("input");this.component=this.element.is(".color")?this.element.find(".add-on"):false;this.picker=e(r.template).appendTo("body").on("mousedown",e.proxy(this.mousedown,this));if(this.isInput){this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this)})}else{if(this.component){this.component.on({click:e.proxy(this.show,this)})}else{this.element.on({click:e.proxy(this.show,this)})}}if(i==="rgba"||i==="hsla"){this.picker.addClass("alpha");this.alpha=this.picker.find(".colorpicker-alpha")[0].style}if(this.component){this.picker.find(".colorpicker-color").hide();this.preview=this.element.find("i")[0].style}else{this.preview=this.picker.find("div:last")[0].style}this.base=this.picker.find("div:first")[0].style;this.update()};n.prototype={constructor:n,show:function(t){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();e(window).on("resize",e.proxy(this.place,this));if(!this.isInput){if(t){t.stopPropagation();t.preventDefault()}}e(document).on({mousedown:e.proxy(this.hide,this)});this.element.trigger({type:"show",color:this.color})},update:function(){this.color=new t(this.isInput?this.element.prop("value"):this.element.data("color"));this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor()},setValue:function(e){this.color=new t(e);this.picker.find("i").eq(0).css({left:this.color.value.s*100,top:100-this.color.value.b*100}).end().eq(1).css("top",100*(1-this.color.value.h)).end().eq(2).css("top",100*(1-this.color.value.a));this.previewColor();this.element.trigger({type:"changeColor",color:this.color})},hide:function(){this.picker.hide();e(window).off("resize",this.place);if(!this.isInput){e(document).off({mousedown:this.hide});if(this.component){this.element.find("input").prop("value",this.format.call(this))}this.element.data("color",this.format.call(this))}else{this.element.prop("value",this.format.call(this))}this.element.trigger({type:"hide",color:this.color})},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},previewColor:function(){try{this.preview.backgroundColor=this.format.call(this)}catch(e){this.preview.backgroundColor=this.color.toHex()}this.base.backgroundColor=this.color.toHex(this.color.value.h,1,1,1);if(this.alpha){this.alpha.backgroundColor=this.color.toHex()}},pointer:null,slider:null,mousedown:function(t){t.stopPropagation();t.preventDefault();var n=e(t.target);var i=n.closest("div");if(!i.is(".colorpicker")){if(i.is(".colorpicker-saturation")){this.slider=e.extend({},r.sliders.saturation)}else{if(i.is(".colorpicker-hue")){this.slider=e.extend({},r.sliders.hue)}else{if(i.is(".colorpicker-alpha")){this.slider=e.extend({},r.sliders.alpha)}else{return false}}}var s=i.offset();this.slider.knob=i.find("i")[0].style;this.slider.left=t.pageX-s.left;this.slider.top=t.pageY-s.top;this.pointer={left:t.pageX,top:t.pageY};e(document).on({mousemove:e.proxy(this.mousemove,this),mouseup:e.proxy(this.mouseup,this)}).trigger("mousemove")}return false},mousemove:function(e){e.stopPropagation();e.preventDefault();var t=Math.max(0,Math.min(this.slider.maxLeft,this.slider.left+((e.pageX||this.pointer.left)-this.pointer.left)));var n=Math.max(0,Math.min(this.slider.maxTop,this.slider.top+((e.pageY||this.pointer.top)-this.pointer.top)));this.slider.knob.left=t+"px";this.slider.knob.top=n+"px";if(this.slider.callLeft){this.color[this.slider.callLeft].call(this.color,t/100)}if(this.slider.callTop){this.color[this.slider.callTop].call(this.color,n/100)}this.previewColor();this.element.trigger({type:"changeColor",color:this.color});return false},mouseup:function(t){t.stopPropagation();t.preventDefault();e(document).off({mousemove:this.mousemove,mouseup:this.mouseup});return false}};e.fn.colorpicker=function(t,r){return this.each(function(){var i=e(this),s=i.data("colorpicker"),o=typeof t==="object"&&t;if(!s){i.data("colorpicker",s=new n(this,e.extend({},e.fn.colorpicker.defaults,o)))}if(typeof t==="string"){s[t](r)}})};e.fn.colorpicker.defaults={};e.fn.colorpicker.Constructor=n;var r={translateFormats:{rgb:function(){var e=this.color.toRGB();return"rgb("+e.r+","+e.g+","+e.b+")"},rgba:function(){var e=this.color.toRGB();return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},hsl:function(){var e=this.color.toHSL();return"hsl("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%)"},hsla:function(){var e=this.color.toHSL();return"hsla("+Math.round(e.h*360)+","+Math.round(e.s*100)+"%,"+Math.round(e.l*100)+"%,"+e.a+")"},hex:function(){return this.color.toHex()}},sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},hue:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:false,callTop:"setAlpha"}},RGBtoHSB:function(e,t,n,r){e/=255;t/=255;n/=255;var i,s,o,u;o=Math.max(e,t,n);u=o-Math.min(e,t,n);i=u===0?null:o==e?(t-n)/u:o==t?(n-e)/u+2:(e-t)/u+4;i=(i+360)%6*60/360;s=u===0?0:u/o;return{h:i||1,s:s,b:o,a:r||1}},HueToRGB:function(e,t,n){if(n<0){n+=1}else{if(n>1){n-=1}}if(n*6<1){return e+(t-e)*n*6}else{if(n*2<1){return t}else{if(n*3<2){return e+(t-e)*(2/3-n)*6}else{return e}}}},HSLtoRGB:function(e,t,n,i){if(t<0){t=0}var s;if(n<=.5){s=n*(1+t)}else{s=n+t-n*t}var o=2*n-s;var u=e+1/3;var a=e;var f=e-1/3;var l=Math.round(r.HueToRGB(o,s,u)*255);var h=Math.round(r.HueToRGB(o,s,a)*255);var p=Math.round(r.HueToRGB(o,s,f)*255);return[l,h,p,i||1]},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}}],template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div></div>'}}(window.jQuery);!function(e){var t=function(t,r){this.element=e(t);this.format=n.parseFormat(r.format||this.element.data("date-format")||"mm/dd/yyyy");this.picker=e(n.template).appendTo("body").on({click:e.proxy(this.click,this)});this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;if(this.isInput){this.element.on({focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this)})}else{if(this.component){this.component.on("click",e.proxy(this.show,this))}else{this.element.on("click",e.proxy(this.show,this))}}this.minViewMode=r.minViewMode||this.element.data("date-minviewmode")||0;if(typeof this.minViewMode==="string"){switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0;break}}this.viewMode=r.viewMode||this.element.data("date-viewmode")||0;if(typeof this.viewMode==="string"){switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0;break}}this.startViewMode=this.viewMode;this.weekStart=r.weekStart||this.element.data("date-weekstart")||0;this.weekEnd=this.weekStart===0?6:this.weekStart-1;this.onRender=r.onRender;this.fillDow();this.fillMonths();this.update();this.showMode()};t.prototype={constructor:t,show:function(t){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();e(window).on("resize",e.proxy(this.place,this));if(t){t.stopPropagation();t.preventDefault()}if(!this.isInput){}var n=this;e(document).on("mousedown",function(t){if(e(t.target).closest(".datepicker").length==0){n.hide()}});this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide();e(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){e(document).off("mousedown",this.hide)}this.element.trigger({type:"hide",date:this.date})},set:function(){var e=n.formatDate(this.date,this.format);if(!this.isInput){if(this.component){this.element.find("input").prop("value",e)}this.element.data("date",e)}else{this.element.prop("value",e)}},setValue:function(e){if(typeof e==="string"){this.date=n.parseDate(e,this.format)}else{this.date=new Date(e)}this.set();this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},place:function(){var e=this.component?this.component.offset():this.element.offset();this.picker.css({top:e.top+this.height,left:e.left})},update:function(e){this.date=n.parseDate(typeof e==="string"?e:this.isInput?this.element.prop("value"):this.element.data("date"),this.format);this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},fillDow:function(){var e=this.weekStart;var t="<tr>";while(e<this.weekStart+7){t+='<th class="dow">'+n.dates.daysMin[e++%7]+"</th>"}t+="</tr>";this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){var e="";var t=0;while(t<12){e+='<span class="month">'+n.dates.monthsShort[t++]+"</span>"}this.picker.find(".datepicker-months td").append(e)},fill:function(){var e=new Date(this.viewDate),t=e.getFullYear(),r=e.getMonth(),i=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(n.dates.months[r]+" "+t);var s=new Date(t,r-1,28,0,0,0,0),o=n.getDaysInMonth(s.getFullYear(),s.getMonth());s.setDate(o);s.setDate(o-(s.getDay()-this.weekStart+7)%7);var u=new Date(s);u.setDate(u.getDate()+42);u=u.valueOf();var a=[];var f,l,h;while(s.valueOf()<u){if(s.getDay()===this.weekStart){a.push("<tr>")}f=this.onRender(s);l=s.getFullYear();h=s.getMonth();if(h<r&&l===t||l<t){f+=" old"}else{if(h>r&&l===t||l>t){f+=" new"}}if(s.valueOf()===i){f+=" active"}a.push('<td class="day '+f+'">'+s.getDate()+"</td>");if(s.getDay()===this.weekEnd){a.push("</tr>")}s.setDate(s.getDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(a.join(""));var p=this.date.getFullYear();var d=this.picker.find(".datepicker-months").find("th:eq(1)").text(t).end().find("span").removeClass("active");if(p===t){d.eq(this.date.getMonth()).addClass("active")}a="";t=parseInt(t/10,10)*10;var v=this.picker.find(".datepicker-years").find("th:eq(1)").text(t+"-"+(t+9)).end().find("td");t-=1;for(var m=-1;m<11;m++){a+='<span class="year'+(m===-1||m===10?" old":"")+(p===t?" active":"")+'">'+t+"</span>";t+=1}v.html(a)},click:function(t){t.stopPropagation();t.preventDefault();var r=e(t.target).closest("span, td, th");if(r.length===1){switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+n.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+n.modes[this.viewMode].navFnc].call(this.viewDate)+n.modes[this.viewMode].navStep*(r[0].className==="prev"?-1:1));this.fill();this.set();break}break;case"span":if(r.is(".month")){var i=r.parent().find("span").index(r);this.viewDate.setMonth(i)}else{var s=parseInt(r.text(),10)||0;this.viewDate.setFullYear(s)}if(this.viewMode!==0){this.date=new Date(this.viewDate);this.element.trigger({type:"changeDate",date:this.date,viewMode:n.modes[this.viewMode].clsName})}this.showMode(-1);this.fill();this.set();break;case"td":if(r.is(".day")&&!r.is(".disabled")){var o=parseInt(r.text(),10)||1;var i=this.viewDate.getMonth();if(r.is(".old")){i-=1}else{if(r.is(".new")){i+=1}}var s=this.viewDate.getFullYear();this.date=new Date(s,i,o,0,0,0,0);this.viewDate=new Date(s,i,Math.min(28,o),0,0,0,0);this.fill();this.set();this.element.trigger({type:"changeDate",date:this.date,viewMode:n.modes[this.viewMode].clsName})}break}}},mousedown:function(e){e.stopPropagation();e.preventDefault()},showMode:function(e){if(e){this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+e))}this.picker.find(">div").hide().filter(".datepicker-"+n.modes[this.viewMode].clsName).show()}};e.fn.datepicker=function(n,r){return this.each(function(){var i=e(this),s=i.data("datepicker"),o=typeof n==="object"&&n;if(!s){i.data("datepicker",s=new t(this,e.extend({},e.fn.datepicker.defaults,o)))}if(typeof n==="string"){s[n](r)}})};e.fn.datepicker.defaults={onRender:function(e){return""}};e.fn.datepicker.Constructor=t;var n={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,n.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},parseFormat:function(e){var t=e.match(/[.\/\-\s].*?/),n=e.split(/\W+/);if(!t||!n||n.length===0){throw new Error("Invalid date format.")}return{separator:t,parts:n}},parseDate:function(e,t){var n=e.split(t.separator),e=new Date,r;e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0);if(n.length===t.parts.length){var i=e.getFullYear(),s=e.getDate(),o=e.getMonth();for(var u=0,a=t.parts.length;u<a;u++){r=parseInt(n[u],10)||1;switch(t.parts[u]){case"dd":case"d":s=r;e.setDate(r);break;case"mm":case"m":o=r-1;e.setMonth(r-1);break;case"yy":i=2e3+r;e.setFullYear(2e3+r);break;case"yyyy":i=r;e.setFullYear(r);break}}e=new Date(i,o,s,0,0,0)}return e},formatDate:function(e,t){var n={d:e.getDate(),m:e.getMonth()+1,yy:e.getFullYear().toString().substring(2),yyyy:e.getFullYear()};n.dd=(n.d<10?"0":"")+n.d;n.mm=(n.m<10?"0":"")+n.m;var e=[];for(var r=0,i=t.parts.length;r<i;r++){e.push(n[t.parts[r]])}return e.join(t.separator)},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};n.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+n.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+n.headTemplate+n.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+n.headTemplate+n.contTemplate+"</table></div></div>"}(window.jQuery);(function(e,t,n,r){var i=function(t,n){this.widget="";this.$element=e(t);this.defaultTime=n.defaultTime;this.disableFocus=n.disableFocus;this.isOpen=n.isOpen;this.minuteStep=n.minuteStep;this.modalBackdrop=n.modalBackdrop;this.secondStep=n.secondStep;this.showInputs=n.showInputs;this.showMeridian=n.showMeridian;this.showSeconds=n.showSeconds;this.template=n.template;this.appendWidgetTo=n.appendWidgetTo;this._init()};i.prototype={constructor:i,_init:function(){var t=this;if(this.$element.parent().hasClass("input-append")||this.$element.parent().hasClass("input-prepend")){this.$element.parent(".input-append, .input-prepend").find(".add-on").on({"click.timepicker":e.proxy(this.showWidget,this)});this.$element.on({"focus.timepicker":e.proxy(this.highlightUnit,this),"click.timepicker":e.proxy(this.highlightUnit,this),"keydown.timepicker":e.proxy(this.elementKeydown,this),"blur.timepicker":e.proxy(this.blurElement,this)})}else{if(this.template){this.$element.on({"focus.timepicker":e.proxy(this.showWidget,this),"click.timepicker":e.proxy(this.showWidget,this),"blur.timepicker":e.proxy(this.blurElement,this)})}else{this.$element.on({"focus.timepicker":e.proxy(this.highlightUnit,this),"click.timepicker":e.proxy(this.highlightUnit,this),"keydown.timepicker":e.proxy(this.elementKeydown,this),"blur.timepicker":e.proxy(this.blurElement,this)})}}if(this.template!==false){this.$widget=e(this.getTemplate()).prependTo(this.$element.parents(this.appendWidgetTo)).on("click",e.proxy(this.widgetClick,this))}else{this.$widget=false}if(this.showInputs&&this.$widget!==false){this.$widget.find("input").each(function(){e(this).on({"click.timepicker":function(){e(this).select()},"keydown.timepicker":e.proxy(t.widgetKeydown,t)})})}this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=r;this.updateFromElementVal()},decrementHour:function(){if(this.showMeridian){if(this.hour===1){this.hour=12}else{if(this.hour===12){this.hour--;return this.toggleMeridian()}else{if(this.hour===0){this.hour=11;return this.toggleMeridian()}else{this.hour--}}}}else{if(this.hour===0){this.hour=23}else{this.hour--}}this.update()},decrementMinute:function(e){var t;if(e){t=this.minute-e}else{t=this.minute-this.minuteStep}if(t<0){this.decrementHour();this.minute=t+60}else{this.minute=t}this.update()},decrementSecond:function(){var e=this.second-this.secondStep;if(e<0){this.decrementMinute(true);this.second=e+60}else{this.second=e}this.update()},elementKeydown:function(e){switch(e.keyCode){case 9:this.updateFromElementVal();switch(this.highlightedUnit){case"hour":e.preventDefault();this.highlightNextUnit();break;case"minute":if(this.showMeridian||this.showSeconds){e.preventDefault();this.highlightNextUnit()}break;case"second":if(this.showMeridian){e.preventDefault();this.highlightNextUnit()}break}break;case 27:this.updateFromElementVal();break;case 37:e.preventDefault();this.highlightPrevUnit();this.updateFromElementVal();break;case 38:e.preventDefault();switch(this.highlightedUnit){case"hour":this.incrementHour();this.highlightHour();break;case"minute":this.incrementMinute();this.highlightMinute();break;case"second":this.incrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}break;case 39:e.preventDefault();this.updateFromElementVal();this.highlightNextUnit();break;case 40:e.preventDefault();switch(this.highlightedUnit){case"hour":this.decrementHour();this.highlightHour();break;case"minute":this.decrementMinute();this.highlightMinute();break;case"second":this.decrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}break}},formatTime:function(e,t,n,r){e=e<10?"0"+e:e;t=t<10?"0"+t:t;n=n<10?"0"+n:n;return e+":"+t+(this.showSeconds?":"+n:"")+(this.showMeridian?" "+r:"")},getCursorPosition:function(){var e=this.$element.get(0);if("selectionStart"in e){return e.selectionStart}else{if(n.selection){e.focus();var t=n.selection.createRange(),r=n.selection.createRange().text.length;t.moveStart("character",-e.value.length);return t.text.length-r}}},getTemplate:function(){var e,t,n,r,i,s;if(this.showInputs){t='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>';n='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>';r='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>';i='<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>'}else{t='<span class="bootstrap-timepicker-hour"></span>';n='<span class="bootstrap-timepicker-minute"></span>';r='<span class="bootstrap-timepicker-second"></span>';i='<span class="bootstrap-timepicker-meridian"></span>'}s='<table><tr><td><a href="#" data-action="incrementHour"><i class="icon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="icon-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="icon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+t+'</td> <td class="separator">:</td><td>'+n+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+r+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+i+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="icon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="icon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="icon-chevron-down"></i></a></td>':"")+"</tr></table>";switch(this.template){case"modal":e='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">Ã—</a><h3>Pick a Time</h3></div><div class="modal-content">'+s+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":e='<div class="bootstrap-timepicker-widget dropdown-menu">'+s+"</div>";break}return e},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},hideWidget:function(){if(this.isOpen===false){return}if(this.showInputs){this.updateFromWidgetInputs()}this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}e(n).off("mousedown.timepicker");this.isOpen=false},highlightUnit:function(){this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}}break;case"second":if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){var e=this.$element.get(0);this.highlightedUnit="hour";if(e.setSelectionRange){setTimeout(function(){e.setSelectionRange(0,2)},0)}},highlightMinute:function(){var e=this.$element.get(0);this.highlightedUnit="minute";if(e.setSelectionRange){setTimeout(function(){e.setSelectionRange(3,5)},0)}},highlightSecond:function(){var e=this.$element.get(0);this.highlightedUnit="second";if(e.setSelectionRange){setTimeout(function(){e.setSelectionRange(6,8)},0)}},highlightMeridian:function(){var e=this.$element.get(0);this.highlightedUnit="meridian";if(e.setSelectionRange){if(this.showSeconds){setTimeout(function(){e.setSelectionRange(9,11)},0)}else{setTimeout(function(){e.setSelectionRange(6,8)},0)}}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.hour++;return this.toggleMeridian()}else{if(this.hour===12){this.hour=0}}}if(this.hour===23){this.hour=0;return}this.hour++;this.update()},incrementMinute:function(e){var t;if(e){t=this.minute+e}else{t=this.minute+this.minuteStep-this.minute%this.minuteStep}if(t>59){this.incrementHour();this.minute=t-60}else{this.minute=t}this.update()},incrementSecond:function(){var e=this.second+this.secondStep-this.second%this.secondStep;if(e>59){this.incrementMinute(true);this.second=e-60}else{this.second=e}this.update()},remove:function(){e("document").off(".timepicker");if(this.$widget){this.$widget.remove()}delete this.$element.data().timepicker},setDefaultTime:function(e){if(!this.$element.val()){if(e==="current"){var t=new Date,n=t.getHours(),r=Math.floor(t.getMinutes()/this.minuteStep)*this.minuteStep,i=Math.floor(t.getSeconds()/this.secondStep)*this.secondStep,s="AM";if(this.showMeridian){if(n===0){n=12}else{if(n>=12){if(n>12){n=n-12}s="PM"}else{s="AM"}}}this.hour=n;this.minute=r;this.second=i;this.meridian=s;this.update()}else{if(e===false){this.hour=0;this.minute=0;this.second=0;this.meridian="AM"}else{this.setTime(e)}}}else{this.updateFromElementVal()}},setTime:function(e){var t,n;if(this.showMeridian){t=e.split(" ");n=t[0].split(":");this.meridian=t[1]}else{n=e.split(":")}this.hour=parseInt(n[0],10);this.minute=parseInt(n[1],10);this.second=parseInt(n[2],10);if(isNaN(this.hour)){this.hour=0}if(isNaN(this.minute)){this.minute=0}if(this.showMeridian){if(this.hour>12){this.hour=12}else{if(this.hour<1){this.hour=12}}if(this.meridian==="am"||this.meridian==="a"){this.meridian="AM"}else{if(this.meridian==="pm"||this.meridian==="p"){this.meridian="PM"}}if(this.meridian!=="AM"&&this.meridian!=="PM"){this.meridian="AM"}}else{if(this.hour>=24){this.hour=23}else{if(this.hour<0){this.hour=0}}}if(this.minute<0){this.minute=0}else{if(this.minute>=60){this.minute=59}}if(this.showSeconds){if(isNaN(this.second)){this.second=0}else{if(this.second<0){this.second=0}else{if(this.second>=60){this.second=59}}}}this.update()},showWidget:function(){if(this.isOpen){return}if(this.$element.is(":disabled")){return}var t=this;e(n).on("mousedown.timepicker",function(n){if(e(n.target).closest(".bootstrap-timepicker-widget").length===0){t.hideWidget()}});this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});if(this.disableFocus){this.$element.blur()}this.updateFromElementVal();if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("show").on("hidden",e.proxy(this.hideWidget,this))}else{if(this.isOpen===false){this.$widget.addClass("open")}}this.isOpen=true},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM";this.update()},update:function(){this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.updateElement();this.updateWidget()},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){var e=this.$element.val();if(e){this.setTime(e)}},updateWidget:function(){if(this.$widget===false){return}var e=this.hour<10?"0"+this.hour:this.hour,t=this.minute<10?"0"+this.minute:this.minute,n=this.second<10?"0"+this.second:this.second;if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(e);this.$widget.find("input.bootstrap-timepicker-minute").val(t);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(n)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(e);this.$widget.find("span.bootstrap-timepicker-minute").text(t);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(n)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromWidgetInputs:function(){if(this.$widget===false){return}var t=e("input.bootstrap-timepicker-hour",this.$widget).val()+":"+e("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+e("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+e("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setTime(t)},widgetClick:function(t){t.stopPropagation();t.preventDefault();var n=e(t.target).closest("a").data("action");if(n){this[n]()}},widgetKeydown:function(t){var n=e(t.target).closest("input"),r=n.attr("name");switch(t.keyCode){case 9:if(this.showMeridian){if(r==="meridian"){return this.hideWidget()}}else{if(this.showSeconds){if(r==="second"){return this.hideWidget()}}else{if(r==="minute"){return this.hideWidget()}}}this.updateFromWidgetInputs();break;case 27:this.hideWidget();break;case 38:t.preventDefault();switch(r){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}break;case 40:t.preventDefault();switch(r){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}break}}};e.fn.timepicker=function(t){var n=Array.apply(null,arguments);n.shift();return this.each(function(){var r=e(this),s=r.data("timepicker"),o=typeof t==="object"&&t;if(!s){r.data("timepicker",s=new i(this,e.extend({},e.fn.timepicker.defaults,o,e(this).data())))}if(typeof t==="string"){s[t].apply(s,n)}})};e.fn.timepicker.defaults={defaultTime:"current",disableFocus:false,isOpen:false,minuteStep:15,modalBackdrop:false,secondStep:15,showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",appendWidgetTo:".bootstrap-timepicker"};e.fn.timepicker.Constructor=i})(jQuery,window,document);(function(e){var t=function(t,n){this.$element=e(t);this.$note=e('<div class="alert"></div>');this.options=e.extend(true,e.fn.notify.defaults,n,this.$element.data());if(this.options.transition){if(this.options.transition=="fade"){this.$note.addClass("in").addClass(this.options.transition)}else{this.$note.addClass(this.options.transition)}}else{this.$note.addClass("fade").addClass("in")}if(this.options.type){this.$note.addClass("alert-"+this.options.type)}else{this.$note.addClass("alert-success")}if(this.options.message){if(typeof this.options.message==="string"){this.$note.html(this.options.message)}else{if(typeof this.options.message==="object"){if(this.options.message.html){this.$note.html(this.options.message.html)}else{if(this.options.message.text){this.$note.text(this.options.message.text)}}}}}if(this.options.closable){var r=e('<a class="close pull-right">&times;</a>')}e(r).on("click",e.proxy(onClose,this));this.$note.prepend(r);return this};onClose=function(){this.options.onClose();e(this.$note).remove();this.options.onClosed()};t.prototype.show=function(){if(this.options.fadeOut.enabled){this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",e.proxy(onClose,this))}this.$element.append(this.$note);this.$note.alert()};t.prototype.hide=function(){if(this.options.fadeOut.enabled){this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",e.proxy(onClose,this))}else{onClose.call(this)}};e.fn.notify=function(e){return new t(this,e)};e.fn.notify.defaults={type:"success",closable:true,transition:"fade",fadeOut:{enabled:true,delay:3e3},message:null,onClose:function(){},onClosed:function(){}}})(window.jQuery);$.fn.toggles=function(e){e=e||{};var t=$.extend({drag:true,click:true,text:{on:"ON",off:"OFF"},on:false,animate:250,transition:"ease-in-out",checkbox:null,clicker:null,width:50,height:20,type:"compact"},e);var n=t.type=="select";t.checkbox=$(t.checkbox);if(t.clicker){t.clicker=$(t.clicker)}var r="margin-left "+t.animate+"ms "+t.transition;var i={"-webkit-transition":r,"-moz-transition":r,transition:r};var s={"-webkit-transition":"","-moz-transition":"",transition:""};var o=function(e,r,o,u){var a=e.toggleClass("active").hasClass("active");if(u===a){return}var l=e.find(".toggle-inner").css(i);e.find(".toggle-off").toggleClass("active");e.find(".toggle-on").toggleClass("active");t.checkbox.prop("checked",a);if(n){return}var h=a?0:-r+o;l.css("margin-left",h);setTimeout(function(){l.css(s);l.css("margin-left",h)},t.animate)};return this.each(function(){var e=$(this);var r=e.height();var i=e.width();if(!r||!i){e.height(r=t.height);e.width(i=t.width)}var s='<div class="toggle-';var u=$(s+'slide">');var a=$(s+'inner">');var l=$(s+'on">');var h=$(s+'off">');var p=$(s+'blob">');var d=r/2;var v=i-d;l.css({height:r,width:v,textAlign:"center",textIndent:n?"":-d,lineHeight:r+"px"}).html(t.text["on"]);h.css({height:r,width:v,marginLeft:n?"":-d,textAlign:"center",textIndent:n?"":d,lineHeight:r+"px"}).html(t.text["off"]).addClass("active");p.css({height:r,width:r,marginLeft:-d});a.css({width:i*2-r,marginLeft:n?0:-i+r});if(n){u.addClass("toggle-select");e.css("width",v*2);p.hide()}e.html(u.html(a.append(l,p,h)));u.on("toggle",function(t,n){if(t){t.stopPropagation()}o(u,i,r);e.trigger("toggle",!n)});e.on("toggleOn",function(){o(u,i,r,false)});e.on("toggleOff",function(){o(u,i,r,true)});if(t.on){o(u,i,r)}if(t.click&&(!t.clicker||!t.clicker.has(e).length)){e.on("click",function(e){if(e.target!=p[0]||!t.drag){u.trigger("toggle",u.hasClass("active"))}})}if(t.clicker){t.clicker.on("click",function(e){if(e.target!=p[0]||!t.drag){u.trigger("toggle",u.hasClass("active"))}})}if(!t.drag||n){return}var m;var g=(i-r)/4;var y=function(n){e.off("mousemove");u.off("mouseleave");p.off("mouseup");var s=u.hasClass("active");if(!m&&t.click&&n.type!=="mouseleave"){u.trigger("toggle",s);return}if(s){if(m<-g){u.trigger("toggle",s)}else{a.animate({marginLeft:0},t.animate/2)}}else{if(m>g){u.trigger("toggle",s)}else{a.animate({marginLeft:-i+r},t.animate/2)}}};var w=-i+r;p.on("mousedown",function(t){m=0;p.off("mouseup");u.off("mouseleave");var n=t.pageX;e.on("mousemove",p,function(e){m=e.pageX-n;var t;if(u.hasClass("active")){t=m;if(m>0){t=0}if(m<w){t=w}}else{t=m+w;if(m<0){t=w}if(m>-w){t=0}}a.css("margin-left",t)});p.on("mouseup",y);u.on("mouseleave",y)})})};var bootbox=window.bootbox||function(e,t){function h(e,t){if(typeof t==="undefined"){t=n}if(typeof c[t][e]==="string"){return c[t][e]}if(t!=r){return h(e,r)}return e}var n="en",r="en",i=true,s="static",o="javascript:;",u="",a={},f={},l={};l.setLocale=function(e){for(var t in c){if(t==e){n=e;return}}throw new Error("Invalid locale: "+e)};l.addLocale=function(e,t){if(typeof c[e]==="undefined"){c[e]={}}for(var n in t){c[e][n]=t[n]}};l.setIcons=function(e){f=e;if(typeof f!=="object"||f===null){f={}}};l.setBtnClasses=function(e){a=e;if(typeof a!=="object"||a===null){a={}}};l.alert=function(){var e="",t=h("OK"),n=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0];if(typeof arguments[1]=="function"){n=arguments[1]}else{t=arguments[1]}break;case 3:e=arguments[0];t=arguments[1];n=arguments[2];break;default:throw new Error("Incorrect number of arguments: expected 1-3")}return l.dialog(e,{label:t,icon:f.OK,"class":a.OK,callback:n},{onEscape:n||true})};l.confirm=function(){var e="",t=h("CANCEL"),n=h("CONFIRM"),r=null;switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0];if(typeof arguments[1]=="function"){r=arguments[1]}else{t=arguments[1]}break;case 3:e=arguments[0];t=arguments[1];if(typeof arguments[2]=="function"){r=arguments[2]}else{n=arguments[2]}break;case 4:e=arguments[0];t=arguments[1];n=arguments[2];r=arguments[3];break;default:throw new Error("Incorrect number of arguments: expected 1-4")}var i=function(){if(typeof r==="function"){return r(false)}};var s=function(){if(typeof r==="function"){return r(true)}};return l.dialog(e,[{label:t,icon:f.CANCEL,"class":a.CANCEL,callback:i},{label:n,icon:f.CONFIRM,"class":a.CONFIRM,callback:s}],{onEscape:i})};l.prompt=function(){var e="",n=h("CANCEL"),r=h("CONFIRM"),i=null,s="";switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0];if(typeof arguments[1]=="function"){i=arguments[1]}else{n=arguments[1]}break;case 3:e=arguments[0];n=arguments[1];if(typeof arguments[2]=="function"){i=arguments[2]}else{r=arguments[2]}break;case 4:e=arguments[0];n=arguments[1];r=arguments[2];i=arguments[3];break;case 5:e=arguments[0];n=arguments[1];r=arguments[2];i=arguments[3];s=arguments[4];break;default:throw new Error("Incorrect number of arguments: expected 1-5")}var o=e;var u=t("<form></form>");u.append("<input class='input-block-level' autocomplete=off type=text value='"+s+"' />");var c=function(){if(typeof i==="function"){return i(null)}};var p=function(){if(typeof i==="function"){return i(u.find("input[type=text]").val())}};var v=l.dialog(u,[{label:n,icon:f.CANCEL,"class":a.CANCEL,callback:c},{label:r,icon:f.CONFIRM,"class":a.CONFIRM,callback:p}],{header:o,show:false,onEscape:c});v.on("shown",function(){u.find("input[type=text]").focus();u.on("submit",function(e){e.preventDefault();v.find(".btn-primary").click()})});v.modal("show");return v};l.dialog=function(n,r,a){function A(e){var t=null;if(typeof a.onEscape==="function"){t=a.onEscape()}if(t!==false){N.modal("hide")}}var f="",l=[];if(!a){a={}}if(typeof r==="undefined"){r=[]}else{if(typeof r.length=="undefined"){r=[r]}}var c=r.length;while(c--){var h=null,p=null,d=null,v="",y=null;if(typeof r[c]["label"]=="undefined"&&typeof r[c]["class"]=="undefined"&&typeof r[c]["callback"]=="undefined"){var w=0,E=null;for(var S in r[c]){E=S;if(++w>1){break}}if(w==1&&typeof r[c][S]=="function"){r[c]["label"]=E;r[c]["callback"]=r[c][S]}}if(typeof r[c]["callback"]=="function"){y=r[c]["callback"]}if(r[c]["class"]){d=r[c]["class"]}else{if(c==r.length-1&&r.length<=2){d="btn-primary"}}if(r[c]["link"]!==true){d="btn "+d}if(r[c]["label"]){h=r[c]["label"]}else{h="Option "+(c+1)}if(r[c]["icon"]){v="<i class='"+r[c]["icon"]+"'></i> "}if(r[c]["href"]){p=r[c]["href"]}else{p=o}f="<a data-handler='"+c+"' class='"+d+"' href='"+p+"'>"+v+""+h+"</a>"+f;l[c]=y}var x=["<div class='bootbox modal' tabindex='-1' style='overflow:hidden;'>"];if(a.header){var T="";if(typeof a.headerCloseButton=="undefined"||a.headerCloseButton){T="<a href='"+o+"' class='close'>&times;</a>"}x.push("<div class='modal-header'>"+T+"<h3>"+a.header+"</h3></div>")}x.push("<div class='modal-body'></div>");if(f){x.push("<div class='modal-footer'>"+f+"</div>")}x.push("</div>");var N=t(x.join("\n"));var C=typeof a.animate==="undefined"?i:a.animate;if(C){N.addClass("fade")}var L=typeof a.classes==="undefined"?u:a.classes;if(L){N.addClass(L)}N.find(".modal-body").html(n);N.on("keyup.dismiss.modal",function(e){if(e.which===27&&a.onEscape){A("escape")}});N.on("click","a.close",function(e){e.preventDefault();A("close")});N.on("shown",function(){N.find("a.btn-primary:first").focus()});N.on("hidden",function(e){if(e.target===this){N.remove()}});N.on("click",".modal-footer a",function(e){var n=t(this).data("handler"),i=l[n],s=null;if(typeof n!=="undefined"&&typeof r[n]["href"]!=="undefined"){return}e.preventDefault();if(typeof i==="function"){s=i(e)}if(s!==false){N.modal("hide")}});t("body").append(N);N.modal({backdrop:typeof a.backdrop==="undefined"?s:a.backdrop,keyboard:false,show:false});N.on("show",function(n){t(e).off("focusin.modal")});if(typeof a.show==="undefined"||a.show===true){N.modal("show")}return N};l.modal=function(){var e;var n;var r;var i={onEscape:null,keyboard:true,backdrop:s};switch(arguments.length){case 1:e=arguments[0];break;case 2:e=arguments[0];if(typeof arguments[1]=="object"){r=arguments[1]}else{n=arguments[1]}break;case 3:e=arguments[0];n=arguments[1];r=arguments[2];break;default:throw new Error("Incorrect number of arguments: expected 1-3")}i.header=n;if(typeof r=="object"){r=t.extend(i,r)}else{r=i}return l.dialog(e,[],r)};l.hideAll=function(){t(".bootbox").modal("hide")};l.animate=function(e){i=e};l.backdrop=function(e){s=e};l.classes=function(e){u=e};var c={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"PotwierdÅº"},ru:{OK:"OK",CANCEL:"ÐžÑ‚Ð¼ÐµÐ½Ð°",CONFIRM:"ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ"},zh_CN:{OK:"OK",CANCEL:"å–æ¶ˆ",CONFIRM:"ç¡®è®¤"},zh_TW:{OK:"OK",CANCEL:"å–æ¶ˆ",CONFIRM:"ç¢ºèª"}};return l}(document,window.jQuery);window.bootbox=bootbox;!function(e){var t=function(e,t){this.cinit("clickover",e,t)};t.prototype=e.extend({},e.fn.popover.Constructor.prototype,{constructor:t,cinit:function(t,n,r){this.attr={};this.attr.me=(Math.random()*10+"").replace(/\D/g,"");this.attr.click_event_ns="click."+this.attr.me+" touchstart."+this.attr.me;if(!r){r={}}r.trigger="manual";this.init(t,n,r);this.$element.on("click",this.options.selector,e.proxy(this.clickery,this))},clickery:function(t){if(t){t.preventDefault();t.stopPropagation()}this.options.width&&this.tip().find(".popover-inner").width(this.options.width);this.options.height&&this.tip().find(".popover-inner").height(this.options.height);this.options.tip_id&&this.tip().attr("id",this.options.tip_id);this.options.class_name&&this.tip().addClass(this.options.class_name);this[this.isShown()?"hide":"show"]();if(this.isShown()){var n=this;this.options.global_close&&e("body").on(this.attr.click_event_ns,function(e){if(!n.tip().has(e.target).length){n.clickery()}});this.options.esc_close&&e(document).bind("keyup.clickery",function(e){if(e.keyCode==27){n.clickery()}return});!this.options.allow_multiple&&e("[data-clickover-open=1]").each(function(){e(this).data("clickover")&&e(this).data("clickover").clickery()});this.$element.attr("data-clickover-open",1);this.tip().on("click",'[data-dismiss="clickover"]',e.proxy(this.clickery,this));if(this.options.auto_close&&this.options.auto_close>0){this.attr.tid=setTimeout(e.proxy(this.clickery,this),this.options.auto_close)}typeof this.options.onShown=="function"&&this.options.onShown.call(this);this.$element.trigger("shown")}else{this.$element.removeAttr("data-clickover-open");this.options.esc_close&&e(document).unbind("keyup.clickery");e("body").off(this.attr.click_event_ns);if(typeof this.attr.tid=="number"){clearTimeout(this.attr.tid);delete this.attr.tid}typeof this.options.onHidden=="function"&&this.options.onHidden.call(this);this.$element.trigger("hidden")}},isShown:function(){return this.tip().hasClass("in")},resetPosition:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip();s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement;t=/in/.test(s);n=this.getPosition(t);r=e[0].offsetWidth;i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width};break}e.css(o)}},debughide:function(){var e=(new Date).toString();console.log(e+": clickover hide");this.hide()}});e.fn.clickover=function(n){return this.each(function(){var r=e(this),i=r.data("clickover"),s=typeof n=="object"&&n;if(!i){r.data("clickover",i=new t(this,s))}if(typeof n=="string"){i[n]()}})};e.fn.clickover.Constructor=t;e.fn.clickover.defaults=e.extend({},e.fn.popover.defaults,{trigger:"manual",auto_close:0,global_close:1,esc_close:1,onShown:null,onHidden:null,width:null,height:null,tip_id:null,class_name:"clickover",allow_multiple:0})}(window.jQuery);(function(e){var t={className:"autosizejs",append:"",callback:false,resizeDelay:10},n='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',r=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],i,s=e(n).data("autosize",true)[0];s.style.lineHeight="99px";if(e(s).css("lineHeight")==="99px"){r.push("lineHeight")}s.style.lineHeight="";e.fn.autosize=function(n){n=e.extend({},t,n||{});if(s.parentNode!==document.body){e(document.body).append(s)}return this.each(function(){function g(){var a={},f;i=t;s.className=n.className;u=parseInt(o.css("maxHeight"),10);e.each(r,function(e,t){a[t]=o.css(t)});e(s).css(a);if("oninput"in t){var l=t.style.width;t.style.width="0px";f=t.offsetWidth;t.style.width=l}}function y(){var r,p,v,m;if(i!==t){g()}s.value=t.value+n.append;s.style.overflowY=t.style.overflowY;p=parseInt(t.style.height,10);if("getComputedStyle"in window){m=window.getComputedStyle(t);v=t.getBoundingClientRect().width;e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,t){v-=parseInt(m[t],10)});s.style.width=v+"px"}else{s.style.width=Math.max(o.width(),0)+"px"}s.scrollTop=0;s.scrollTop=9e4;r=s.scrollTop;if(u&&r>u){t.style.overflowY="scroll";r=u}else{t.style.overflowY="hidden";if(r<a){r=a}}r+=f;if(p!==r){t.style.height=r+"px";if(l){n.callback.call(t,t)}}}function w(){clearTimeout(v);v=setTimeout(function(){if(o.width()!==m){y()}},parseInt(n.resizeDelay,10))}var t=this,o=e(t),u,a,f=0,l=e.isFunction(n.callback),p={height:t.style.height,overflow:t.style.overflow,overflowY:t.style.overflowY,wordWrap:t.style.wordWrap,resize:t.style.resize},v,m=o.width();if(o.data("autosize")){return}o.data("autosize",true);if(o.css("box-sizing")==="border-box"||o.css("-moz-box-sizing")==="border-box"||o.css("-webkit-box-sizing")==="border-box"){f=o.outerHeight()-o.height()}a=Math.max(parseInt(o.css("minHeight"),10)-f||0,o.height());o.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:o.css("resize")==="none"||o.css("resize")==="vertical"?"none":"horizontal"});if("onpropertychange"in t){if("oninput"in t){o.on("input.autosize keyup.autosize",y)}else{o.on("propertychange.autosize",function(){if(event.propertyName==="value"){y()}})}}else{o.on("input.autosize",y)}if(n.resizeDelay!==false){e(window).on("resize.autosize",w)}o.on("autosize.resize",y);o.on("autosize.resizeIncludeStyle",function(){i=null;y()});o.on("autosize.destroy",function(){i=null;clearTimeout(v);e(window).off("resize",w);o.off("autosize").off(".autosize").css(p).removeData("autosize")});y()})}})(window.jQuery||window.Zepto);(function(e){function s(e){return new RegExp("^"+e+"$")}function o(e,t){var n=Array.prototype.slice.call(arguments,2);var r=e.split(".");var i=r.pop();for(var s=0;s<r.length;s++){t=t[r[s]]}return t[i].apply(t,n)}var t=[];var n={options:{prependExistingHelpBlock:false,sniffHtml:true,preventSubmit:true,submitError:false,submitSuccess:false,semanticallyStrict:false,bindEvents:[],autoAdd:{helpBlocks:true},filter:function(){return true}},methods:{init:function(s){var o=e.extend(true,{},n);o.options=e.extend(true,o.options,s);var u=this;var a=e.unique(u.map(function(){return e(this).parents("form")[0]}).toArray());e(a).bind("submit.validationSubmit",function(t){var n=e(this);var r=0;var i=n.find("input,textarea,select").not("[type=submit],[type=image]").filter(o.options.filter);var s=n.find(".control-group");var u=i.filter(function(){return e(this).triggerHandler("getValidatorCount.validation")>0});u.trigger("submit.validation");i.trigger("validationLostFocus.validation");s.each(function(t,n){var i=e(n);if(i.hasClass("warning")||i.hasClass("error")){i.removeClass("warning").addClass("error");r++}});if(r){if(o.options.preventSubmit){t.preventDefault();t.stopImmediatePropagation()}n.addClass("error");if(e.isFunction(o.options.submitError)){o.options.submitError(n,t,u.jqBootstrapValidation("collectErrors",true))}}else{n.removeClass("error");if(e.isFunction(o.options.submitSuccess)){o.options.submitSuccess(n,t)}}});return this.each(function(){var n=e(this),s=n.parents(".control-group").first(),u=s.find(".help-block").first(),a=n.parents("form").first(),l=[];if(!u.length&&o.options.autoAdd&&o.options.autoAdd.helpBlocks){u=e('<div class="help-block" />');s.find(".controls").append(u);t.push(u[0])}if(o.options.sniffHtml){var c;if(n.data("validationPatternPattern")){n.attr("pattern",n.data("validationPatternPattern"))}if(n.attr("pattern")!==undefined){c="Not in the expected format<!-- data-validation-pattern-message to override -->";if(n.data("validationPatternMessage")){c=n.data("validationPatternMessage")}n.data("validationPatternMessage",c);n.data("validationPatternRegex",n.attr("pattern"))}if(n.attr("max")!==undefined||n.attr("aria-valuemax")!==undefined){var h=n.attr("max")!==undefined?n.attr("max"):n.attr("aria-valuemax");c="Too high: Maximum of '"+h+"'<!-- data-validation-max-message to override -->";if(n.data("validationMaxMessage")){c=n.data("validationMaxMessage")}n.data("validationMaxMessage",c);n.data("validationMaxMax",h)}if(n.attr("min")!==undefined||n.attr("aria-valuemin")!==undefined){var p=n.attr("min")!==undefined?n.attr("min"):n.attr("aria-valuemin");c="Too low: Minimum of '"+p+"'<!-- data-validation-min-message to override -->";if(n.data("validationMinMessage")){c=n.data("validationMinMessage")}n.data("validationMinMessage",c);n.data("validationMinMin",p)}if(n.attr("maxlength")!==undefined){c="Too long: Maximum of '"+n.attr("maxlength")+"' characters<!-- data-validation-maxlength-message to override -->";if(n.data("validationMaxlengthMessage")){c=n.data("validationMaxlengthMessage")}n.data("validationMaxlengthMessage",c);n.data("validationMaxlengthMaxlength",n.attr("maxlength"))}if(n.attr("minlength")!==undefined){c="Too short: Minimum of '"+n.attr("minlength")+"' characters<!-- data-validation-minlength-message to override -->";if(n.data("validationMinlengthMessage")){c=n.data("validationMinlengthMessage")}n.data("validationMinlengthMessage",c);n.data("validationMinlengthMinlength",n.attr("minlength"))}if(n.attr("required")!==undefined||n.attr("aria-required")!==undefined){c=o.builtInValidators.required.message;if(n.data("validationRequiredMessage")){c=n.data("validationRequiredMessage")}n.data("validationRequiredMessage",c)}if(n.attr("type")!==undefined&&n.attr("type").toLowerCase()==="number"){c=o.validatorTypes.number.message;if(n.data("validationNumberMessage")){c=n.data("validationNumberMessage")}n.data("validationNumberMessage",c);var v=o.validatorTypes.number.step;if(n.data("validationNumberStep")){v=n.data("validationNumberStep")}n.data("validationNumberStep",v);var m=o.validatorTypes.number.decimal;if(n.data("validationNumberDecimal")){m=n.data("validationNumberDecimal")}n.data("validationNumberDecimal",m)}if(n.attr("type")!==undefined&&n.attr("type").toLowerCase()==="email"){c="Not a valid email address<!-- data-validation-email-message to override -->";if(n.data("validationEmailMessage")){c=n.data("validationEmailMessage")}n.data("validationEmailMessage",c)}if(n.attr("minchecked")!==undefined){c="Not enough options checked; Minimum of '"+n.attr("minchecked")+"' required<!-- data-validation-minchecked-message to override -->";if(n.data("validationMincheckedMessage")){c=n.data("validationMincheckedMessage")}n.data("validationMincheckedMessage",c);n.data("validationMincheckedMinchecked",n.attr("minchecked"))}if(n.attr("maxchecked")!==undefined){c="Too many options checked; Maximum of '"+n.attr("maxchecked")+"' required<!-- data-validation-maxchecked-message to override -->";if(n.data("validationMaxcheckedMessage")){c=n.data("validationMaxcheckedMessage")}n.data("validationMaxcheckedMessage",c);n.data("validationMaxcheckedMaxchecked",n.attr("maxchecked"))}}if(n.data("validation")!==undefined){l=n.data("validation").split(",")}e.each(n.data(),function(e,t){var n=e.replace(/([A-Z])/g,",$1").split(",");if(n[0]==="validation"&&n[1]){l.push(n[1])}});var g=l;var y=[];var w=function(e,t){l[e]=r(t)};var E=function(t,i){if(n.data("validation"+i+"Shortcut")!==undefined){e.each(n.data("validation"+i+"Shortcut").split(","),function(e,t){y.push(t)})}else{if(o.builtInValidators[i.toLowerCase()]){var s=o.builtInValidators[i.toLowerCase()];if(s.type.toLowerCase()==="shortcut"){e.each(s.shortcut.split(","),function(e,t){t=r(t);y.push(t);l.push(t)})}}}};do{e.each(l,w);l=e.unique(l);y=[];e.each(g,E);g=y}while(g.length>0);var S={};e.each(l,function(t,i){var s=n.data("validation"+i+"Message");var u=!!s;var a=false;if(!s){s="'"+i+"' validation failed <!-- Add attribute 'data-validation-"+i.toLowerCase()+"-message' to input to change this message -->"}e.each(o.validatorTypes,function(t,o){if(S[t]===undefined){S[t]=[]}if(!a&&n.data("validation"+i+r(o.name))!==undefined){var l=o.init(n,i);if(u){l.message=s}S[t].push(e.extend(true,{name:r(o.name),message:s},l));a=true}});if(!a&&o.builtInValidators[i.toLowerCase()]){var l=e.extend(true,{},o.builtInValidators[i.toLowerCase()]);if(u){l.message=s}var c=l.type.toLowerCase();if(c==="shortcut"){a=true}else{e.each(o.validatorTypes,function(t,s){if(S[t]===undefined){S[t]=[]}if(!a&&c===t.toLowerCase()){n.data("validation"+i+r(s.name),l[s.name.toLowerCase()]);S[c].push(e.extend(l,s.init(n,i)));a=true}})}}if(!a){e.error("Cannot find validation info for '"+i+"'")}});u.data("original-contents",u.data("original-contents")?u.data("original-contents"):u.html());u.data("original-role",u.data("original-role")?u.data("original-role"):u.attr("role"));s.data("original-classes",s.data("original-clases")?s.data("original-classes"):s.attr("class"));n.data("original-aria-invalid",n.data("original-aria-invalid")?n.data("original-aria-invalid"):n.attr("aria-invalid"));n.bind("validation.validation",function(t,r){var s=i(n);var u=[];e.each(S,function(t,i){if(s||s.length||r&&r.includeEmpty||!!o.validatorTypes[t].includeEmpty||!!o.validatorTypes[t].blockSubmit&&r&&!!r.submitting){e.each(i,function(e,r){if(o.validatorTypes[t].validate(n,s,r)){u.push(r.message)}})}});return u});n.bind("getValidators.validation",function(){return S});var x=0;e.each(S,function(e,t){x+=t.length});n.bind("getValidatorCount.validation",function(){return x});n.bind("submit.validation",function(){return n.triggerHandler("change.validation",{submitting:true})});n.bind((o.options.bindEvents.length>0?o.options.bindEvents:["keyup","focus","blur","click","keydown","keypress","change"]).concat(["revalidate"]).join(".validation ")+".validation",function(t,r){var l=i(n);var c=[];if(r&&!!r.submitting){s.data("jqbvIsSubmitting",true)}else{if(t.type!=="revalidate"){s.data("jqbvIsSubmitting",false)}}var h=!!s.data("jqbvIsSubmitting");s.find("input,textarea,select").each(function(t,i){var s=c.length;e.each(e(i).triggerHandler("validation.validation",r),function(e,t){c.push(t)});if(c.length>s){e(i).attr("aria-invalid","true")}else{var o=n.data("original-aria-invalid");e(i).attr("aria-invalid",o!==undefined?o:false)}});a.find("input,select,textarea").not(n).not('[name="'+n.attr("name")+'"]').trigger("validationLostFocus.validation");c=e.unique(c.sort());if(c.length){s.removeClass("success error warning").addClass(h?"error":"warning");if(o.options.semanticallyStrict&&c.length===1){u.html(c[0]+(o.options.prependExistingHelpBlock?u.data("original-contents"):""))}else{u.html('<ul role="alert"><li>'+c.join("</li><li>")+"</li></ul>"+(o.options.prependExistingHelpBlock?u.data("original-contents"):""))}}else{s.removeClass("warning error success");if(l.length>0){s.addClass("success")}u.html(u.data("original-contents"))}if(t.type==="blur"){s.removeClass("success")}});n.bind("validationLostFocus.validation",function(){s.removeClass("success")})})},destroy:function(){return this.each(function(){var n=e(this),r=n.parents(".control-group").first(),i=r.find(".help-block").first(),s=n.parents("form").first();n.unbind(".validation");s.unbind(".validationSubmit");i.html(i.data("original-contents"));r.attr("class",r.data("original-classes"));n.attr("aria-invalid",n.data("original-aria-invalid"));i.attr("role",n.data("original-role"));if(e.inArray(i[0],t)>-1){i.remove()}})},collectErrors:function(t){var n={};this.each(function(t,r){var i=e(r);var s=i.attr("name");var o=i.triggerHandler("validation.validation",{includeEmpty:true});n[s]=e.extend(true,o,n[s])});e.each(n,function(e,t){if(t.length===0){delete n[e]}});return n},hasErrors:function(){var t=[];this.find("input,select,textarea").add(this).each(function(n,r){t=t.concat(e(r).triggerHandler("getValidators.validation")?e(r).triggerHandler("validation.validation",{submitting:true}):[])});return t.length>0},override:function(t){n=e.extend(true,n,t)}},validatorTypes:{callback:{name:"callback",init:function(e,t){var n={validatorName:t,callback:e.data("validation"+t+"Callback"),lastValue:e.val(),lastValid:true,lastFinished:true};var r="Not valid";if(e.data("validation"+t+"Message")){r=e.data("validation"+t+"Message")}n.message=r;return n},validate:function(e,t,n){if(n.lastValue===t&&n.lastFinished){return!n.lastValid}if(n.lastFinished===true){n.lastValue=t;n.lastValid=true;n.lastFinished=false;var r=n;var i=e;o(n.callback,window,e,t,function(t){if(r.lastValue===t.value){r.lastValid=t.valid;if(t.message){r.message=t.message}r.lastFinished=true;i.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){if(!e.is(":focus")&&e.parents("form").first().data("jqbvIsSubmitting")){i.trigger("blur.validation")}else{i.trigger("revalidate.validation")}},1)}})}return false}},ajax:{name:"ajax",init:function(e,t){return{validatorName:t,url:e.data("validation"+t+"Ajax"),lastValue:e.val(),lastValid:true,lastFinished:true}},validate:function(t,n,r){if(""+r.lastValue===""+n&&r.lastFinished===true){return r.lastValid===false}if(r.lastFinished===true){r.lastValue=n;r.lastValid=true;r.lastFinished=false;e.ajax({url:r.url,data:"value="+encodeURIComponent(n)+"&field="+t.attr("name"),dataType:"json",success:function(e){if(""+r.lastValue===""+e.value){r.lastValid=!!e.valid;if(e.message){r.message=e.message}r.lastFinished=true;t.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){t.trigger("revalidate.validation")},1)}},failure:function(){r.lastValid=true;r.message="ajax call failed";r.lastFinished=true;t.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){t.trigger("revalidate.validation")},1)}})}return false}},regex:{name:"regex",init:function(t,n){var r={};var i=t.data("validation"+n+"Regex");r.regex=s(i);if(i===undefined){e.error("Can't find regex for '"+n+"' validator on '"+t.attr("name")+"'")}var o="Not in the expected format";if(t.data("validation"+n+"Message")){o=t.data("validation"+n+"Message")}r.message=o;r.originalName=n;return r},validate:function(e,t,n){return!n.regex.test(t)&&!n.negative||n.regex.test(t)&&n.negative}},email:{name:"email",init:function(e,t){var n={};n.regex=s("[a-zA-Z0-9.!#$%&â€™*+/=?^_`{|}~-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}");var r="Not a valid email address";if(e.data("validation"+t+"Message")){r=e.data("validation"+t+"Message")}n.message=r;n.originalName=t;return n},validate:function(e,t,n){return!n.regex.test(t)&&!n.negative||n.regex.test(t)&&n.negative}},required:{name:"required",init:function(e,t){var n="This is required";if(e.data("validation"+t+"Message")){n=e.data("validation"+t+"Message")}return{message:n,includeEmpty:true}},validate:function(e,t,n){return!!(t.length===0&&!n.negative||t.length>0&&n.negative)},blockSubmit:true},match:{name:"match",init:function(t,n){var r=t.data("validation"+n+"Match");var i=t.parents("form").first();var s=i.find('[name="'+r+'"]').first();s.bind("validation.validation",function(){t.trigger("revalidate.validation",{submitting:true})});var o={};o.element=s;if(s.length===0){e.error("Can't find field '"+r+"' to match '"+t.attr("name")+"' against in '"+n+"' validator")}var u="Must match";var a=null;if((a=i.find('label[for="'+r+'"]')).length){u+=" '"+a.text()+"'"}else{if((a=s.parents(".control-group").first().find("label")).length){u+=" '"+a.first().text()+"'"}}if(t.data("validation"+n+"Message")){u=t.data("validation"+n+"Message")}o.message=u;return o},validate:function(e,t,n){return t!==n.element.val()&&!n.negative||t===n.element.val()&&n.negative},blockSubmit:true,includeEmpty:true},max:{name:"max",init:function(e,t){var n={};n.max=e.data("validation"+t+"Max");n.message="Too high: Maximum of '"+n.max+"'";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return parseFloat(t,10)>parseFloat(n.max,10)&&!n.negative||parseFloat(t,10)<=parseFloat(n.max,10)&&n.negative}},min:{name:"min",init:function(e,t){var n={};n.min=e.data("validation"+t+"Min");n.message="Too low: Minimum of '"+n.min+"'";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return parseFloat(t)<parseFloat(n.min)&&!n.negative||parseFloat(t)>=parseFloat(n.min)&&n.negative}},maxlength:{name:"maxlength",init:function(e,t){var n={};n.maxlength=e.data("validation"+t+"Maxlength");n.message="Too long: Maximum of '"+n.maxlength+"' characters";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return t.length>n.maxlength&&!n.negative||t.length<=n.maxlength&&n.negative}},minlength:{name:"minlength",init:function(e,t){var n={};n.minlength=e.data("validation"+t+"Minlength");n.message="Too short: Minimum of '"+n.minlength+"' characters";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return t.length<n.minlength&&!n.negative||t.length>=n.minlength&&n.negative}},maxchecked:{name:"maxchecked",init:function(e,t){var n={};var r=e.parents("form").first().find('[name="'+e.attr("name")+'"]');r.bind("change.validation click.validation",function(){e.trigger("revalidate.validation",{includeEmpty:true})});n.elements=r;n.maxchecked=e.data("validation"+t+"Maxchecked");var i="Too many: Max '"+n.maxchecked+"' checked";if(e.data("validation"+t+"Message")){i=e.data("validation"+t+"Message")}n.message=i;return n},validate:function(e,t,n){return n.elements.filter(":checked").length>n.maxchecked&&!n.negative||n.elements.filter(":checked").length<=n.maxchecked&&n.negative},blockSubmit:true},minchecked:{name:"minchecked",init:function(e,t){var n={};var r=e.parents("form").first().find('[name="'+e.attr("name")+'"]');r.bind("change.validation click.validation",function(){e.trigger("revalidate.validation",{includeEmpty:true})});n.elements=r;n.minchecked=e.data("validation"+t+"Minchecked");var i="Too few: Min '"+n.minchecked+"' checked";if(e.data("validation"+t+"Message")){i=e.data("validation"+t+"Message")}n.message=i;return n},validate:function(e,t,n){return n.elements.filter(":checked").length<n.minchecked&&!n.negative||n.elements.filter(":checked").length>=n.minchecked&&n.negative},blockSubmit:true,includeEmpty:true},number:{name:"number",init:function(e,t){var n={};n.step=1;if(e.attr("step")){n.step=e.attr("step")}if(e.data("validation"+t+"Step")){n.step=e.data("validation"+t+"Step")}n.decimal=".";if(e.data("validation"+t+"Decimal")){n.decimal=e.data("validation"+t+"Decimal")}n.thousands="";if(e.data("validation"+t+"Thousands")){n.thousands=e.data("validation"+t+"Thousands")}n.regex=s("([+-]?\\d+(\\"+n.decimal+"\\d+)?)?");n.message="Must be a number";var r=e.data("validation"+t+"Message");if(r){n.message=r}return n},validate:function(e,t,n){var r=t.replace(n.decimal,".").replace(n.thousands,"");var i=parseFloat(r);var s=parseFloat(n.step);while(s%1!==0){s=parseFloat(s.toPrecision(12))*10;i=parseFloat(i.toPrecision(12))*10}var o=n.regex.test(t);var u=parseFloat(i)%parseFloat(s)===0;var a=!isNaN(parseFloat(r))&&isFinite(r);var f=!(o&&u&&a);return f},message:"Must be a number"}},builtInValidators:{email:{name:"Email",type:"email"},passwordagain:{name:"Passwordagain",type:"match",match:"password",message:"Does not match the given password<!-- data-validator-paswordagain-message to override -->"},positive:{name:"Positive",type:"shortcut",shortcut:"number,positivenumber"},negative:{name:"Negative",type:"shortcut",shortcut:"number,negativenumber"},integer:{name:"Integer",type:"regex",regex:"[+-]?\\d+",message:"No decimal places allowed<!-- data-validator-integer-message to override -->"},positivenumber:{name:"Positivenumber",type:"min",min:0,message:"Must be a positive number<!-- data-validator-positivenumber-message to override -->"},negativenumber:{name:"Negativenumber",type:"max",max:0,message:"Must be a negative number<!-- data-validator-negativenumber-message to override -->"},required:{name:"Required",type:"required",message:"This is required<!-- data-validator-required-message to override -->"},checkone:{name:"Checkone",type:"minchecked",minchecked:1,message:"Check at least one option<!-- data-validation-checkone-message to override -->"},number:{name:"Number",type:"number",decimal:".",step:"1"},pattern:{name:"Pattern",type:"regex",message:"Not in expected format"}}};var r=function(e){return e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})};var i=function(t){var n=null;var r=t.attr("type");if(r==="checkbox"){n=t.is(":checked")?n:"";var i=t.parents("form").first()||t.parents(".control-group").first();if(i){n=i.find("input[name='"+t.attr("name")+"']:checked").map(function(t,n){return e(n).val()}).toArray().join(",")}}else{if(r==="radio"){n=e('input[name="'+t.attr("name")+'"]:checked').length>0?t.val():"";var s=t.parents("form").first()||t.parents(".control-group").first();if(s){n=s.find("input[name='"+t.attr("name")+"']:checked").map(function(t,n){return e(n).val()}).toArray().join(",")}}else{n=t.val()}}return n};e.fn.jqBootstrapValidation=function(t){if(n.methods[t]){return n.methods[t].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof t==="object"||!t){return n.methods.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.jqBootstrapValidation");return null}}};e.jqBootstrapValidation=function(t){e(":input").not("[type=image],[type=submit]").jqBootstrapValidation.apply(this,arguments)}})(jQuery);var pasteEventName=getPasteEvent()+".mask",ua=navigator.userAgent,iPhone=/iphone/i.test(ua),android=/android/i.test(ua),caretTimeoutId;$.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn",placeholder:"_"};$.fn.extend({caret:function(e,t){var n;if(this.length===0||this.is(":hidden")){return}if(typeof e=="number"){t=typeof t==="number"?t:e;return this.each(function(){if(this.setSelectionRange){this.setSelectionRange(e,t)}else{if(this.createTextRange){n=this.createTextRange();n.collapse(true);n.moveEnd("character",t);n.moveStart("character",e);n.select()}}})}else{if(this[0].setSelectionRange){e=this[0].selectionStart;t=this[0].selectionEnd}else{if(document.selection&&document.selection.createRange){n=document.selection.createRange();e=0-n.duplicate().moveStart("character",-1e5);t=e+n.text.length}}return{begin:e,end:t}}},unmask:function(){return this.trigger("unmask")},mask:function(e,t){var n,r,i,s,o,u;if(!e&&this.length>0){n=$(this[0]);return n.data($.mask.dataName)()}t=$.extend({placeholder:$.mask.placeholder,completed:null},t);r=$.mask.definitions;i=[];s=u=e.length;o=null;$.each(e.split(""),function(e,t){if(t=="?"){u--;s=e}else{if(r[t]){i.push(new RegExp(r[t]));if(o===null){o=i.length-1}}else{i.push(null)}}});return this.trigger("unmask").each(function(){function p(e){while(++e<u&&!i[e]){}return e}function v(e){while(--e>=0&&!i[e]){}return e}function m(e,r){var s,l;if(e<0){return}for(s=e,l=p(r);s<u;s++){if(i[s]){if(l<u&&i[s].test(a[l])){a[s]=a[l];a[l]=t.placeholder}else{break}l=p(l)}}x();n.caret(Math.max(o,e))}function y(e){var n,r,s,o;for(n=e,r=t.placeholder;n<u;n++){if(i[n]){s=p(n);o=a[n];a[n]=r;if(s<u&&i[s].test(o)){r=o}else{break}}}}function w(e){var t=e.which,r,i,s;if(t===8||t===46||iPhone&&t===127){r=n.caret();i=r.begin;s=r.end;if(s-i===0){i=t!==46?v(i):s=p(i-1);s=t===46?p(s):s}S(i,s);m(i,s-1);e.preventDefault()}else{if(t==27){n.val(l);n.caret(0,T());e.preventDefault()}}}function E(e){var r=e.which,s=n.caret(),o,f,l;if(e.ctrlKey||e.altKey||e.metaKey||r<32){return}else{if(r){if(s.end-s.begin!==0){S(s.begin,s.end);m(s.begin,s.end-1)}o=p(s.begin-1);if(o<u){f=String.fromCharCode(r);if(i[o].test(f)){y(o);a[o]=f;x();l=p(o);if(android){setTimeout($.proxy($.fn.caret,n,l),0)}else{n.caret(l)}if(t.completed&&l>=u){t.completed.call(n)}}}e.preventDefault()}}}function S(e,n){var r;for(r=e;r<n&&r<u;r++){if(i[r]){a[r]=t.placeholder}}}function x(){n.val(a.join(""))}function T(e){var r=n.val(),l=-1,c,p,d;for(c=0,d=0;c<u;c++){if(i[c]){a[c]=t.placeholder;while(d++<r.length){p=r.charAt(d-1);if(i[c].test(p)){a[c]=p;l=c;break}}if(d>r.length){break}}else{if(a[c]===r.charAt(d)&&c!==s){d++;l=c}}}if(e){x()}else{if(l+1<s){n.val("");S(0,u)}else{x();n.val(n.val().substring(0,l+1))}}return s?c:o}var n=$(this),a=$.map(e.split(""),function(e,n){if(e!="?"){return r[e]?t.placeholder:e}}),l=n.val();n.data($.mask.dataName,function(){return $.map(a,function(e,n){return i[n]&&e!=t.placeholder?e:null}).join("")});if(!n.attr("readonly")){n.one("unmask",function(){n.unbind(".mask").removeData($.mask.dataName)}).bind("focus.mask",function(){clearTimeout(caretTimeoutId);var t;l=n.val();t=T();caretTimeoutId=setTimeout(function(){x();if(t==e.length){n.caret(0,t)}else{n.caret(t)}},10)}).bind("blur.mask",function(){T();if(n.val()!=l){n.change()}}).bind("keydown.mask",w).bind("keypress.mask",E).bind(pasteEventName,function(){setTimeout(function(){var e=T(true);n.caret(e);if(t.completed&&e==n.val().length){t.completed.call(n)}},0)})}T()})}});(function(e){e.easyPieChart=function(t,n){var r,i,s,o,u,a,f,l,c=this;this.el=t;this.$el=e(t);this.$el.data("easyPieChart",this);this.init=function(){var t,r;c.options=e.extend({},e.easyPieChart.defaultOptions,n);t=parseInt(c.$el.data("percent"),10);c.percentage=0;c.canvas=e("<canvas width='"+c.options.size+"' height='"+c.options.size+"'></canvas>").get(0);c.$el.append(c.canvas);if(typeof G_vmlCanvasManager!=="undefined"&&G_vmlCanvasManager!==null){G_vmlCanvasManager.initElement(c.canvas)}c.ctx=c.canvas.getContext("2d");if(window.devicePixelRatio>1){r=window.devicePixelRatio;e(c.canvas).css({width:c.options.size,height:c.options.size});c.canvas.width*=r;c.canvas.height*=r;c.ctx.scale(r,r)}c.ctx.translate(c.options.size/2,c.options.size/2);c.ctx.rotate(c.options.rotate*Math.PI/180);c.$el.addClass("easyPieChart");c.$el.css({width:c.options.size,height:c.options.size,lineHeight:""+c.options.size+"px"});c.update(t);return c};this.update=function(e){e=parseFloat(e)||0;if(c.options.animate===false){s(e)}else{i(c.percentage,e)}return c};f=function(){var e,t,n;c.ctx.fillStyle=c.options.scaleColor;c.ctx.lineWidth=1;n=[];for(e=t=0;t<=24;e=++t){n.push(r(e))}return n};r=function(e){var t;t=e%6===0?0:c.options.size*.017;c.ctx.save();c.ctx.rotate(e*Math.PI/12);c.ctx.fillRect(c.options.size/2-t,0,-c.options.size*.05+t,1);c.ctx.restore()};l=function(){var e;e=c.options.size/2-c.options.lineWidth/2;if(c.options.scaleColor!==false){e-=c.options.size*.08}c.ctx.beginPath();c.ctx.arc(0,0,e,0,Math.PI*2,true);c.ctx.closePath();c.ctx.strokeStyle=c.options.trackColor;c.ctx.lineWidth=c.options.lineWidth;c.ctx.stroke()};a=function(){if(c.options.scaleColor!==false){f()}if(c.options.trackColor!==false){l()}};s=function(t){var n;a();c.ctx.strokeStyle=e.isFunction(c.options.barColor)?c.options.barColor(t):c.options.barColor;c.ctx.lineCap=c.options.lineCap;c.ctx.lineWidth=c.options.lineWidth;n=c.options.size/2-c.options.lineWidth/2;if(c.options.scaleColor!==false){n-=c.options.size*.08}c.ctx.save();c.ctx.rotate(-Math.PI/2);c.ctx.beginPath();c.ctx.arc(0,0,n,0,Math.PI*2*t/100,false);c.ctx.stroke();c.ctx.restore()};u=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}();i=function(e,t){var n,r;c.options.onStart.call(c);c.percentage=t;r=Date.now();n=function(){var i,f;f=Date.now()-r;if(f<c.options.animate){u(n)}c.ctx.clearRect(-c.options.size/2,-c.options.size/2,c.options.size,c.options.size);a.call(c);i=[o(f,e,t-e,c.options.animate)];c.options.onStep.call(c,i);s.call(c,i);if(f>=c.options.animate){return c.options.onStop.call(c)}};u(n)};o=function(e,t,n,r){var i,s;i=function(e){return Math.pow(e,2)};s=function(e){if(e<1){return i(e)}else{return 2-i(e/2*-2+2)}};e/=r/2;return n/2*s(e)+t};return this.init()};e.easyPieChart.defaultOptions={barColor:"#ef1e25",trackColor:"#f2f2f2",scaleColor:"#dfe0e0",lineCap:"round",rotate:0,size:110,lineWidth:3,animate:false,onStart:e.noop,onStop:e.noop,onStep:e.noop};e.fn.easyPieChart=function(t){return e.each(this,function(n,r){var i,s;i=e(r);if(!i.data("easyPieChart")){s=e.extend({},t,i.data());return i.data("easyPieChart",new e.easyPieChart(r,s))}})};return void 0})(jQuery);(function(e,t,n){(function(e){if(typeof define==="function"&&define.amd){define(["jquery"],e)}else{if(jQuery&&!jQuery.fn.sparkline){e(jQuery)}}})(function(r){var i={},s,o,u,a,f,l,h,p,v,m,g,y,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=0;s=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:false,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:false,enableHighlight:true,highlightLighten:1.4,tooltipSkipNull:true,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:false,numberFormatter:false,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:false,disableInteraction:false},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:n,normalRangeMax:n,normalRangeColor:"#ccc",drawNormalOnTop:false,chartRangeMin:n,chartRangeMax:n,chartRangeMinX:n,chartRangeMaxX:n,tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:n,nullColor:n,zeroAxis:true,barWidth:4,barSpacing:1,chartRangeMax:n,chartRangeMin:n,chartRangeClip:false,colorMap:n,tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:n,thresholdValue:0,chartRangeMax:n,chartRangeMin:n,chartRangeClip:false,tooltipFormat:new u("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:n,tooltipFormat:new u("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new u('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:false,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:true,outlierIQR:1.5,spotRadius:1.5,target:n,targetColor:"#4a2",chartRangeMax:n,chartRangeMin:n,tooltipFormat:new u("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}};D='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}';o=function(){var e,t;e=function(){this.init.apply(this,arguments)};if(arguments.length>1){if(arguments[0]){e.prototype=r.extend(new arguments[0],arguments[arguments.length-1]);e._super=arguments[0].prototype}else{e.prototype=arguments[arguments.length-1]}if(arguments.length>2){t=Array.prototype.slice.call(arguments,1,-1);t.unshift(e.prototype);r.extend.apply(r,t)}}else{e.prototype=arguments[0]}e.prototype.cls=e;return e};r.SPFormatClass=u=o({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,t){this.format=e;this.fclass=t},render:function(e,t,r){var i=this,s=e,o,u,a,f,l;return this.format.replace(this.fre,function(){var e;u=arguments[1];a=arguments[3];o=i.precre.exec(u);if(o){l=o[2];u=o[1]}else{l=false}f=s[u];if(f===n){return""}if(a&&t&&t[a]){e=t[a];if(e.get){return t[a].get(f)||f}else{return t[a][f]||f}}if(v(f)){if(r.get("numberFormatter")){f=r.get("numberFormatter")(f)}else{f=E(f,l,r.get("numberDigitGroupCount"),r.get("numberDigitGroupSep"),r.get("numberDecimalMark"))}}return f})}});r.spformat=function(e,t){return new u(e,t)};a=function(e,t,n){if(e<t){return t}if(e>n){return n}return e};f=function(e,n){var r;if(n===2){r=t.floor(e.length/2);return e.length%2?e[r]:(e[r-1]+e[r])/2}else{if(e.length%2){r=(e.length*n+n)/4;return r%1?(e[t.floor(r)]+e[t.floor(r)-1])/2:e[r-1]}else{r=(e.length*n+2)/4;return r%1?(e[t.floor(r)]+e[t.floor(r)-1])/2:e[r-1]}}};l=function(e){var t;switch(e){case"undefined":e=n;break;case"null":e=null;break;case"true":e=true;break;case"false":e=false;break;default:t=parseFloat(e);if(e==t){e=t}}return e};h=function(e){var t,n=[];for(t=e.length;t--;){n[t]=l(e[t])}return n};p=function(e,t){var n,r,i=[];for(n=0,r=e.length;n<r;n++){if(e[n]!==t){i.push(e[n])}}return i};v=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};E=function(e,t,n,i,s){var o,u;e=(t===false?parseFloat(e).toString():e.toFixed(t)).split("");o=(o=r.inArray(".",e))<0?e.length:o;if(o<e.length){e[o]=s}for(u=o-n;u>0;u-=n){e.splice(u,0,i)}return e.join("")};m=function(e,t,n){var r;for(r=t.length;r--;){if(n&&t[r]===null){continue}if(t[r]!==e){return false}}return true};g=function(e){var t=0,n;for(n=e.length;n--;){t+=typeof e[n]==="number"?e[n]:0}return t};w=function(e){return r.isArray(e)?e:[e]};y=function(t){var n;if(e.createStyleSheet){e.createStyleSheet().cssText=t}else{n=e.createElement("style");n.type="text/css";e.getElementsByTagName("head")[0].appendChild(n);n[typeof e.body.style.WebkitAppearance=="string"?"innerText":"innerHTML"]=t}};r.fn.simpledraw=function(t,i,s,o){var u,a;if(s&&(u=this.data("_jqs_vcanvas"))){return u}if(r.fn.sparkline.canvas===false){return false}else{if(r.fn.sparkline.canvas===n){var f=e.createElement("canvas");if(!!(f.getContext&&f.getContext("2d"))){r.fn.sparkline.canvas=function(e,t,n,r){return new j(e,t,n,r)}}else{if(e.namespaces&&!e.namespaces.v){e.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML");r.fn.sparkline.canvas=function(e,t,n,r){return new F(e,t,n)}}else{r.fn.sparkline.canvas=false;return false}}}}if(t===n){t=r(this).innerWidth()}if(i===n){i=r(this).innerHeight()}u=r.fn.sparkline.canvas(t,i,this,o);a=r(this).data("_jqs_mhandler");if(a){a.registerCanvas(u)}return u};r.fn.cleardraw=function(){var e=this.data("_jqs_vcanvas");if(e){e.reset()}};r.RangeMapClass=S=o({init:function(e){var t,n,r=[];for(t in e){if(e.hasOwnProperty(t)&&typeof t==="string"&&t.indexOf(":")>-1){n=t.split(":");n[0]=n[0].length===0?-Infinity:parseFloat(n[0]);n[1]=n[1].length===0?Infinity:parseFloat(n[1]);n[2]=e[t];r.push(n)}}this.map=e;this.rangelist=r||false},get:function(e){var t=this.rangelist,r,i,s;if((s=this.map[e])!==n){return s}if(t){for(r=t.length;r--;){i=t[r];if(i[0]<=e&&i[1]>=e){return i[2]}}}return n}});r.range_map=function(e){return new S(e)};x=o({init:function(e,t){var n=r(e);this.$el=n;this.options=t;this.currentPageX=0;this.currentPageY=0;this.el=e;this.splist=[];this.tooltip=null;this.over=false;this.displayTooltips=!t.get("disableTooltips");this.highlightEnabled=!t.get("disableHighlight")},registerSparkline:function(e){this.splist.push(e);if(this.over){this.updateDisplay()}},registerCanvas:function(e){var t=r(e.canvas);this.canvas=e;this.$canvas=t;t.mouseenter(r.proxy(this.mouseenter,this));t.mouseleave(r.proxy(this.mouseleave,this));t.click(r.proxy(this.mouseclick,this))},reset:function(e){this.splist=[];if(this.tooltip&&e){this.tooltip.remove();this.tooltip=n}},mouseclick:function(e){var t=r.Event("sparklineClick");t.originalEvent=e;t.sparklines=this.splist;this.$el.trigger(t)},mouseenter:function(t){r(e.body).unbind("mousemove.jqs");r(e.body).bind("mousemove.jqs",r.proxy(this.mousemove,this));this.over=true;this.currentPageX=t.pageX;this.currentPageY=t.pageY;this.currentEl=t.target;if(!this.tooltip&&this.displayTooltips){this.tooltip=new T(this.options);this.tooltip.updatePosition(t.pageX,t.pageY)}this.updateDisplay()},mouseleave:function(){r(e.body).unbind("mousemove.jqs");var t=this.splist,n=t.length,i=false,s,o;this.over=false;this.currentEl=null;if(this.tooltip){this.tooltip.remove();this.tooltip=null}for(o=0;o<n;o++){s=t[o];if(s.clearRegionHighlight()){i=true}}if(i){this.canvas.render()}},mousemove:function(e){this.currentPageX=e.pageX;this.currentPageY=e.pageY;this.currentEl=e.target;if(this.tooltip){this.tooltip.updatePosition(e.pageX,e.pageY)}this.updateDisplay()},updateDisplay:function(){var e=this.splist,t=e.length,n=false,i=this.$canvas.offset(),s=this.currentPageX-i.left,o=this.currentPageY-i.top,u,a,f,l,c;if(!this.over){return}for(f=0;f<t;f++){a=e[f];l=a.setRegionHighlight(this.currentEl,s,o);if(l){n=true}}if(n){c=r.Event("sparklineRegionChange");c.sparklines=this.splist;this.$el.trigger(c);if(this.tooltip){u="";for(f=0;f<t;f++){a=e[f];u+=a.getCurrentRegionTooltip()}this.tooltip.setContent(u)}if(!this.disableHighlight){this.canvas.render()}}if(l===null){this.mouseleave()}}});T=o({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(t){var n=t.get("tooltipClassname","jqstooltip"),i=this.sizeStyle,s;this.container=t.get("tooltipContainer")||e.body;this.tooltipOffsetX=t.get("tooltipOffsetX",10);this.tooltipOffsetY=t.get("tooltipOffsetY",12);r("#jqssizetip").remove();r("#jqstooltip").remove();this.sizetip=r("<div/>",{id:"jqssizetip",style:i,"class":n});this.tooltip=r("<div/>",{id:"jqstooltip","class":n}).appendTo(this.container);s=this.tooltip.offset();this.offsetLeft=s.left;this.offsetTop=s.top;this.hidden=true;r(window).unbind("resize.jqs scroll.jqs");r(window).bind("resize.jqs scroll.jqs",r.proxy(this.updateWindowDims,this));this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=r(window).scrollTop();this.scrollLeft=r(window).scrollLeft();this.scrollRight=this.scrollLeft+r(window).width();this.updatePosition()},getSize:function(e){this.sizetip.html(e).appendTo(this.container);this.width=this.sizetip.width()+1;this.height=this.sizetip.height();this.sizetip.remove()},setContent:function(e){if(!e){this.tooltip.css("visibility","hidden");this.hidden=true;return}this.getSize(e);this.tooltip.html(e).css({width:this.width,height:this.height,visibility:"visible"});if(this.hidden){this.hidden=false;this.updatePosition()}},updatePosition:function(e,t){if(e===n){if(this.mousex===n){return}e=this.mousex-this.offsetLeft;t=this.mousey-this.offsetTop}else{this.mousex=e=e-this.offsetLeft;this.mousey=t=t-this.offsetTop}if(!this.height||!this.width||this.hidden){return}t-=this.height+this.tooltipOffsetY;e+=this.tooltipOffsetX;if(t<this.scrollTop){t=this.scrollTop}if(e<this.scrollLeft){e=this.scrollLeft}else{if(e+this.width>this.scrollRight){e=this.scrollRight-this.width}}this.tooltip.css({left:e,top:t})},remove:function(){this.tooltip.remove();this.sizetip.remove();this.sizetip=this.tooltip=n;r(window).unbind("resize.jqs scroll.jqs")}});P=function(){y(D)};r(P);I=[];r.fn.sparkline=function(t,i){return this.each(function(){var s=new r.fn.sparkline.options(this,i),o=r(this),u,a;u=function(){var i,u,a,f,l,c,h;if(t==="html"||t===n){h=this.getAttribute(s.get("tagValuesAttribute"));if(h===n||h===null){h=o.html()}i=h.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{i=t}u=s.get("width")==="auto"?i.length*s.get("defaultPixelsPerValue"):s.get("width");if(s.get("height")==="auto"){if(!s.get("composite")||!r.data(this,"_jqs_vcanvas")){f=e.createElement("span");f.innerHTML="a";o.html(f);a=r(f).innerHeight()||r(f).height();r(f).remove();f=null}}else{a=s.get("height")}if(!s.get("disableInteraction")){l=r.data(this,"_jqs_mhandler");if(!l){l=new x(this,s);r.data(this,"_jqs_mhandler",l)}else{if(!s.get("composite")){l.reset()}}}else{l=false}if(s.get("composite")&&!r.data(this,"_jqs_vcanvas")){if(!r.data(this,"_jqs_errnotify")){alert("Attempted to attach a composite sparkline to an element with no existing sparkline");r.data(this,"_jqs_errnotify",true)}return}c=new(r.fn.sparkline[s.get("type")])(this,i,s,u,a);c.render();if(l){l.registerSparkline(c)}};if(r(this).html()&&!s.get("disableHiddenCheck")&&r(this).is(":hidden")||!r(this).parents("body").length){if(!s.get("composite")&&r.data(this,"_jqs_pending")){for(a=I.length;a;a--){if(I[a-1][0]==this){I.splice(a-1,1)}}}I.push([this,u]);r.data(this,"_jqs_pending",true)}else{u.call(this)}})};r.fn.sparkline.defaults=s();r.sparkline_display_visible=function(){var e,t,n;var i=[];for(t=0,n=I.length;t<n;t++){e=I[t][0];if(r(e).is(":visible")&&!r(e).parents().is(":hidden")){I[t][1].call(e);r.data(I[t][0],"_jqs_pending",false);i.push(t)}else{if(!r(e).closest("html").length&&!r.data(e,"_jqs_pending")){r.data(I[t][0],"_jqs_pending",false);i.push(t)}}}for(t=i.length;t;t--){I.splice(i[t-1],1)}};r.fn.sparkline.options=o({init:function(e,t){var n,s,o,u;this.userOptions=t=t||{};this.tag=e;this.tagValCache={};s=r.fn.sparkline.defaults;o=s.common;this.tagOptionsPrefix=t.enableTagOptions&&(t.tagOptionsPrefix||o.tagOptionsPrefix);u=this.getTagSetting("type");if(u===i){n=s[t.type||o.type]}else{n=s[u]}this.mergedOptions=r.extend({},o,n,t)},getTagSetting:function(e){var t=this.tagOptionsPrefix,r,s,o,u;if(t===false||t===n){return i}if(this.tagValCache.hasOwnProperty(e)){r=this.tagValCache.key}else{r=this.tag.getAttribute(t+e);if(r===n||r===null){r=i}else{if(r.substr(0,1)==="["){r=r.substr(1,r.length-2).split(",");for(s=r.length;s--;){r[s]=l(r[s].replace(/(^\s*)|(\s*$)/g,""))}}else{if(r.substr(0,1)==="{"){o=r.substr(1,r.length-2).split(",");r={};for(s=o.length;s--;){u=o[s].split(":",2);r[u[0].replace(/(^\s*)|(\s*$)/g,"")]=l(u[1].replace(/(^\s*)|(\s*$)/g,""))}}else{r=l(r)}}}this.tagValCache.key=r}return r},get:function(e,t){var r=this.getTagSetting(e),s;if(r!==i){return r}return(s=this.mergedOptions[e])===n?t:s}});r.fn.sparkline._base=o({disabled:false,init:function(e,t,i,s,o){this.el=e;this.$el=r(e);this.values=t;this.options=i;this.width=s;this.height=o;this.currentRegion=n},initTarget:function(){var e=!this.options.get("disableInteraction");if(!(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),e))){this.disabled=true}else{this.canvasWidth=this.target.pixelWidth;this.canvasHeight=this.target.pixelHeight}},render:function(){if(this.disabled){this.el.innerHTML="";return false}return true},getRegion:function(e,t){},setRegionHighlight:function(e,t,r){var i=this.currentRegion,s=!this.options.get("disableHighlight"),o;if(t>this.canvasWidth||r>this.canvasHeight||t<0||r<0){return null}o=this.getRegion(e,t,r);if(i!==o){if(i!==n&&s){this.removeHighlight()}this.currentRegion=o;if(o!==n&&s){this.renderHighlight()}return true}return false},clearRegionHighlight:function(){if(this.currentRegion!==n){this.removeHighlight();this.currentRegion=n;return true}return false},renderHighlight:function(){this.changeHighlight(true)},removeHighlight:function(){this.changeHighlight(false)},changeHighlight:function(e){},getCurrentRegionTooltip:function(){var e=this.options,t="",i=[],s,o,a,f,l,c,h,p,v,m,g,y,b,w;if(this.currentRegion===n){return""}s=this.getCurrentRegionFields();g=e.get("tooltipFormatter");if(g){return g(this,e,s)}if(e.get("tooltipChartTitle")){t+='<div class="jqs jqstitle">'+e.get("tooltipChartTitle")+"</div>\n"}o=this.options.get("tooltipFormat");if(!o){return""}if(!r.isArray(o)){o=[o]}if(!r.isArray(s)){s=[s]}h=this.options.get("tooltipFormatFieldlist");p=this.options.get("tooltipFormatFieldlistKey");if(h&&p){v=[];for(c=s.length;c--;){m=s[c][p];if((w=r.inArray(m,h))!=-1){v[w]=s[c]}}s=v}a=o.length;b=s.length;for(c=0;c<a;c++){y=o[c];if(typeof y==="string"){y=new u(y)}f=y.fclass||"jqsfield";for(w=0;w<b;w++){if(!s[w].isNull||!e.get("tooltipSkipNull")){r.extend(s[w],{prefix:e.get("tooltipPrefix"),suffix:e.get("tooltipSuffix")});l=y.render(s[w],e.get("tooltipValueLookups"),e);i.push('<div class="'+f+'">'+l+"</div>")}}}if(i.length){return t+i.join("\n")}return""},getCurrentRegionFields:function(){},calcHighlightColor:function(e,n){var r=n.get("highlightColor"),i=n.get("highlightLighten"),s,o,u,f;if(r){return r}if(i){s=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(e)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e);if(s){u=[];o=e.length===4?16:1;for(f=0;f<3;f++){u[f]=a(t.round(parseInt(s[f+1],16)*o*i),0,255)}return"rgb("+u.join(",")+")"}}return e}});N={changeHighlight:function(e){var t=this.currentRegion,n=this.target,i=this.regionShapes[t],s;if(i){s=this.renderRegion(t,e);if(r.isArray(s)||r.isArray(i)){n.replaceWithShapes(i,s);this.regionShapes[t]=r.map(s,function(e){return e.id})}else{n.replaceWithShape(i,s);this.regionShapes[t]=s.id}}},render:function(){var e=this.values,t=this.target,n=this.regionShapes,i,s,o,u;if(!this.cls._super.render.call(this)){return}for(o=e.length;o--;){i=this.renderRegion(o);if(i){if(r.isArray(i)){s=[];for(u=i.length;u--;){i[u].append();s.push(i[u].id)}n[o]=s}else{i.append();n[o]=i.id}}else{n[o]=null}}t.render()}};r.fn.sparkline.line=C=o(r.fn.sparkline._base,{type:"line",init:function(e,t,n,r,i){C._super.init.call(this,e,t,n,r,i);this.vertices=[];this.regionMap=[];this.xvalues=[];this.yvalues=[];this.yminmax=[];this.hightlightSpotId=null;this.lastShapeId=null;this.initTarget()},getRegion:function(e,t,r){var i,s=this.regionMap;for(i=s.length;i--;){if(s[i]!==null&&t>=s[i][0]&&t<=s[i][1]){return s[i][2]}}return n},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.yvalues[e]===null,x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){var e=this.currentRegion,t=this.target,r=this.vertices[e],i=this.options,s=i.get("spotRadius"),o=i.get("highlightSpotColor"),u=i.get("highlightLineColor"),a,f;if(!r){return}if(s&&o){a=t.drawCircle(r[0],r[1],s,n,o);this.highlightSpotId=a.id;t.insertAfterShape(this.lastShapeId,a)}if(u){f=t.drawLine(r[0],this.canvasTop,r[0],this.canvasTop+this.canvasHeight,u);this.highlightLineId=f.id;t.insertAfterShape(this.lastShapeId,f)}},removeHighlight:function(){var e=this.target;if(this.highlightSpotId){e.removeShapeId(this.highlightSpotId);this.highlightSpotId=null}if(this.highlightLineId){e.removeShapeId(this.highlightLineId);this.highlightLineId=null}},scanValues:function(){var e=this.values,n=e.length,r=this.xvalues,i=this.yvalues,s=this.yminmax,o,u,a,f,l;for(o=0;o<n;o++){u=e[o];a=typeof e[o]==="string";f=typeof e[o]==="object"&&e[o]instanceof Array;l=a&&e[o].split(":");if(a&&l.length===2){r.push(Number(l[0]));i.push(Number(l[1]));s.push(Number(l[1]))}else{if(f){r.push(u[0]);i.push(u[1]);s.push(u[1])}else{r.push(o);if(e[o]===null||e[o]==="null"){i.push(null)}else{i.push(Number(u));s.push(Number(u))}}}}if(this.options.get("xvalues")){r=this.options.get("xvalues")}this.maxy=this.maxyorg=t.max.apply(t,s);this.miny=this.minyorg=t.min.apply(t,s);this.maxx=t.max.apply(t,r);this.minx=t.min.apply(t,r);this.xvalues=r;this.yvalues=i;this.yminmax=s},processRangeOptions:function(){var e=this.options,t=e.get("normalRangeMin"),r=e.get("normalRangeMax");if(t!==n){if(t<this.miny){this.miny=t}if(r>this.maxy){this.maxy=r}}if(e.get("chartRangeMin")!==n&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)){this.miny=e.get("chartRangeMin")}if(e.get("chartRangeMax")!==n&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)){this.maxy=e.get("chartRangeMax")}if(e.get("chartRangeMinX")!==n&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)){this.minx=e.get("chartRangeMinX")}if(e.get("chartRangeMaxX")!==n&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)){this.maxx=e.get("chartRangeMaxX")}},drawNormalRange:function(e,r,i,s,o){var u=this.options.get("normalRangeMin"),a=this.options.get("normalRangeMax"),f=r+t.round(i-i*((a-this.miny)/o)),l=t.round(i*(a-u)/o);this.target.drawRect(e,f,s,l,n,this.options.get("normalRangeColor")).append()},render:function(){var e=this.options,i=this.target,s=this.canvasWidth,o=this.canvasHeight,u=this.vertices,a=e.get("spotRadius"),f=this.regionMap,l,h,p,v,m,g,y,b,w,E,x,T,N,k,L,A,O,M,_,D,P,H,B,j,F;if(!C._super.render.call(this)){return}this.scanValues();this.processRangeOptions();B=this.xvalues;j=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return}v=m=0;l=this.maxx-this.minx===0?1:this.maxx-this.minx;h=this.maxy-this.miny===0?1:this.maxy-this.miny;p=this.yvalues.length-1;if(a&&(s<a*4||o<a*4)){a=0}if(a){P=e.get("highlightSpotColor")&&!e.get("disableInteraction");if(P||e.get("minSpotColor")||e.get("spotColor")&&j[p]===this.miny){o-=t.ceil(a)}if(P||e.get("maxSpotColor")||e.get("spotColor")&&j[p]===this.maxy){o-=t.ceil(a);v+=t.ceil(a)}if(P||(e.get("minSpotColor")||e.get("maxSpotColor"))&&(j[0]===this.miny||j[0]===this.maxy)){m+=t.ceil(a);s-=t.ceil(a)}if(P||e.get("spotColor")||e.get("minSpotColor")||e.get("maxSpotColor")&&(j[p]===this.miny||j[p]===this.maxy)){s-=t.ceil(a)}}o--;if(e.get("normalRangeMin")!==n&&!e.get("drawNormalOnTop")){this.drawNormalRange(m,v,o,s,h)}y=[];b=[y];k=L=null;A=j.length;for(F=0;F<A;F++){w=B[F];x=B[F+1];E=j[F];T=m+t.round((w-this.minx)*(s/l));N=F<A-1?m+t.round((x-this.minx)*(s/l)):s;L=T+(N-T)/2;f[F]=[k||0,L,F];k=L;if(E===null){if(F){if(j[F-1]!==null){y=[];b.push(y)}u.push(null)}}else{if(E<this.miny){E=this.miny}if(E>this.maxy){E=this.maxy}if(!y.length){y.push([T,v+o])}g=[T,v+t.round(o-o*((E-this.miny)/h))];y.push(g);u.push(g)}}O=[];M=[];_=b.length;for(F=0;F<_;F++){y=b[F];if(y.length){if(e.get("fillColor")){y.push([y[y.length-1][0],v+o]);M.push(y.slice(0));y.pop()}if(y.length>2){y[0]=[y[0][0],y[1][1]]}O.push(y)}}_=M.length;for(F=0;F<_;F++){i.drawShape(M[F],e.get("fillColor"),e.get("fillColor")).append()}if(e.get("normalRangeMin")!==n&&e.get("drawNormalOnTop")){this.drawNormalRange(m,v,o,s,h)}_=O.length;for(F=0;F<_;F++){i.drawShape(O[F],e.get("lineColor"),n,e.get("lineWidth")).append()}if(a&&e.get("valueSpots")){D=e.get("valueSpots");if(D.get===n){D=new S(D)}for(F=0;F<A;F++){H=D.get(j[F]);if(H){i.drawCircle(m+t.round((B[F]-this.minx)*(s/l)),v+t.round(o-o*((j[F]-this.miny)/h)),a,n,H).append()}}}if(a&&e.get("spotColor")&&j[p]!==null){i.drawCircle(m+t.round((B[B.length-1]-this.minx)*(s/l)),v+t.round(o-o*((j[p]-this.miny)/h)),a,n,e.get("spotColor")).append()}if(this.maxy!==this.minyorg){if(a&&e.get("minSpotColor")){w=B[r.inArray(this.minyorg,j)];i.drawCircle(m+t.round((w-this.minx)*(s/l)),v+t.round(o-o*((this.minyorg-this.miny)/h)),a,n,e.get("minSpotColor")).append()}if(a&&e.get("maxSpotColor")){w=B[r.inArray(this.maxyorg,j)];i.drawCircle(m+t.round((w-this.minx)*(s/l)),v+t.round(o-o*((this.maxyorg-this.miny)/h)),a,n,e.get("maxSpotColor")).append()}}this.lastShapeId=i.getLastShapeId();this.canvasTop=v;i.render()}});r.fn.sparkline.bar=k=o(r.fn.sparkline._base,N,{type:"bar",init:function(e,i,s,o,u){var f=parseInt(s.get("barWidth"),10),v=parseInt(s.get("barSpacing"),10),m=s.get("chartRangeMin"),g=s.get("chartRangeMax"),y=s.get("chartRangeClip"),b=Infinity,w=-Infinity,E,x,T,N,C,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X;k._super.init.call(this,e,i,s,o,u);for(L=0,A=i.length;L<A;L++){U=i[L];E=typeof U==="string"&&U.indexOf(":")>-1;if(E||r.isArray(U)){j=true;if(E){U=i[L]=h(U.split(":"))}U=p(U,null);x=t.min.apply(t,U);T=t.max.apply(t,U);if(x<b){b=x}if(T>w){w=T}}}this.stacked=j;this.regionShapes={};this.barWidth=f;this.barSpacing=v;this.totalBarWidth=f+v;this.width=o=i.length*f+(i.length-1)*v;this.initTarget();if(y){H=m===n?-Infinity:m;B=g===n?Infinity:g}C=[];N=j?[]:C;var V=[];var $=[];for(L=0,A=i.length;L<A;L++){if(j){F=i[L];i[L]=R=[];V[L]=0;N[L]=$[L]=0;for(I=0,q=F.length;I<q;I++){U=R[I]=y?a(F[I],H,B):F[I];if(U!==null){if(U>0){V[L]+=U}if(b<0&&w>0){if(U<0){$[L]+=t.abs(U)}else{N[L]+=U}}else{N[L]+=t.abs(U-(U<0?w:b))}C.push(U)}}}else{U=y?a(i[L],H,B):i[L];U=i[L]=l(U);if(U!==null){C.push(U)}}}this.max=P=t.max.apply(t,C);this.min=D=t.min.apply(t,C);this.stackMax=w=j?t.max.apply(t,V):P;this.stackMin=b=j?t.min.apply(t,C):D;if(s.get("chartRangeMin")!==n&&(s.get("chartRangeClip")||s.get("chartRangeMin")<D)){D=s.get("chartRangeMin")}if(s.get("chartRangeMax")!==n&&(s.get("chartRangeClip")||s.get("chartRangeMax")>P)){P=s.get("chartRangeMax")}this.zeroAxis=M=s.get("zeroAxis",true);if(D<=0&&P>=0&&M){_=0}else{if(M==false){_=D}else{if(D>0){_=D}else{_=P}}}this.xaxisOffset=_;O=j?t.max.apply(t,N)+t.max.apply(t,$):P-D;this.canvasHeightEf=M&&D<0?this.canvasHeight-2:this.canvasHeight-1;if(D<_){W=j&&P>=0?w:P;z=(W-_)/O*this.canvasHeight;if(z!==t.ceil(z)){this.canvasHeightEf-=2;z=t.ceil(z)}}else{z=this.canvasHeight}this.yoffset=z;if(r.isArray(s.get("colorMap"))){this.colorMapByIndex=s.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=s.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===n){this.colorMapByValue=new S(this.colorMapByValue)}}this.range=O},getRegion:function(e,r,i){var s=t.floor(r/this.totalBarWidth);return s<0||s>=this.values.length?n:s},getCurrentRegionFields:function(){var e=this.currentRegion,t=w(this.values[e]),n=[],r,i;for(i=t.length;i--;){r=t[i];n.push({isNull:r===null,value:r,color:this.calcColor(i,r,e),offset:e})}return n},calcColor:function(e,t,i){var s=this.colorMapByIndex,o=this.colorMapByValue,u=this.options,a,f;if(this.stacked){a=u.get("stackedBarColor")}else{a=t<0?u.get("negBarColor"):u.get("barColor")}if(t===0&&u.get("zeroColor")!==n){a=u.get("zeroColor")}if(o&&(f=o.get(t))){a=f}else{if(s&&s.length>i){a=s[i]}}return r.isArray(a)?a[e%a.length]:a},renderRegion:function(e,i){var s=this.values[e],o=this.options,u=this.xaxisOffset,a=[],f=this.range,l=this.stacked,h=this.target,p=e*this.totalBarWidth,v=this.canvasHeightEf,g=this.yoffset,y,b,w,E,S,x,T,N,C,k;s=r.isArray(s)?s:[s];T=s.length;N=s[0];E=m(null,s);k=m(u,s,true);if(E){if(o.get("nullColor")){w=i?o.get("nullColor"):this.calcHighlightColor(o.get("nullColor"),o);y=g>0?g-1:g;return h.drawRect(p,y,this.barWidth-1,0,w,w)}else{return n}}S=g;for(x=0;x<T;x++){N=s[x];if(l&&N===u){if(!k||C){continue}C=true}if(f>0){b=t.floor(v*(t.abs(N-u)/f))+1}else{b=1}if(N<u||N===u&&g===0){y=S;S+=b}else{y=g-b;g-=b}w=this.calcColor(x,N,e);if(i){w=this.calcHighlightColor(w,o)}a.push(h.drawRect(p,y,this.barWidth-1,b-1,w,w))}if(a.length===1){return a[0]}return a}});r.fn.sparkline.tristate=L=o(r.fn.sparkline._base,N,{type:"tristate",init:function(e,t,i,s,o){var u=parseInt(i.get("barWidth"),10),a=parseInt(i.get("barSpacing"),10);L._super.init.call(this,e,t,i,s,o);this.regionShapes={};this.barWidth=u;this.barSpacing=a;this.totalBarWidth=u+a;this.values=r.map(t,Number);this.width=s=t.length*u+(t.length-1)*a;if(r.isArray(i.get("colorMap"))){this.colorMapByIndex=i.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=i.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===n){this.colorMapByValue=new S(this.colorMapByValue)}}this.initTarget()},getRegion:function(e,n,r){return t.floor(n/this.totalBarWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.values[e]===n,value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,t){var n=this.values,r=this.options,i=this.colorMapByIndex,s=this.colorMapByValue,o,u;if(s&&(u=s.get(e))){o=u}else{if(i&&i.length>t){o=i[t]}else{if(n[t]<0){o=r.get("negBarColor")}else{if(n[t]>0){o=r.get("posBarColor")}else{o=r.get("zeroBarColor")}}}}return o},renderRegion:function(e,n){var r=this.values,i=this.options,s=this.target,o,u,a,f,l,h;o=s.pixelHeight;a=t.round(o/2);f=e*this.totalBarWidth;if(r[e]<0){l=a;u=a-1}else{if(r[e]>0){l=0;u=a-1}else{l=a-1;u=2}}h=this.calcColor(r[e],e);if(h===null){return}if(n){h=this.calcHighlightColor(h,i)}return s.drawRect(f,l,this.barWidth-1,u-1,h,h)}});r.fn.sparkline.discrete=A=o(r.fn.sparkline._base,N,{type:"discrete",init:function(e,i,s,o,u){A._super.init.call(this,e,i,s,o,u);this.regionShapes={};this.values=i=r.map(i,Number);this.min=t.min.apply(t,i);this.max=t.max.apply(t,i);this.range=this.max-this.min;this.width=o=s.get("width")==="auto"?i.length*2:this.width;this.interval=t.floor(o/i.length);this.itemWidth=o/i.length;if(s.get("chartRangeMin")!==n&&(s.get("chartRangeClip")||s.get("chartRangeMin")<this.min)){this.min=s.get("chartRangeMin")}if(s.get("chartRangeMax")!==n&&(s.get("chartRangeClip")||s.get("chartRangeMax")>this.max)){this.max=s.get("chartRangeMax")}this.initTarget();if(this.target){this.lineHeight=s.get("lineHeight")==="auto"?t.round(this.canvasHeight*.3):s.get("lineHeight")}},getRegion:function(e,n,r){return t.floor(n/this.itemWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.values[e]===n,value:this.values[e],offset:e}},renderRegion:function(e,n){var r=this.values,i=this.options,s=this.min,o=this.max,u=this.range,f=this.interval,l=this.target,h=this.canvasHeight,p=this.lineHeight,d=h-p,v,m,g,y;m=a(r[e],s,o);y=e*f;v=t.round(d-d*((m-s)/u));g=i.get("thresholdColor")&&m<i.get("thresholdValue")?i.get("thresholdColor"):i.get("lineColor");if(n){g=this.calcHighlightColor(g,i)}return l.drawLine(y,v,y,v+p,g)}});r.fn.sparkline.bullet=O=o(r.fn.sparkline._base,{type:"bullet",init:function(e,r,i,s,o){var u,a,f;O._super.init.call(this,e,r,i,s,o);this.values=r=h(r);f=r.slice();f[0]=f[0]===null?f[2]:f[0];f[1]=r[1]===null?f[2]:f[1];u=t.min.apply(t,r);a=t.max.apply(t,r);if(i.get("base")===n){u=u<0?u:0}else{u=i.get("base")}this.min=u;this.max=a;this.range=a-u;this.shapes={};this.valueShapes={};this.regiondata={};this.width=s=i.get("width")==="auto"?"4.0em":s;this.target=this.$el.simpledraw(s,o,i.get("composite"));if(!r.length){this.disabled=true}this.initTarget()},getRegion:function(e,t,r){var i=this.target.getShapeAt(e,t,r);return i!==n&&this.shapes[i]!==n?this.shapes[i]:n},getCurrentRegionFields:function(){var e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){var t=this.currentRegion,n=this.valueShapes[t],r;delete this.shapes[n];switch(t.substr(0,1)){case"r":r=this.renderRange(t.substr(1),e);break;case"p":r=this.renderPerformance(e);break;case"t":r=this.renderTarget(e);break}this.valueShapes[t]=r.id;this.shapes[r.id]=t;this.target.replaceWithShape(n,r)},renderRange:function(e,n){var r=this.values[e],i=t.round(this.canvasWidth*((r-this.min)/this.range)),s=this.options.get("rangeColors")[e-2];if(n){s=this.calcHighlightColor(s,this.options)}return this.target.drawRect(0,0,i-1,this.canvasHeight-1,s,s)},renderPerformance:function(e){var n=this.values[1],r=t.round(this.canvasWidth*((n-this.min)/this.range)),i=this.options.get("performanceColor");if(e){i=this.calcHighlightColor(i,this.options)}return this.target.drawRect(0,t.round(this.canvasHeight*.3),r-1,t.round(this.canvasHeight*.4)-1,i,i)},renderTarget:function(e){var n=this.values[0],r=t.round(this.canvasWidth*((n-this.min)/this.range)-this.options.get("targetWidth")/2),i=t.round(this.canvasHeight*.1),s=this.canvasHeight-i*2,o=this.options.get("targetColor");if(e){o=this.calcHighlightColor(o,this.options)}return this.target.drawRect(r,i,this.options.get("targetWidth")-1,s-1,o,o)},render:function(){var e=this.values.length,t=this.target,n,r;if(!O._super.render.call(this)){return}for(n=2;n<e;n++){r=this.renderRange(n).append();this.shapes[r.id]="r"+n;this.valueShapes["r"+n]=r.id}if(this.values[1]!==null){r=this.renderPerformance().append();this.shapes[r.id]="p1";this.valueShapes.p1=r.id}if(this.values[0]!==null){r=this.renderTarget().append();this.shapes[r.id]="t0";this.valueShapes.t0=r.id}t.render()}});r.fn.sparkline.pie=M=o(r.fn.sparkline._base,{type:"pie",init:function(e,n,i,s,o){var u=0,a;M._super.init.call(this,e,n,i,s,o);this.shapes={};this.valueShapes={};this.values=n=r.map(n,Number);if(i.get("width")==="auto"){this.width=this.height}if(n.length>0){for(a=n.length;a--;){u+=n[a]}}this.total=u;this.initTarget();this.radius=t.floor(t.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,t,r){var i=this.target.getShapeAt(e,t,r);return i!==n&&this.shapes[i]!==n?this.shapes[i]:n},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:this.values[e]===n,value:this.values[e],percent:this.values[e]/this.total*100,color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){var t=this.currentRegion,n=this.renderSlice(t,e),r=this.valueShapes[t];delete this.shapes[r];this.target.replaceWithShape(r,n);this.valueShapes[t]=n.id;this.shapes[n.id]=t},renderSlice:function(e,r){var i=this.target,s=this.options,o=this.radius,u=s.get("borderWidth"),a=s.get("offset"),f=2*t.PI,l=this.values,h=this.total,p=a?2*t.PI*(a/360):0,v,m,g,y,b;y=l.length;for(g=0;g<y;g++){v=p;m=p;if(h>0){m=p+f*(l[g]/h)}if(e===g){b=s.get("sliceColors")[g%s.get("sliceColors").length];if(r){b=this.calcHighlightColor(b,s)}return i.drawPieSlice(o,o,o-u,v,m,n,b)}p=m}},render:function(){var e=this.target,r=this.values,i=this.options,s=this.radius,o=i.get("borderWidth"),u,a;if(!M._super.render.call(this)){return}if(o){e.drawCircle(s,s,t.floor(s-o/2),i.get("borderColor"),n,o).append()}for(a=r.length;a--;){if(r[a]){u=this.renderSlice(a).append();this.valueShapes[a]=u.id;this.shapes[u.id]=a}}e.render()}});r.fn.sparkline.box=_=o(r.fn.sparkline._base,{type:"box",init:function(e,t,n,i,s){_._super.init.call(this,e,t,n,i,s);this.values=r.map(t,Number);this.width=n.get("width")==="auto"?"4.0em":i;this.initTarget();if(!this.values.length){this.disabled=1}},getRegion:function(){return 1},getCurrentRegionFields:function(){var e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];if(this.loutlier!==n){e.push({field:"lo",value:this.loutlier})}if(this.routlier!==n){e.push({field:"ro",value:this.routlier})}if(this.lwhisker!==n){e.push({field:"lw",value:this.lwhisker})}if(this.rwhisker!==n){e.push({field:"rw",value:this.rwhisker})}return e},render:function(){var e=this.target,r=this.values,i=r.length,s=this.options,o=this.canvasWidth,u=this.canvasHeight,a=s.get("chartRangeMin")===n?t.min.apply(t,r):s.get("chartRangeMin"),l=s.get("chartRangeMax")===n?t.max.apply(t,r):s.get("chartRangeMax"),h=0,p,v,m,g,y,b,w,E,S,x,T;if(!_._super.render.call(this)){return}if(s.get("raw")){if(s.get("showOutliers")&&r.length>5){v=r[0];p=r[1];g=r[2];y=r[3];b=r[4];w=r[5];E=r[6]}else{p=r[0];g=r[1];y=r[2];b=r[3];w=r[4]}}else{r.sort(function(e,t){return e-t});g=f(r,1);y=f(r,2);b=f(r,3);m=b-g;if(s.get("showOutliers")){p=w=n;for(S=0;S<i;S++){if(p===n&&r[S]>g-m*s.get("outlierIQR")){p=r[S]}if(r[S]<b+m*s.get("outlierIQR")){w=r[S]}}v=r[0];E=r[i-1]}else{p=r[0];w=r[i-1]}}this.quartiles=[g,y,b];this.lwhisker=p;this.rwhisker=w;this.loutlier=v;this.routlier=E;T=o/(l-a+1);if(s.get("showOutliers")){h=t.ceil(s.get("spotRadius"));o-=2*t.ceil(s.get("spotRadius"));T=o/(l-a+1);if(v<p){e.drawCircle((v-a)*T+h,u/2,s.get("spotRadius"),s.get("outlierLineColor"),s.get("outlierFillColor")).append()}if(E>w){e.drawCircle((E-a)*T+h,u/2,s.get("spotRadius"),s.get("outlierLineColor"),s.get("outlierFillColor")).append()}}e.drawRect(t.round((g-a)*T+h),t.round(u*.1),t.round((b-g)*T),t.round(u*.8),s.get("boxLineColor"),s.get("boxFillColor")).append();e.drawLine(t.round((p-a)*T+h),t.round(u/2),t.round((g-a)*T+h),t.round(u/2),s.get("lineColor")).append();e.drawLine(t.round((p-a)*T+h),t.round(u/4),t.round((p-a)*T+h),t.round(u-u/4),s.get("whiskerColor")).append();e.drawLine(t.round((w-a)*T+h),t.round(u/2),t.round((b-a)*T+h),t.round(u/2),s.get("lineColor")).append();e.drawLine(t.round((w-a)*T+h),t.round(u/4),t.round((w-a)*T+h),t.round(u-u/4),s.get("whiskerColor")).append();e.drawLine(t.round((y-a)*T+h),t.round(u*.1),t.round((y-a)*T+h),t.round(u*.9),s.get("medianColor")).append();if(s.get("target")){x=t.ceil(s.get("spotRadius"));e.drawLine(t.round((s.get("target")-a)*T+h),t.round(u/2-x),t.round((s.get("target")-a)*T+h),t.round(u/2+x),s.get("targetColor")).append();e.drawLine(t.round((s.get("target")-a)*T+h-x),t.round(u/2),t.round((s.get("target")-a)*T+h+x),t.round(u/2),s.get("targetColor")).append()}e.render()}});H=o({init:function(e,t,n,r){this.target=e;this.id=t;this.type=n;this.args=r},append:function(){this.target.appendShape(this);return this}});B=o({_pxregex:/(\d+)(px)?\s*$/i,init:function(e,t,n){if(!e){return}this.width=e;this.height=t;this.target=n;this.lastShapeId=null;if(n[0]){n=n[0]}r.data(n,"_jqs_vcanvas",this)},drawLine:function(e,t,n,r,i,s){return this.drawShape([[e,t],[n,r]],i,s)},drawShape:function(e,t,n,r){return this._genShape("Shape",[e,t,n,r])},drawCircle:function(e,t,n,r,i,s){return this._genShape("Circle",[e,t,n,r,i,s])},drawPieSlice:function(e,t,n,r,i,s,o){return this._genShape("PieSlice",[e,t,n,r,i,s,o])},drawRect:function(e,t,n,r,i,s){return this._genShape("Rect",[e,t,n,r,i,s])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(e,t){r(t).html(e)},_calculatePixelDims:function(e,t,n){var i;i=this._pxregex.exec(t);if(i){this.pixelHeight=i[1]}else{this.pixelHeight=r(n).height()}i=this._pxregex.exec(e);if(i){this.pixelWidth=i[1]}else{this.pixelWidth=r(n).width()}},_genShape:function(e,t){var n=q++;t.unshift(n);return new H(this,n,e,t)},appendShape:function(e){alert("appendShape not implemented")},replaceWithShape:function(e,t){alert("replaceWithShape not implemented")},insertAfterShape:function(e,t){alert("insertAfterShape not implemented")},removeShapeId:function(e){alert("removeShapeId not implemented")},getShapeAt:function(e,t,n){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}});j=o(B,{init:function(t,i,s,o){j._super.init.call(this,t,i,s);this.canvas=e.createElement("canvas");if(s[0]){s=s[0]}r.data(s,"_jqs_vcanvas",this);r(this.canvas).css({display:"inline-block",width:t,height:i,verticalAlign:"top"});this._insert(this.canvas,s);this._calculatePixelDims(t,i,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.interact=o;this.shapes={};this.shapeseq=[];this.currentTargetShapeId=n;r(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(e,t,r){var i=this.canvas.getContext("2d");if(e!==n){i.strokeStyle=e}i.lineWidth=r===n?1:r;if(t!==n){i.fillStyle=t}return i},reset:function(){var e=this._getContext();e.clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=n},_drawShape:function(e,t,r,i,s){var o=this._getContext(r,i,s),u,a;o.beginPath();o.moveTo(t[0][0]+.5,t[0][1]+.5);for(u=1,a=t.length;u<a;u++){o.lineTo(t[u][0]+.5,t[u][1]+.5)}if(r!==n){o.stroke()}if(i!==n){o.fill()}if(this.targetX!==n&&this.targetY!==n&&o.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=e}},_drawCircle:function(e,r,i,s,o,u,a){var f=this._getContext(o,u,a);f.beginPath();f.arc(r,i,s,0,2*t.PI,false);if(this.targetX!==n&&this.targetY!==n&&f.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=e}if(o!==n){f.stroke()}if(u!==n){f.fill()}},_drawPieSlice:function(e,t,r,i,s,o,u,a){var f=this._getContext(u,a);f.beginPath();f.moveTo(t,r);f.arc(t,r,i,s,o,false);f.lineTo(t,r);f.closePath();if(u!==n){f.stroke()}if(a){f.fill()}if(this.targetX!==n&&this.targetY!==n&&f.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=e}},_drawRect:function(e,t,n,r,i,s,o){return this._drawShape(e,[[t,n],[t+r,n],[t+r,n+i],[t,n+i],[t,n]],s,o)},appendShape:function(e){this.shapes[e.id]=e;this.shapeseq.push(e.id);this.lastShapeId=e.id;return e.id},replaceWithShape:function(e,t){var n=this.shapeseq,r;this.shapes[t.id]=t;for(r=n.length;r--;){if(n[r]==e){n[r]=t.id}}delete this.shapes[e]},replaceWithShapes:function(e,t){var n=this.shapeseq,r={},i,s,o;for(s=e.length;s--;){r[e[s]]=true}for(s=n.length;s--;){i=n[s];if(r[i]){n.splice(s,1);delete this.shapes[i];o=s}}for(s=t.length;s--;){n.splice(o,0,t[s].id);this.shapes[t[s].id]=t[s]}},insertAfterShape:function(e,t){var n=this.shapeseq,r;for(r=n.length;r--;){if(n[r]===e){n.splice(r+1,0,t.id);this.shapes[t.id]=t;return}}},removeShapeId:function(e){var t=this.shapeseq,n;for(n=t.length;n--;){if(t[n]===e){t.splice(n,1);break}}delete this.shapes[e]},getShapeAt:function(e,t,n){this.targetX=t;this.targetY=n;this.render();return this.currentTargetShapeId},render:function(){var e=this.shapeseq,t=this.shapes,n=e.length,r=this._getContext(),i,s,o;r.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(o=0;o<n;o++){i=e[o];s=t[i];this["_draw"+s.type].apply(this,s.args)}if(!this.interact){this.shapes={};this.shapeseq=[]}}});F=o(B,{init:function(t,n,i){var s;F._super.init.call(this,t,n,i);if(i[0]){i=i[0]}r.data(i,"_jqs_vcanvas",this);this.canvas=e.createElement("span");r(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:t,height:n,margin:"0px",padding:"0px",verticalAlign:"top"});this._insert(this.canvas,i);this._calculatePixelDims(t,n,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;s='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>';this.canvas.insertAdjacentHTML("beforeEnd",s);this.group=r(this.canvas).children()[0];this.rendered=false;this.prerender=""},_drawShape:function(e,t,r,i,s){var o=[],u,a,f,l,c,h,p;for(p=0,h=t.length;p<h;p++){o[p]=""+t[p][0]+","+t[p][1]}u=o.splice(0,1);s=s===n?1:s;a=r===n?' stroked="false" ':' strokeWeight="'+s+'px" strokeColor="'+r+'" ';f=i===n?' filled="false"':' fillColor="'+i+'" filled="true" ';l=o[0]===o[o.length-1]?"x ":"";c='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+e+'" '+a+f+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+u+" l "+o.join(", ")+" "+l+'e"> </v:shape>';return c},_drawCircle:function(e,t,r,i,s,o,u){var a,f,l;t-=i;r-=i;a=s===n?' stroked="false" ':' strokeWeight="'+u+'px" strokeColor="'+s+'" ';f=o===n?' filled="false"':' fillColor="'+o+'" filled="true" ';l='<v:oval  id="jqsshape'+e+'" '+a+f+' style="position:absolute;top:'+r+"px; left:"+t+"px; width:"+i*2+"px; height:"+i*2+'px"></v:oval>';return l},_drawPieSlice:function(e,r,i,s,o,u,a,f){var l,h,p,v,m,g,y,b;if(o===u){return""}if(u-o===2*t.PI){o=0;u=2*t.PI}h=r+t.round(t.cos(o)*s);p=i+t.round(t.sin(o)*s);v=r+t.round(t.cos(u)*s);m=i+t.round(t.sin(u)*s);if(h===v&&p===m){if(u-o<t.PI){return""}h=v=r+s;p=m=i}if(h===v&&p===m&&u-o<t.PI){return""}l=[r-s,i-s,r+s,i+s,h,p,v,m];g=a===n?' stroked="false" ':' strokeWeight="1px" strokeColor="'+a+'" ';y=f===n?' filled="false"':' fillColor="'+f+'" filled="true" ';b='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+e+'" '+g+y+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+r+","+i+" wa "+l.join(", ")+' x e"> </v:shape>';return b},_drawRect:function(e,t,n,r,i,s,o){return this._drawShape(e,[[t,n],[t,n+i],[t+r,n+i],[t+r,n],[t,n]],s,o)},reset:function(){this.group.innerHTML=""},appendShape:function(e){var t=this["_draw"+e.type].apply(this,e.args);if(this.rendered){this.group.insertAdjacentHTML("beforeEnd",t)}else{this.prerender+=t}this.lastShapeId=e.id;return e.id},replaceWithShape:function(e,t){var n=r("#jqsshape"+e),i=this["_draw"+t.type].apply(this,t.args);n[0].outerHTML=i},replaceWithShapes:function(e,t){var n=r("#jqsshape"+e[0]),i="",s=t.length,o;for(o=0;o<s;o++){i+=this["_draw"+t[o].type].apply(this,t[o].args)}n[0].outerHTML=i;for(o=1;o<e.length;o++){r("#jqsshape"+e[o]).remove()}},insertAfterShape:function(e,t){var n=r("#jqsshape"+e),i=this["_draw"+t.type].apply(this,t.args);n[0].insertAdjacentHTML("afterEnd",i)},removeShapeId:function(e){var t=r("#jqsshape"+e);this.group.removeChild(t[0])},getShapeAt:function(e,t,n){var r=e.id.substr(8);return r},render:function(){if(!this.rendered){this.group.innerHTML=this.prerender;this.rendered=true}}})})})(document,Math);!function(e){var t=function(t,n){this.$ns="bootstrap-markdown";this.$element=e(t);this.$editable={el:null,type:null,attrKeys:[],attrValues:[],content:null};this.$options=e.extend(true,{},e.fn.markdown.defaults,n);this.$oldContent=null;this.$isPreview=false;this.$editor=null;this.$textarea=null;this.$handler=[];this.$callback=[];this.$nextTab=[];this.showEditor()};t.prototype={constructor:t,__alterButtons:function(t,n){var r=this.$handler,i=t=="all",s=this;e.each(r,function(e,r){var o=true;if(i){o=false}else{o=r.indexOf(t)<0}if(o==false){n(s.$editor.find('button[data-handler="'+r+'"]'))}})},__buildButtons:function(t,n){var r,i=this.$ns,s=this.$handler,o=this.$callback;for(r=0;r<t.length;r++){var u,a=t[r];for(u=0;u<a.length;u++){var l,c=a[u].data,h=e("<div/>",{"class":"btn-group"});for(l=0;l<c.length;l++){var p=c[l],d="",v=i+"-"+p.name,m=p.btnText?p.btnText:"",g=p.btnClass?p.btnClass:"btn";if(p.toggle==true){d=' data-toggle="button"'}h.append('<button class="'+g+' btn-small" title="'+p.title+'" data-provider="'+i+'" data-handler="'+v+'"'+d+'><i class="'+p.icon+'"></i> '+m+"</button>");s.push(v);o.push(p.callback)}n.append(h)}}return n},__setListener:function(){var t=typeof this.$textarea.attr("rows")!="undefined",n=this.$textarea.val().split("\n").length>5?this.$textarea.val().split("\n").length:"5",r=t?this.$textarea.attr("rows"):n;this.$textarea.attr("rows",r);this.$textarea.css("resize","none");this.$textarea.on("focus",e.proxy(this.focus,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this));if(this.eventSupported("keydown")){this.$textarea.on("keydown",e.proxy(this.keydown,this))}this.$textarea.data("markdown",this)},__handle:function(t){var n=e(t.currentTarget),r=this.$handler,i=this.$callback,s=n.attr("data-handler"),o=r.indexOf(s),u=i[o];e(t.currentTarget).focus();u(this);if(s.indexOf("cmdSave")<0){this.$textarea.focus()}t.preventDefault()},showEditor:function(){var t=this,n,r=this.$ns,i=this.$element,s=i.css("height"),o=i.css("width"),u=this.$editable,a=this.$handler,l=this.$callback,c=this.$options,h=e("<div/>",{"class":"md-editor",click:function(){t.focus()}});if(this.$editor==null){var p=e("<div/>",{"class":"md-header"});if(c.buttons.length>0){p=this.__buildButtons(c.buttons,p)}if(c.additionalButtons.length>0){p=this.__buildButtons(c.additionalButtons,p)}h.append(p);if(i.is("textarea")){i.before(h);n=i;n.addClass("md-input");h.append(n)}else{var d=typeof toMarkdown=="function"?toMarkdown(i.html()):i.html(),v=e.trim(d);n=e("<textarea/>",{"class":"md-input",val:v});h.append(n);u.el=i;u.type=i.prop("tagName").toLowerCase();u.content=i.html();e(i[0].attributes).each(function(){u.attrKeys.push(this.nodeName);u.attrValues.push(this.nodeValue)});i.replaceWith(h)}if(c.savable){var m=e("<div/>",{"class":"md-footer"}),g="cmdSave";a.push(g);l.push(c.onSave);m.append('<button class="btn btn-success" data-provider="'+r+'" data-handler="'+g+'"><i class="icon icon-white icon-ok"></i> Save</button>');h.append(m)}e.each(["height","width"],function(e,t){if(c[t]!="inherit"){if(jQuery.isNumeric(c[t])){h.css(t,c[t]+"px")}else{h.addClass(c[t])}}});this.$editor=h;this.$textarea=n;this.$editable=u;this.$oldContent=this.getContent();this.__setListener();this.$editor.attr("id",(new Date).getTime());this.$editor.on("click",'[data-provider="bootstrap-markdown"]',e.proxy(this.__handle,this))}else{this.$editor.show()}if(c.autofocus){this.$textarea.focus();this.$editor.addClass("active")}c.onShow(this);return this},showPreview:function(){var t=this.$options,n=t.onPreview(this),r=this.$textarea,i=r.next(),s=e("<div/>",{"class":"md-preview","data-provider":"markdown-preview"}),o;this.$isPreview=true;this.disableButtons("all").enableButtons("cmdPreview");if(typeof n=="string"){o=n}else{o=typeof markdown=="object"?markdown.toHTML(r.val()):r.val()}s.html(o);if(i&&i.attr("class")=="md-footer"){s.insertBefore(i)}else{r.parent().append(s)}r.hide();s.data("markdown",this);return this},hidePreview:function(){this.$isPreview=false;var e=this.$editor.find('div[data-provider="markdown-preview"]');e.remove();this.enableButtons("all");this.$textarea.show();this.__setListener();return this},isDirty:function(){return this.$oldContent!=this.getContent()},getContent:function(){return this.$textarea.val()},setContent:function(e){this.$textarea.val(e);return this},findSelection:function(e){var t=this.getContent(),n;if(n=t.indexOf(e),n>=0&&e.length>0){var r=this.getSelection(),i;this.setSelection(n,n+e.length);i=this.getSelection();this.setSelection(r.start,r.end);return i}else{return null}},getSelection:function(){var e=this.$textarea[0];return("selectionStart"in e&&function(){var t=e.selectionEnd-e.selectionStart;return{start:e.selectionStart,end:e.selectionEnd,length:t,text:e.value.substr(e.selectionStart,t)}}||function(){return null})()},setSelection:function(e,t){var n=this.$textarea[0];return("selectionStart"in n&&function(){n.selectionStart=e;n.selectionEnd=t;return}||function(){return null})()},replaceSelection:function(e){var t=this.$textarea[0];return("selectionStart"in t&&function(){t.value=t.value.substr(0,t.selectionStart)+e+t.value.substr(t.selectionEnd,t.value.length);t.selectionStart=t.value.length;return this}||function(){t.value+=e;return jQuery(t)})()},getNextTab:function(){if(this.$nextTab.length==0){return null}else{var e,t=this.$nextTab.shift();if(typeof t=="function"){e=t()}else{if(typeof t=="object"&&t.length>0){e=t}}return e}},setNextTab:function(e,t){if(typeof e=="string"){var n=this;this.$nextTab.push(function(){return n.findSelection(e)})}else{if(typeof e=="numeric"&&typeof t=="numeric"){var r=this.getSelection();this.setSelection(e,t);this.$nextTab.push(this.getSelection());this.setSelection(r.start,r.end)}}return},enableButtons:function(e){var t=function(e){e.removeAttr("disabled")};this.__alterButtons(e,t);return this},disableButtons:function(e){var t=function(e){e.attr("disabled","disabled")};this.__alterButtons(e,t);return this},eventSupported:function(e){var t=e in this.$element;if(!t){this.$element.setAttribute(e,"return;");t=typeof this.$element[e]==="function"}return t},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]);this.keyup(t)},keypress:function(e){if(this.suppressKeyPressRepeat){return}this.keyup(e)},keyup:function(e){var t=false;switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:var n;if(n=this.getNextTab(),n!=null){var r=this;setTimeout(function(){r.setSelection(n.start,n.end)},500)}else{this.setSelection(this.getContent().length,this.getContent().length)}t=true;break;case 13:case 27:t=false;break;default:t=false}if(t){e.stopPropagation();e.preventDefault()}},focus:function(t){var n=this.$options,r=n.hideable,i=this.$editor;i.addClass("active");e(document).find(".md-editor").each(function(){if(e(this).attr("id")!=i.attr("id")){var t;if(t=e(this).find("textarea").data("markdown"),t==null){t=e(this).find('div[data-provider="markdown-preview"]').data("markdown")}if(t){t.blur()}}});return this},blur:function(t){var n=this.$options,r=n.hideable,i=this.$editor,s=this.$editable;if(i.hasClass("active")||this.$element.parent().length==0){i.removeClass("active");if(r){if(s.el!=null){var o=e("<"+s.type+"/>"),u=this.getContent(),a=typeof markdown=="object"?markdown.toHTML(u):u;e(s.attrKeys).each(function(e,t){o.attr(s.attrKeys[e],s.attrValues[e])});o.html(a);i.replaceWith(o)}else{i.hide()}}n.onBlur(this)}return this}};var n=e.fn.markdown;e.fn.markdown=function(n){return this.each(function(){var r=e(this),i=r.data("markdown"),s=typeof n=="object"&&n;if(!i){r.data("markdown",i=new t(this,s))}})};e.fn.markdown.defaults={autofocus:false,hideable:false,savable:false,width:"inherit",height:"inherit",buttons:[[{name:"groupFont",data:[{name:"cmdBold",title:"Bold",icon:"icon icon-bold",callback:function(e){var t,n,r=e.getSelection(),i=e.getContent();if(r.length==0){t="strong text"}else{t=r.text}if(i.substr(r.start-2,2)=="**"&&i.substr(r.end,2)=="**"){e.setSelection(r.start-2,r.end+2);e.replaceSelection(t);n=r.start-2}else{e.replaceSelection("**"+t+"**");n=r.start+2}e.setSelection(n,n+t.length)}},{name:"cmdItalic",title:"Italic",icon:"icon icon-italic",callback:function(e){var t,n,r=e.getSelection(),i=e.getContent();if(r.length==0){t="emphasized text"}else{t=r.text}if(i.substr(r.start-1,1)=="*"&&i.substr(r.end,1)=="*"){e.setSelection(r.start-1,r.end+1);e.replaceSelection(t);n=r.start-1}else{e.replaceSelection("*"+t+"*");n=r.start+1}e.setSelection(n,n+t.length)}},{name:"cmdHeading",title:"Heading",icon:"icon icon-font",callback:function(e){var t,n,r=e.getSelection(),i=e.getContent(),s,o;if(r.length==0){t="heading text"}else{t=r.text}if((s=4,i.substr(r.start-s,s)=="### ")||(s=3,i.substr(r.start-s,s)=="###")){e.setSelection(r.start-s,r.end);e.replaceSelection(t);n=r.start-s}else{if(o=i.substr(r.start-1,1),!!o&&o!="\n"){e.replaceSelection("\n\n### "+t+"\n");n=r.start+6}else{e.replaceSelection("### "+t+"\n");n=r.start+4}}e.setSelection(n,n+t.length)}}]},{name:"groupLink",data:[{name:"cmdUrl",title:"URL/Link",icon:"icon icon-globe",callback:function(e){var t,n,r=e.getSelection(),i=e.getContent(),s;if(r.length==0){t="enter link description here"}else{t=r.text}s=prompt("Insert Hyperlink","http://");if(s!=null){e.replaceSelection("["+t+"]("+s+")");n=r.start+1;e.setSelection(n,n+t.length)}}},{name:"cmdImage",title:"Image",icon:"icon icon-picture",callback:function(e){var t,n,r=e.getSelection(),i=e.getContent(),s;if(r.length==0){t="enter image description here"}else{t=r.text}s=prompt("Insert Image Hyperlink","http://");if(s!=null){e.replaceSelection("!["+t+"]("+s+' "enter image title here")');n=r.start+2;e.setNextTab("enter image title here");e.setSelection(n,n+t.length)}}}]},{name:"groupMisc",data:[{name:"cmdList",title:"List",icon:"icon icon-list",callback:function(t){var n,r,i=t.getSelection(),s=t.getContent();if(i.length==0){n="list text here";t.replaceSelection("- "+n);r=i.start+2}else{if(i.text.indexOf("\n")<0){n=i.text;t.replaceSelection("- "+n);r=i.start+2}else{var o=[];o=i.text.split("\n");n=o[0];e.each(o,function(e,t){o[e]="- "+t});t.replaceSelection("\n\n"+o.join("\n"));r=i.start+4}}t.setSelection(r,r+n.length)}}]},{name:"groupUtil",data:[{name:"cmdPreview",toggle:true,title:"Preview",btnText:"Preview",btnClass:"btn btn-inverse",icon:"icon icon-white icon-search",callback:function(e){var t=e.$isPreview,n;if(t==false){e.showPreview()}else{e.hidePreview()}}}]}]],additionalButtons:[],onShow:function(e){},onPreview:function(e){},onSave:function(e){},onBlur:function(e){}};e.fn.markdown.Constructor=t;e.fn.markdown.noConflict=function(){e.fn.markdown=n;return this};var r=function(e){var t=e;if(t.data("markdown")){t.data("markdown").showEditor();return}t.markdown(t.data())};var i=function(t){var n=false,r,i=e(t.currentTarget);if((t.type=="focusin"||t.type=="click")&&i.length==1&&typeof i[0]=="object"){r=i[0].activeElement;if(!e(r).data("markdown")){if(typeof e(r).parent().parent().parent().attr("class")=="undefined"||e(r).parent().parent().parent().attr("class").indexOf("md-editor")<0){if(typeof e(r).parent().parent().attr("class")=="undefined"||e(r).parent().parent().attr("class").indexOf("md-editor")<0){n=true}}else{n=false}}if(n){e(document).find(".md-editor").each(function(){var t=e(r).parent();if(e(this).attr("id")!=t.attr("id")){var n;if(n=e(this).find("textarea").data("markdown"),n==null){n=e(this).find('div[data-provider="markdown-preview"]').data("markdown")}if(n){n.blur()}}})}t.stopPropagation()}};e(document).on("click.markdown.data-api",'[data-provide="markdown-editable"]',function(t){r(e(this));t.preventDefault()}).on("click",function(e){i(e)}).on("focusin",function(e){i(e)}).ready(function(){e('textarea[data-provide="markdown"]').each(function(){r(e(this))})})}(window.jQuery);var q=null;window.PR_SHOULD_USE_CONTINUATION=!0;(function(){function e(e){function t(e){var t=e.charCodeAt(0);if(t!==92){return t}var n=e.charAt(1);return(t=c[n])?t:"0"<=n&&n<="7"?parseInt(e.substring(1),8):n==="u"||n==="x"?parseInt(e.substring(2),16):e.charCodeAt(1)}function n(e){if(e<32){return(e<16?"\\x0":"\\x")+e.toString(16)}e=String.fromCharCode(e);if(e==="\\"||e==="-"||e==="["||e==="]"){e="\\"+e}return e}function r(e){for(var r=e.substring(1,e.length-1).match(/\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\[0-3][0-7]{0,2}|\\[0-7]{1,2}|\\[\S\s]|[^\\]/g),e=[],i=[],s=r[0]==="^",o=s?1:0,u=r.length;o<u;++o){var a=r[o];if(/\\[bdsw]/i.test(a)){e.push(a)}else{var a=t(a),f;o+2<u&&"-"===r[o+1]?(f=t(r[o+2]),o+=2):f=a;i.push([a,f]);f<65||a>122||(f<65||a>90||i.push([Math.max(65,a)|32,Math.min(f,90)|32]),f<97||a>122||i.push([Math.max(97,a)&-33,Math.min(f,122)&-33]))}}i.sort(function(e,t){return e[0]-t[0]||t[1]-e[1]});r=[];a=[NaN,NaN];for(o=0;o<i.length;++o){u=i[o],u[0]<=a[1]+1?a[1]=Math.max(a[1],u[1]):r.push(a=u)}i=["["];s&&i.push("^");i.push.apply(i,e);for(o=0;o<r.length;++o){u=r[o],i.push(n(u[0])),u[1]>u[0]&&(u[1]+1>u[0]&&i.push("-"),i.push(n(u[1])))}i.push("]");return i.join("")}function i(e){for(var t=e.source.match(/\[(?:[^\\\]]|\\[\S\s])*]|\\u[\dA-Fa-f]{4}|\\x[\dA-Fa-f]{2}|\\\d+|\\[^\dux]|\(\?[!:=]|[()^]|[^()[\\^]+/g),n=t.length,i=[],u=0,a=0;u<n;++u){var f=t[u];f==="("?++a:"\\"===f.charAt(0)&&(f=+f.substring(1))&&f<=a&&(i[f]=-1)}for(u=1;u<i.length;++u){-1===i[u]&&(i[u]=++s)}for(a=u=0;u<n;++u){f=t[u],f==="("?(++a,i[a]===void 0&&(t[u]="(?:")):"\\"===f.charAt(0)&&(f=+f.substring(1))&&f<=a&&(t[u]="\\"+i[a])}for(a=u=0;u<n;++u){"^"===t[u]&&"^"!==t[u+1]&&(t[u]="")}if(e.ignoreCase&&o){for(u=0;u<n;++u){f=t[u],e=f.charAt(0),f.length>=2&&e==="["?t[u]=r(f):e!=="\\"&&(t[u]=f.replace(/[A-Za-z]/g,function(e){e=e.charCodeAt(0);return"["+String.fromCharCode(e&-33,e|32)+"]"}))}}return t.join("")}for(var s=0,o=!1,u=!1,a=0,f=e.length;a<f;++a){var l=e[a];if(l.ignoreCase){u=!0}else{if(/[a-z]/i.test(l.source.replace(/\\u[\da-f]{4}|\\x[\da-f]{2}|\\[^UXux]/gi,""))){o=!0;u=!1;break}}}for(var c={b:8,t:9,n:10,v:11,f:12,r:13},h=[],a=0,f=e.length;a<f;++a){l=e[a];if(l.global||l.multiline){throw Error(""+l)}h.push("(?:"+i(l)+")")}return RegExp(h.join("|"),u?"gi":"g")}function t(e){function t(e){switch(e.nodeType){case 1:if(n.test(e.className)){break}for(var u=e.firstChild;u;u=u.nextSibling){t(u)}u=e.nodeName;if("BR"===u||"LI"===u){r[o]="\n",s[o<<1]=i++,s[o++<<1|1]=e}break;case 3:case 4:u=e.nodeValue,u.length&&(u=a?u.replace(/\r\n?/g,"\n"):u.replace(/[\t\n\r ]+/g," "),r[o]=u,s[o<<1]=i,i+=u.length,s[o++<<1|1]=e)}}var n=/(?:^|\s)nocode(?:\s|$)/,r=[],i=0,s=[],o=0,u;e.currentStyle?u=e.currentStyle.whiteSpace:window.getComputedStyle&&(u=document.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var a=u&&"pre"===u.substring(0,3);t(e);return{a:r.join("").replace(/\n$/,""),c:s}}function n(e,t,n,r){t&&(e={a:t,d:e},n(e),r.push.apply(r,e.e))}function r(t,r){function i(e){for(var t=e.d,f=[t,"pln"],l=0,c=e.a.match(o)||[],h={},p=0,d=c.length;p<d;++p){var v=c[p],m=h[v],g=void 0,y;if(typeof m==="string"){y=!1}else{var b=s[v.charAt(0)];if(b){g=v.match(b[1]),m=b[0]}else{for(y=0;y<a;++y){if(b=r[y],g=v.match(b[1])){m=b[0];break}}g||(m="pln")}if((y=m.length>=5&&"lang-"===m.substring(0,5))&&!(g&&typeof g[1]==="string")){y=!1,m="src"}y||(h[v]=m)}b=l;l+=v.length;if(y){y=g[1];var E=v.indexOf(y),S=E+y.length;g[2]&&(S=v.length-g[2].length,E=S-y.length);m=m.substring(5);n(t+b,v.substring(0,E),i,f);n(t+b+E,y,u(m,y),f);n(t+b+S,v.substring(S),i,f)}else{f.push(t+b,m)}}e.e=f}var s={},o;(function(){for(var n=t.concat(r),i=[],u={},a=0,f=n.length;a<f;++a){var l=n[a],c=l[3];if(c){for(var h=c.length;--h>=0;){s[c.charAt(h)]=l}}l=l[1];c=""+l;u.hasOwnProperty(c)||(i.push(l),u[c]=q)}i.push(/[\S\s]/);o=e(i)})();var a=r.length;return i}function i(e){var t=[],n=[];e.tripleQuotedStrings?t.push(["str",/^(?:'''(?:[^'\\]|\\[\S\s]|''?(?=[^']))*(?:'''|$)|"""(?:[^"\\]|\\[\S\s]|""?(?=[^"]))*(?:"""|$)|'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$))/,q,"'\""]):e.multiLineStrings?t.push(["str",/^(?:'(?:[^'\\]|\\[\S\s])*(?:'|$)|"(?:[^"\\]|\\[\S\s])*(?:"|$)|`(?:[^\\`]|\\[\S\s])*(?:`|$))/,q,"'\"`"]):t.push(["str",/^(?:'(?:[^\n\r'\\]|\\.)*(?:'|$)|"(?:[^\n\r"\\]|\\.)*(?:"|$))/,q,"\"'"]);e.verbatimStrings&&n.push(["str",/^@"(?:[^"]|"")*(?:"|$)/,q]);var i=e.hashComments;i&&(e.cStyleComments?(i>1?t.push(["com",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,q,"#"]):t.push(["com",/^#(?:(?:define|elif|else|endif|error|ifdef|include|ifndef|line|pragma|undef|warning)\b|[^\n\r]*)/,q,"#"]),n.push(["str",/^<(?:(?:(?:\.\.\/)*|\/?)(?:[\w-]+(?:\/[\w-]+)+)?[\w-]+\.h|[a-z]\w*)>/,q])):t.push(["com",/^#[^\n\r]*/,q,"#"]));e.cStyleComments&&(n.push(["com",/^\/\/[^\n\r]*/,q]),n.push(["com",/^\/\*[\S\s]*?(?:\*\/|$)/,q]));e.regexLiterals&&n.push(["lang-regex",/^(?:^^\.?|[!+-]|!=|!==|#|%|%=|&|&&|&&=|&=|\(|\*|\*=|\+=|,|-=|->|\/|\/=|:|::|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|[?@[^]|\^=|\^\^|\^\^=|{|\||\|=|\|\||\|\|=|~|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\s*(\/(?=[^*/])(?:[^/[\\]|\\[\S\s]|\[(?:[^\\\]]|\\[\S\s])*(?:]|$))+\/)/]);(i=e.types)&&n.push(["typ",i]);e=(""+e.keywords).replace(/^ | $/g,"");e.length&&n.push(["kwd",RegExp("^(?:"+e.replace(/[\s,]+/g,"|")+")\\b"),q]);t.push(["pln",/^\s+/,q," \r\n	Â "]);n.push(["lit",/^@[$_a-z][\w$@]*/i,q],["typ",/^(?:[@_]?[A-Z]+[a-z][\w$@]*|\w+_t\b)/,q],["pln",/^[$_a-z][\w$@]*/i,q],["lit",/^(?:0x[\da-f]+|(?:\d(?:_\d+)*\d*(?:\.\d*)?|\.\d\+)(?:e[+-]?\d+)?)[a-z]*/i,q,"0123456789"],["pln",/^\\[\S\s]?/,q],["pun",/^.[^\s\w"-$'./@\\`]*/,q]);return r(t,n)}function s(e,t){function n(e){switch(e.nodeType){case 1:if(i.test(e.className)){break}if("BR"===e.nodeName){r(e),e.parentNode&&e.parentNode.removeChild(e)}else{for(e=e.firstChild;e;e=e.nextSibling){n(e)}}break;case 3:case 4:if(a){var t=e.nodeValue,u=t.match(s);if(u){var f=t.substring(0,u.index);e.nodeValue=f;(t=t.substring(u.index+u[0].length))&&e.parentNode.insertBefore(o.createTextNode(t),e.nextSibling);r(e);f||e.parentNode.removeChild(e)}}}}function r(e){function t(e,n){var r=n?e.cloneNode(!1):e,i=e.parentNode;if(i){var i=t(i,1),s=e.nextSibling;i.appendChild(r);for(var o=s;o;o=s){s=o.nextSibling,i.appendChild(o)}}return r}for(;!e.nextSibling;){if(e=e.parentNode,!e){return}}for(var e=t(e.nextSibling,0),n;(n=e.parentNode)&&n.nodeType===1;){e=n}f.push(e)}var i=/(?:^|\s)nocode(?:\s|$)/,s=/\r\n?|\n/,o=e.ownerDocument,u;e.currentStyle?u=e.currentStyle.whiteSpace:window.getComputedStyle&&(u=o.defaultView.getComputedStyle(e,q).getPropertyValue("white-space"));var a=u&&"pre"===u.substring(0,3);for(u=o.createElement("LI");e.firstChild;){u.appendChild(e.firstChild)}for(var f=[u],l=0;l<f.length;++l){n(f[l])}t===(t|0)&&f[0].setAttribute("value",t);var c=o.createElement("OL");c.className="linenums";for(var h=Math.max(0,t-1|0)||0,l=0,p=f.length;l<p;++l){u=f[l],u.className="L"+(l+h)%10,u.firstChild||u.appendChild(o.createTextNode("Â ")),c.appendChild(u)}e.appendChild(c)}function o(e,t){for(var n=t.length;--n>=0;){var r=t[n];b.hasOwnProperty(r)?window.console&&console.warn("cannot override language handler %s",r):b[r]=e}}function u(e,t){if(!e||!b.hasOwnProperty(e)){e=/^\s*</.test(t)?"default-markup":"default-code"}return b[e]}function a(e){var n=e.g;try{var r=t(e.h),i=r.a;e.a=i;e.c=r.c;e.d=0;u(n,i)(e);var s=/\bMSIE\b/.test(navigator.userAgent),n=/\n/g,o=e.a,a=o.length,r=0,f=e.c,l=f.length,i=0,c=e.e,h=c.length,e=0;c[h]=a;var p,d;for(d=p=0;d<h;){c[d]!==c[d+2]?(c[p++]=c[d++],c[p++]=c[d++]):d+=2}h=p;for(d=p=0;d<h;){for(var v=c[d],m=c[d+1],g=d+2;g+2<=h&&c[g+1]===m;){g+=2}c[p++]=v;c[p++]=m;d=g}for(c.length=p;i<l;){var y=f[i+2]||a,b=c[e+2]||a,g=Math.min(y,b),w=f[i+1],E;if(w.nodeType!==1&&(E=o.substring(r,g))){s&&(E=E.replace(n,"\r"));w.nodeValue=E;var S=w.ownerDocument,x=S.createElement("SPAN");x.className=c[e+1];var T=w.parentNode;T.replaceChild(x,w);x.appendChild(w);r<y&&(f[i+1]=w=S.createTextNode(o.substring(g,y)),T.insertBefore(w,x.nextSibling))}r=g;r>=y&&(i+=2);r>=b&&(e+=2)}}catch(N){"console"in window&&console.log(N&&N.stack?N.stack:N)}}var f=["break,continue,do,else,for,if,return,while"],l=[[f,"auto,case,char,const,default,double,enum,extern,float,goto,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile"],"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof"],c=[l,"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,dynamic_cast,explicit,export,friend,inline,late_check,mutable,namespace,nullptr,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where"],h=[l,"abstract,boolean,byte,extends,final,finally,implements,import,instanceof,null,native,package,strictfp,super,synchronized,throws,transient"],p=[h,"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,interface,internal,into,is,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var"],l=[l,"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN"],d=[f,"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None"],v=[f,"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END"],f=[f,"case,done,elif,esac,eval,fi,function,in,local,set,then,until"],m=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\d*)/,g=/\S/,y=i({keywords:[c,p,l,"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END"+d,v,f],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),b={};o(y,["default-code"]);o(r([],[["pln",/^[^<?]+/],["dec",/^<!\w[^>]*(?:>|$)/],["com",/^<\!--[\S\s]*?(?:--\>|$)/],["lang-",/^<\?([\S\s]+?)(?:\?>|$)/],["lang-",/^<%([\S\s]+?)(?:%>|$)/],["pun",/^(?:<[%?]|[%?]>)/],["lang-",/^<xmp\b[^>]*>([\S\s]+?)<\/xmp\b[^>]*>/i],["lang-js",/^<script\b[^>]*>([\S\s]*?)(<\/script\b[^>]*>)/i],["lang-css",/^<style\b[^>]*>([\S\s]*?)(<\/style\b[^>]*>)/i],["lang-in.tag",/^(<\/?[a-z][^<>]*>)/i]]),["default-markup","htm","html","mxml","xhtml","xml","xsl"]);o(r([["pln",/^\s+/,q," 	\r\n"],["atv",/^(?:"[^"]*"?|'[^']*'?)/,q,"\"'"]],[["tag",/^^<\/?[a-z](?:[\w-.:]*\w)?|\/?>$/i],["atn",/^(?!style[\s=]|on)[a-z](?:[\w:-]*\w)?/i],["lang-uq.val",/^=\s*([^\s"'>]*(?:[^\s"'/>]|\/(?=\s)))/],["pun",/^[/<->]+/],["lang-js",/^on\w+\s*=\s*"([^"]+)"/i],["lang-js",/^on\w+\s*=\s*'([^']+)'/i],["lang-js",/^on\w+\s*=\s*([^\s"'>]+)/i],["lang-css",/^style\s*=\s*"([^"]+)"/i],["lang-css",/^style\s*=\s*'([^']+)'/i],["lang-css",/^style\s*=\s*([^\s"'>]+)/i]]),["in.tag"]);o(r([],[["atv",/^[\S\s]+/]]),["uq.val"]);o(i({keywords:c,hashComments:!0,cStyleComments:!0,types:m}),["c","cc","cpp","cxx","cyc","m"]);o(i({keywords:"null,true,false"}),["json"]);o(i({keywords:p,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:m}),["cs"]);o(i({keywords:h,cStyleComments:!0}),["java"]);o(i({keywords:f,hashComments:!0,multiLineStrings:!0}),["bsh","csh","sh"]);o(i({keywords:d,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),["cv","py"]);o(i({keywords:"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END",hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["perl","pl","pm"]);o(i({keywords:v,hashComments:!0,multiLineStrings:!0,regexLiterals:!0}),["rb"]);o(i({keywords:l,cStyleComments:!0,regexLiterals:!0}),["js"]);o(i({keywords:"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,true,try,unless,until,when,while,yes",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),["coffee"]);o(r([],[["str",/^[\S\s]+/]]),["regex"]);window.prettyPrintOne=function(e,t,n){var r=document.createElement("PRE");r.innerHTML=e;n&&s(r,n);a({g:t,i:n,h:r});return r.innerHTML};window.prettyPrint=function(e){function t(){for(var n=window.PR_SHOULD_USE_CONTINUATION?f.now()+250:Infinity;l<r.length&&f.now()<n;l++){var i=r[l],o=i.className;if(o.indexOf("prettyprint")>=0){var o=o.match(h),u,p;if(p=!o){p=i;for(var d=void 0,v=p.firstChild;v;v=v.nextSibling){var m=v.nodeType,d=m===1?d?p:v:m===3?g.test(v.nodeValue)?p:d:d}p=(u=d===p?void 0:d)&&"CODE"===u.tagName}p&&(o=u.className.match(h));o&&(o=o[1]);p=!1;for(d=i.parentNode;d;d=d.parentNode){if((d.tagName==="pre"||d.tagName==="code"||d.tagName==="xmp")&&d.className&&d.className.indexOf("prettyprint")>=0){p=!0;break}}p||((p=(p=i.className.match(/\blinenums\b(?::(\d+))?/))?p[1]&&p[1].length?+p[1]:!0:!1)&&s(i,p),c={g:o,h:i,i:p},a(c))}}l<r.length?setTimeout(t,250):e&&e()}for(var n=[document.getElementsByTagName("pre"),document.getElementsByTagName("code"),document.getElementsByTagName("xmp")],r=[],i=0;i<n.length;++i){for(var o=0,u=n[i].length;o<u;++o){r.push(n[i][o])}}var n=q,f=Date;f.now||(f={now:function(){return+(new Date)}});var l=0,c,h=/\blang(?:uage)?-([\w.]+)(?!\S)/;t()};window.PR={createSimpleLexer:r,registerLangHandler:o,sourceDecorator:i,PR_ATTRIB_NAME:"atn",PR_ATTRIB_VALUE:"atv",PR_COMMENT:"com",PR_DECLARATION:"dec",PR_KEYWORD:"kwd",PR_LITERAL:"lit",PR_NOCODE:"nocode",PR_PLAIN:"pln",PR_PUNCTUATION:"pun",PR_SOURCE:"src",PR_STRING:"str",PR_TAG:"tag",PR_TYPE:"typ"}})();(function(e){function n(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function r(){var e=require("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}function s(e){var t=0,n=-1;while((n=e.indexOf("\n",n+1))!==-1){t++}return t}function o(e,t){function i(e){this.len_after=e;this.name="close_"+t}var n=e+"_state",r=e=="strong"?"em_state":"strong_state";return function(s,o){if(this[n][0]==t){this[n].shift();return[s.length,new i(s.length-t.length)]}else{var u=this[r].slice(),a=this[n].slice();this[n].unshift(t);var f=this.processInline(s.substr(t.length));var l=f[f.length-1];var c=this[n].shift();if(l instanceof i){f.pop();var h=s.length-l.len_after;return[h,[e].concat(f)]}else{this[r]=u;this[n]=a;return[t.length,t]}}}}function u(e){var t=e.split(""),n=[""],r=false;while(t.length){var i=t.shift();switch(i){case" ":if(r){n[n.length-1]+=i}else{n.push("")}break;case"'":case'"':r=!r;break;case"\\":i=t.shift();default:n[n.length-1]+=i;break}}return n}function h(e){return f(e)&&e.length>1&&typeof e[1]==="object"&&!f(e[1])?e[1]:undefined}function d(e){return e.replace(/&/g,"&").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function v(e){if(typeof e==="string"){return d(e)}var t=e.shift(),n={},r=[];if(e.length&&typeof e[0]==="object"&&!(e[0]instanceof Array)){n=e.shift()}while(e.length){r.push(v(e.shift()))}var i="";for(var s in n){i+=" "+s+'="'+d(n[s])+'"'}if(t=="img"||t=="br"||t=="hr"){return"<"+t+i+"/>"}else{return"<"+t+i+">"+r.join("")+"</"+t+">"}}function m(e,t,n){var r;n=n||{};var i=e.slice(0);if(typeof n.preprocessTreeNode==="function"){i=n.preprocessTreeNode(i,t)}var s=h(i);if(s){i[1]={};for(r in s){i[1][r]=s[r]}s=i[1]}if(typeof i==="string"){return i}switch(i[0]){case"header":i[0]="h"+i[1].level;delete i[1].level;break;case"bulletlist":i[0]="ul";break;case"numberlist":i[0]="ol";break;case"listitem":i[0]="li";break;case"para":i[0]="p";break;case"markdown":i[0]="html";if(s){delete s.references}break;case"code_block":i[0]="pre";r=s?2:1;var o=["code"];o.push.apply(o,i.splice(r,i.length-r));i[r]=o;break;case"inlinecode":i[0]="code";break;case"img":i[1].src=i[1].href;delete i[1].href;break;case"linebreak":i[0]="br";break;case"link":i[0]="a";break;case"link_ref":i[0]="a";var u=t[s.ref];if(u){delete s.ref;s.href=u.href;if(u.title){s.title=u.title}delete s.original}else{return s.original}break;case"img_ref":i[0]="img";var u=t[s.ref];if(u){delete s.ref;s.src=u.href;if(u.title){s.title=u.title}delete s.original}else{return s.original}break}r=1;if(s){for(var a in i[1]){r=2}if(r===1){i.splice(r,1)}}for(;r<i.length;++r){i[r]=m(i[r],t,n)}return i}function g(e){var t=h(e)?2:1;while(t<e.length){if(typeof e[t]==="string"){if(t+1<e.length&&typeof e[t+1]==="string"){e[t]+=e.splice(t+1,1)[0]}else{++t}}else{g(e[t]);++t}}}var t=e.Markdown=function(e){switch(typeof e){case"undefined":this.dialect=t.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(e in t.dialects){this.dialect=t.dialects[e]}else{throw new Error("Unknown Markdown dialect '"+String(e)+"'")}break}this.em_state=[];this.strong_state=[];this.debug_indent=""};e.parse=function(e,n){var r=new t(n);return r.toTree(e)};e.toHTML=function(n,r,i){var s=e.toHTMLTree(n,r,i);return e.renderJsonML(s)};e.toHTMLTree=function(t,n,r){if(typeof t==="string"){t=this.parse(t,n)}var i=h(t),s={};if(i&&i.references){s=i.references}var o=m(t,s,r);g(o);return o};var i=t.mk_block=function(e,t,i){if(arguments.length==1){t="\n\n"}var s=new String(e);s.trailing=t;s.inspect=r;s.toSource=n;if(i!=undefined){s.lineNumber=i}return s};t.prototype.split_blocks=function(t,n){t=t.replace(/(\r\n|\n|\r)/g,"\n");var r=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,o=[],u;var a=1;if((u=/^(\s*\n)/.exec(t))!=null){a+=s(u[0]);r.lastIndex=u[0].length}while((u=r.exec(t))!==null){if(u[2]=="\n#"){u[2]="\n";r.lastIndex--}o.push(i(u[1],u[2],a));a+=s(u[0])}return o};t.prototype.processBlock=function(t,n){var r=this.dialect.block,i=r.__order__;if("__call__"in r){return r.__call__.call(this,t,n)}for(var s=0;s<i.length;s++){var o=r[i[s]].call(this,t,n);if(o){if(!f(o)||o.length>0&&!f(o[0])){this.debug(i[s],"didn't return a proper array")}return o}}return[]};t.prototype.processInline=function(t){return this.dialect.inline.__call__.call(this,String(t))};t.prototype.toTree=function(t,n){var r=t instanceof Array?t:this.split_blocks(t);var i=this.tree;try{this.tree=n||this.tree||["markdown"];e:while(r.length){var s=this.processBlock(r.shift(),r);if(!s.length){continue e}this.tree.push.apply(this.tree,s)}return this.tree}finally{if(n){this.tree=i}}};t.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent);if(typeof print!=="undefined"){print.apply(print,e)}if(typeof console!=="undefined"&&typeof console.log!=="undefined"){console.log.apply(null,e)}};t.prototype.loop_re_over_block=function(e,t,n){var r,i=t.valueOf();while(i.length&&(r=e.exec(i))!=null){i=i.substr(r[0].length);n.call(this,r)}return i};t.dialects={};t.dialects.Gruber={block:{atxHeader:function(t,n){var r=t.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!r){return undefined}var s=["header",{level:r[1].length}];Array.prototype.push.apply(s,this.processInline(r[2]));if(r[0].length<t.length){n.unshift(i(t.substr(r[0].length),t.trailing,t.lineNumber+2))}return[s]},setextHeader:function(t,n){var r=t.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!r){return undefined}var s=r[2]==="="?1:2;var o=["header",{level:s},r[1]];if(r[0].length<t.length){n.unshift(i(t.substr(r[0].length),t.trailing,t.lineNumber+2))}return[o]},code:function(t,n){var r=[],s=/^(?: {0,3}\t| {4})(.*)\n?/,o;if(!t.match(s)){return undefined}e:do{var u=this.loop_re_over_block(s,t.valueOf(),function(e){r.push(e[1])});if(u.length){n.unshift(i(u,t.trailing));break e}else{if(n.length){if(!n[0].match(s)){break e}r.push(t.trailing.replace(/[^\n]/g,"").substring(2));t=n.shift()}else{break e}}}while(true);return[["code_block",r.join("\n")]]},horizRule:function(t,n){var r=t.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!r){return undefined}var s=[["hr"]];if(r[1]){s.unshift.apply(s,this.processBlock(r[1],[]))}if(r[3]){n.unshift(i(r[3]))}return s},lists:function(){function o(t){return new RegExp("(?:^("+s+"{0,"+t+"} {0,3})("+e+")\\s+)|(^"+s+"{0,"+(t-1)+"}[ ]{0,4})")}function u(e){return e.replace(/ {0,3}\t/g,"    ")}function a(e,t,n,r){if(t){e.push(["para"].concat(n));return}var i=e[e.length-1]instanceof Array&&e[e.length-1][0]=="para"?e[e.length-1]:e;if(r&&e.length>1){n.unshift(r)}for(var s=0;s<n.length;s++){var o=n[s],u=typeof o=="string";if(u&&i.length>1&&typeof i[i.length-1]=="string"){i[i.length-1]+=o}else{i.push(o)}}}function f(e,t){var n=new RegExp("^("+s+"{"+e+"}.*?\\n?)*$"),r=new RegExp("^"+s+"{"+e+"}","gm"),o=[];while(t.length>0){if(n.exec(t[0])){var u=t.shift(),a=u.replace(r,"");o.push(i(a,u.trailing,u.lineNumber))}else{break}}return o}function c(e,t,n){var r=e.list;var i=r[r.length-1];if(i[1]instanceof Array&&i[1][0]=="para"){return}if(t+1==n.length){i.push(["para"].concat(i.splice(1,i.length-1)))}else{var s=i.pop();i.push(["para"].concat(i.splice(1,i.length-1)),s)}}var e="[*+-]|\\d+\\.",t=/[*+-]/,n=/\d+\./,r=new RegExp("^( {0,3})("+e+")[ 	]+"),s="(?: {0,3}\\t| {4})";return function(e,n){function s(e){var n=t.exec(e[2])?["bulletlist"]:["numberlist"];h.push({list:n,indent:e[1]});return n}var i=e.match(r);if(!i){return undefined}var h=[],p=s(i),d,v=false,m=[h[0].list],g;e:while(true){var y=e.split(/(?=\n)/);var b="";for(var w=0;w<y.length;w++){var E="",S=y[w].replace(/^\n/,function(e){E=e;return""});var x=o(h.length);i=S.match(x);if(i[1]!==undefined){if(b.length){a(d,v,this.processInline(b),E);v=false;b=""}i[1]=u(i[1]);var N=Math.floor(i[1].length/4)+1;if(N>h.length){p=s(i);d.push(p);d=p[1]=["listitem"]}else{var C=false;for(g=0;g<h.length;g++){if(h[g].indent!=i[1]){continue}p=h[g].list;h.splice(g+1,h.length-(g+1));C=true;break}if(!C){N++;if(N<=h.length){h.splice(N,h.length-N);p=h[N-1].list}else{p=s(i);d.push(p)}}d=["listitem"];p.push(d)}E=""}if(S.length>i[0].length){b+=E+S.substr(i[0].length)}}if(b.length){a(d,v,this.processInline(b),E);v=false;b=""}var k=f(h.length,n);if(k.length>0){l(h,c,this);d.push.apply(d,this.toTree(k,[]))}var L=n[0]&&n[0].valueOf()||"";if(L.match(r)||L.match(/^ /)){e=n.shift();var A=this.dialect.block.horizRule(e,n);if(A){m.push.apply(m,A);break}l(h,c,this);v=true;continue e}break}return m}}(),blockquote:function(t,n){if(!t.match(/^>/m)){return undefined}var r=[];if(t[0]!=">"){var s=t.split(/\n/),o=[],u=t.lineNumber;while(s.length&&s[0][0]!=">"){o.push(s.shift());u++}var a=i(o.join("\n"),"\n",t.lineNumber);r.push.apply(r,this.processBlock(a,[]));t=i(s.join("\n"),t.trailing,u)}while(n.length&&n[0][0]==">"){var f=n.shift();t=i(t+t.trailing+f,f.trailing,t.lineNumber)}var l=t.replace(/^> ?/gm,""),p=this.tree,d=this.toTree(l,["blockquote"]),v=h(d);if(v&&v.references){delete v.references;if(c(v)){d.splice(1,1)}}r.push(d);return r},referenceDefn:function(t,n){var r=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!t.match(r)){return undefined}if(!h(this.tree)){this.tree.splice(1,0,{})}var s=h(this.tree);if(s.references===undefined){s.references={}}var o=this.loop_re_over_block(r,t,function(e){if(e[2]&&e[2][0]=="<"&&e[2][e[2].length-1]==">"){e[2]=e[2].substring(1,e[2].length-1)}var t=s.references[e[1].toLowerCase()]={href:e[2]};if(e[4]!==undefined){t.title=e[4]}else{if(e[5]!==undefined){t.title=e[5]}}});if(o.length){n.unshift(i(o,t.trailing))}return[]},para:function(t,n){return[["para"].concat(this.processInline(t))]}}};t.dialects.Gruber.inline={__oneElement__:function(t,n,r){var i,s,o=0;n=n||this.dialect.inline.__patterns__;var u=new RegExp("([\\s\\S]*?)("+(n.source||n)+")");i=u.exec(t);if(!i){return[t.length,t]}else{if(i[1]){return[i[1].length,i[1]]}}var s;if(i[2]in this.dialect.inline){s=this.dialect.inline[i[2]].call(this,t.substr(i.index),i,r||[])}s=s||[i[2].length,i[2]];return s},__call__:function(t,n){function s(e){if(typeof e=="string"&&typeof r[r.length-1]=="string"){r[r.length-1]+=e}else{r.push(e)}}var r=[],i;while(t.length>0){i=this.dialect.inline.__oneElement__.call(this,t,n,r);t=t.substr(i.shift());l(i,s)}return r},"]":function(){},"}":function(){},"\\":function(t){if(t.match(/^\\[\\`\*_{}\[\]()#\+.!\-]/)){return[2,t.charAt(1)]}else{return[1,"\\"]}},"![":function(t){var n=t.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(n){if(n[2]&&n[2][0]=="<"&&n[2][n[2].length-1]==">"){n[2]=n[2].substring(1,n[2].length-1)}n[2]=this.dialect.inline.__call__.call(this,n[2],/\\/)[0];var r={alt:n[1],href:n[2]||""};if(n[4]!==undefined){r.title=n[4]}return[n[0].length,["img",r]]}n=t.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/);if(n){return[n[0].length,["img_ref",{alt:n[1],ref:n[2].toLowerCase(),original:n[0]}]]}return[2,"!["]},"[":function(n){var r=String(n);var i=t.DialectHelpers.inline_until_char.call(this,n.substr(1),"]");if(!i){return[1,"["]}var s=1+i[0],o=i[1],u,a;n=n.substr(s);var f=n.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(f){var l=f[1];s+=f[0].length;if(l&&l[0]=="<"&&l[l.length-1]==">"){l=l.substring(1,l.length-1)}if(!f[3]){var c=1;for(var h=0;h<l.length;h++){switch(l[h]){case"(":c++;break;case")":if(--c==0){s-=l.length-h;l=l.substring(0,h)}break}}}l=this.dialect.inline.__call__.call(this,l,/\\/)[0];a={href:l||""};if(f[3]!==undefined){a.title=f[3]}u=["link",a].concat(o);return[s,u]}f=n.match(/^\s*\[(.*?)\]/);if(f){s+=f[0].length;a={ref:(f[1]||String(o)).toLowerCase(),original:r.substr(0,s)};u=["link_ref",a].concat(o);return[s,u]}if(o.length==1&&typeof o[0]=="string"){a={ref:o[0].toLowerCase(),original:r.substr(0,s)};u=["link_ref",a,o[0]];return[s,u]}return[1,"["]},"<":function(t){var n;if((n=t.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))!=null){if(n[3]){return[n[0].length,["link",{href:"mailto:"+n[3]},n[3]]]}else{if(n[2]=="mailto"){return[n[0].length,["link",{href:n[1]},n[1].substr("mailto:".length)]]}else{return[n[0].length,["link",{href:n[1]},n[1]]]}}}return[1,"<"]},"`":function(t){var n=t.match(/(`+)(([\s\S]*?)\1)/);if(n&&n[2]){return[n[1].length+n[2].length,["inlinecode",n[3]]]}else{return[1,"`"]}},"  \n":function(t){return[3,["linebreak"]]}};t.dialects.Gruber.inline["**"]=o("strong","**");t.dialects.Gruber.inline.__=o("strong","__");t.dialects.Gruber.inline["*"]=o("em","*");t.dialects.Gruber.inline._=o("em","_");t.buildBlockOrder=function(e){var t=[];for(var n in e){if(n=="__order__"||n=="__call__"){continue}t.push(n)}e.__order__=t};t.buildInlinePatterns=function(e){var t=[];for(var n in e){if(n.match(/^__.*__$/)){continue}var r=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(n.length==1?r:"(?:"+r+")")}t=t.join("|");e.__patterns__=t;var i=e.__call__;e.__call__=function(e,n){if(n!=undefined){return i.call(this,e,n)}else{return i.call(this,e,t)}}};t.DialectHelpers={};t.DialectHelpers.inline_until_char=function(e,t){var n=0,r=[];while(true){if(e.charAt(n)==t){n++;return[n,r]}if(n>=e.length){return null}var i=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=i[0];r.push.apply(r,i.slice(1))}};t.subclassDialect=function(e){function t(){}function n(){}t.prototype=e.block;n.prototype=e.inline;return{block:new t,inline:new n}};t.buildBlockOrder(t.dialects.Gruber.block);t.buildInlinePatterns(t.dialects.Gruber.inline);t.dialects.Maruku=t.subclassDialect(t.dialects.Gruber);t.dialects.Maruku.processMetaHash=function(t){var n=u(t),r={};for(var i=0;i<n.length;++i){if(/^#/.test(n[i])){r.id=n[i].substring(1)}else{if(/^\./.test(n[i])){if(r["class"]){r["class"]=r["class"]+n[i].replace(/./," ")}else{r["class"]=n[i].substring(1)}}else{if(/\=/.test(n[i])){var s=n[i].split(/\=/);r[s[0]]=s[1]}}}}return r};t.dialects.Maruku.block.document_meta=function(t,n){if(t.lineNumber>1){return undefined}if(!t.match(/^(?:\w+:.*\n)*\w+:.*$/)){return undefined}if(!h(this.tree)){this.tree.splice(1,0,{})}var r=t.split(/\n/);for(p in r){var i=r[p].match(/(\w+):\s*(.*)$/),s=i[1].toLowerCase(),o=i[2];this.tree[1][s]=o}return[]};t.dialects.Maruku.block.block_meta=function(t,n){var r=t.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!r){return undefined}var i=this.dialect.processMetaHash(r[2]);var s;if(r[1]===""){var o=this.tree[this.tree.length-1];s=h(o);if(typeof o==="string"){return undefined}if(!s){s={};o.splice(1,0,s)}for(a in i){s[a]=i[a]}return[]}var u=t.replace(/\n.*$/,""),f=this.processBlock(u,[]);s=h(f[0]);if(!s){s={};f[0].splice(1,0,s)}for(a in i){s[a]=i[a]}return f};t.dialects.Maruku.block.definition_list=function(t,n){var r=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,i=["dl"],s;if(a=t.match(r)){var o=[t];while(n.length&&r.exec(n[0])){o.push(n.shift())}for(var u=0;u<o.length;++u){var a=o[u].match(r),f=a[1].replace(/\n$/,"").split(/\n/),l=a[2].split(/\n:\s+/);for(s=0;s<f.length;++s){i.push(["dt",f[s]])}for(s=0;s<l.length;++s){i.push(["dd"].concat(this.processInline(l[s].replace(/(\n)\s+/,"$1"))))}}}else{return undefined}return[i]};t.dialects.Maruku.inline["{:"]=function(t,n,r){if(!r.length){return[2,"{:"]}var i=r[r.length-1];if(typeof i==="string"){return[2,"{:"]}var s=t.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!s){return[2,"{:"]}var o=this.dialect.processMetaHash(s[1]),u=h(i);if(!u){u={};i.splice(1,0,u)}for(var a in o){u[a]=o[a]}return[s[0].length,""]};t.buildBlockOrder(t.dialects.Maruku.block);t.buildInlinePatterns(t.dialects.Maruku.inline);var f=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"};var l;if(Array.prototype.forEach){l=function(e,t,n){return e.forEach(t,n)}}else{l=function(e,t,n){for(var r=0;r<e.length;r++){t.call(n||e,e[r],r,e)}}}var c=function(e){for(var t in e){if(hasOwnProperty.call(e,t)){return false}}return true};e.renderJsonML=function(e,t){t=t||{};t.root=t.root||false;var n=[];if(t.root){n.push(v(e))}else{e.shift();if(e.length&&typeof e[0]==="object"&&!(e[0]instanceof Array)){e.shift()}while(e.length){n.push(v(e.shift()))}}return n.join("\n\n")}})(function(){if(typeof exports==="undefined"){window.markdown={};return window.markdown}else{return exports}}());var wysihtml5={version:"0.3.0",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"ï»¿",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};window.rangy=function(){function u(n,r){var i=typeof n[r];return i==t||!!(i==e&&n[r])||i=="unknown"}function a(t,n){return!!(typeof t[n]==e&&t[n])}function f(e,t){return typeof e[t]!=n}function l(e){return function(t,n){var r=n.length;while(r--){if(!e(t,n[r])){return false}}return true}}function d(e){return e&&c(e,o)&&p(e,s)}function m(e){window.alert("Rangy not supported in your browser. Reason: "+e);v.initialized=true;v.supported=false}function g(e){var t="Rangy warning: "+e;if(v.config.alertOnWarn){window.alert(t)}else{if(typeof window.console!=n&&typeof window.console.log!=n){window.console.log(t)}}}function w(){if(v.initialized){return}var e;var t=false,n=false;if(u(document,"createRange")){e=document.createRange();if(c(e,i)&&p(e,r)){t=true}e.detach()}var s=a(document,"body")?document.body:document.getElementsByTagName("body")[0];if(s&&u(s,"createTextRange")){e=s.createTextRange();if(d(e)){n=true}}if(!t&&!n){m("Neither Range nor TextRange are implemented")}v.initialized=true;v.features={implementsDomRange:t,implementsTextRange:n};var o=b.concat(y);for(var f=0,l=o.length;f<l;++f){try{o[f](v)}catch(h){if(a(window,"console")&&u(window.console,"log")){window.console.log("Init listener threw an exception. Continuing.",h)}}}}function S(e){e=e||window;w();for(var t=0,n=E.length;t<n;++t){E[t](e)}}function x(e){this.name=e;this.initialized=false;this.supported=false}var e="object",t="function",n="undefined";var r=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"];var i=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"];var s=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"];var o=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"];var c=l(u);var h=l(a);var p=l(f);var v={version:"1.2.2",initialized:false,supported:true,util:{isHostMethod:u,isHostObject:a,isHostProperty:f,areHostMethods:c,areHostObjects:h,areHostProperties:p,isTextRange:d},features:{},modules:{},config:{alertOnWarn:false,preferTextRange:false}};v.fail=m;v.warn=g;if({}.hasOwnProperty){v.util.extend=function(e,t){for(var n in t){if(t.hasOwnProperty(n)){e[n]=t[n]}}}}else{m("hasOwnProperty not supported")}var y=[];var b=[];v.init=w;v.addInitListener=function(e){if(v.initialized){e(v)}else{y.push(e)}};var E=[];v.addCreateMissingNativeApiListener=function(e){E.push(e)};v.createMissingNativeApi=S;x.prototype.fail=function(e){this.initialized=true;this.supported=false;throw new Error("Module '"+this.name+"' failed to load: "+e)};x.prototype.warn=function(e){v.warn("Module "+this.name+": "+e)};x.prototype.createError=function(e){return new Error("Error in Rangy "+this.name+" module: "+e)};v.createModule=function(e,t){var n=new x(e);v.modules[e]=n;b.push(function(e){t(e,n);n.initialized=true;n.supported=true})};v.requireModules=function(e){for(var t=0,n=e.length,r,i;t<n;++t){i=e[t];r=v.modules[i];if(!r||!(r instanceof x)){throw new Error("Module '"+i+"' not found")}if(!r.supported){throw new Error("Module '"+i+"' not supported")}}};var T=false;var N=function(e){if(!T){T=true;if(!v.initialized){w()}}};if(typeof window==n){m("No window found");return}if(typeof document==n){m("No document found");return}if(u(document,"addEventListener")){document.addEventListener("DOMContentLoaded",N,false)}if(u(window,"addEventListener")){window.addEventListener("load",N,false)}else{if(u(window,"attachEvent")){window.attachEvent("onload",N)}else{m("Window does not have required addEventListener or attachEvent method")}}return v}();rangy.createModule("DomUtil",function(e,t){function u(e){var t;return typeof e.namespaceURI==n||(t=e.namespaceURI)===null||t=="http://www.w3.org/1999/xhtml"}function a(e){var t=e.parentNode;return t.nodeType==1?t:null}function f(e){var t=0;while(e=e.previousSibling){t++}return t}function l(e){var t;return d(e)?e.length:(t=e.childNodes)?t.length:0}function c(e,t){var n=[],r;for(r=e;r;r=r.parentNode){n.push(r)}for(r=t;r;r=r.parentNode){if(o(n,r)){return r}}return null}function h(e,t,n){var r=n?t:t.parentNode;while(r){if(r===e){return true}else{r=r.parentNode}}return false}function p(e,t,n){var r,i=n?e:e.parentNode;while(i){r=i.parentNode;if(r===t){return i}i=r}return null}function d(e){var t=e.nodeType;return t==3||t==4||t==8}function v(e,t){var n=t.nextSibling,r=t.parentNode;if(n){r.insertBefore(e,n)}else{r.appendChild(e)}return e}function m(e,t){var n=e.cloneNode(false);n.deleteData(0,t);e.deleteData(t,e.length-t);v(n,e);return n}function g(e){if(e.nodeType==9){return e}else{if(typeof e.ownerDocument!=n){return e.ownerDocument}else{if(typeof e.document!=n){return e.document}else{if(e.parentNode){return g(e.parentNode)}else{throw new Error("getDocument: no document found for node")}}}}}function y(e){var t=g(e);if(typeof t.defaultView!=n){return t.defaultView}else{if(typeof t.parentWindow!=n){return t.parentWindow}else{throw new Error("Cannot get a window object for node")}}}function b(e){if(typeof e.contentDocument!=n){return e.contentDocument}else{if(typeof e.contentWindow!=n){return e.contentWindow.document}else{throw new Error("getIframeWindow: No Document object found for iframe element")}}}function w(e){if(typeof e.contentWindow!=n){return e.contentWindow}else{if(typeof e.contentDocument!=n){return e.contentDocument.defaultView}else{throw new Error("getIframeWindow: No Window object found for iframe element")}}}function E(e){return r.isHostObject(e,"body")?e.body:e.getElementsByTagName("body")[0]}function S(e){var t;while(t=e.parentNode){e=t}return e}function x(e,t,n,r){var i,s,o,u,a;if(e==n){return t===r?0:t<r?-1:1}else{if(i=p(n,e,true)){return t<=f(i)?-1:1}else{if(i=p(e,n,true)){return f(i)<r?-1:1}else{s=c(e,n);o=e===s?s:p(e,s,true);u=n===s?s:p(n,s,true);if(o===u){throw new Error("comparePoints got to case 4 and childA and childB are the same!")}else{a=s.firstChild;while(a){if(a===o){return-1}else{if(a===u){return 1}}a=a.nextSibling}throw new Error("Should not be here!")}}}}}function T(e){var t=g(e).createDocumentFragment(),n;while(n=e.firstChild){t.appendChild(n)}return t}function N(e){if(!e){return"[No node]"}if(d(e)){return'"'+e.data+'"'}else{if(e.nodeType==1){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">["+e.childNodes.length+"]"}else{return e.nodeName}}}function C(e){this.root=e;this._next=e}function k(e){return new C(e)}function L(e,t){this.node=e;this.offset=t}function A(e){this.code=this[e];this.codeName=e;this.message="DOMException: "+this.codeName}var n="undefined";var r=e.util;if(!r.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])){t.fail("document missing a Node creation method")}if(!r.isHostMethod(document,"getElementsByTagName")){t.fail("document missing getElementsByTagName method")}var i=document.createElement("div");if(!r.areHostMethods(i,["insertBefore","appendChild","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"]))){t.fail("Incomplete Element implementation")}if(!r.isHostProperty(i,"innerHTML")){t.fail("Element is missing innerHTML property")}var s=document.createTextNode("test");if(!r.areHostMethods(s,["splitText","deleteData","insertData","appendData","cloneNode"]||!r.areHostObjects(i,["previousSibling","nextSibling","childNodes","parentNode"])||!r.areHostProperties(s,["data"]))){t.fail("Incomplete Text Node implementation")}var o=function(e,t){var n=e.length;while(n--){if(e[n]===t){return true}}return false};C.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;var t,n;if(this._current){t=e.firstChild;if(t){this._next=t}else{n=null;while(e!==this.root&&!(n=e.nextSibling)){e=e.parentNode}this._next=n}}return this._current},detach:function(){this._current=this._next=this.root=null}};L.prototype={equals:function(e){return this.node===e.node&this.offset==e.offset},inspect:function(){return"[DomPosition("+N(this.node)+":"+this.offset+")]"}};A.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11};A.prototype.toString=function(){return this.message};e.dom={arrayContains:o,isHtmlNamespace:u,parentElement:a,getNodeIndex:f,getNodeLength:l,getCommonAncestor:c,isAncestorOf:h,getClosestAncestorIn:p,isCharacterDataNode:d,insertAfter:v,splitDataNode:m,getDocument:g,getWindow:y,getIframeWindow:w,getIframeDocument:b,getBody:E,getRootContainer:S,comparePoints:x,inspectNode:N,fragmentFromNodeChildren:T,createIterator:k,DomPosition:L};e.DOMException=A});rangy.createModule("DomRange",function(e,t){function s(e,t){return e.nodeType!=3&&(n.isAncestorOf(e,t.startContainer,true)||n.isAncestorOf(e,t.endContainer,true))}function o(e){return n.getDocument(e.startContainer)}function u(e,t,n){var r=e._listeners[t];if(r){for(var i=0,s=r.length;i<s;++i){r[i].call(e,{target:e,args:n})}}}function a(e){return new r(e.parentNode,n.getNodeIndex(e))}function f(e){return new r(e.parentNode,n.getNodeIndex(e)+1)}function l(e,t,r){var i=e.nodeType==11?e.firstChild:e;if(n.isCharacterDataNode(t)){if(r==t.length){n.insertAfter(e,t)}else{t.parentNode.insertBefore(e,r==0?t:n.splitDataNode(t,r))}}else{if(r>=t.childNodes.length){t.appendChild(e)}else{t.insertBefore(e,t.childNodes[r])}}return i}function c(e){var t;for(var n,r=o(e.range).createDocumentFragment(),s;n=e.next();){t=e.isPartiallySelectedSubtree();n=n.cloneNode(!t);if(t){s=e.getSubtreeIterator();n.appendChild(c(s));s.detach(true)}if(n.nodeType==10){throw new i("HIERARCHY_REQUEST_ERR")}r.appendChild(n)}return r}function h(e,t,r){var i,s;r=r||{stop:false};for(var o,u;o=e.next();){if(e.isPartiallySelectedSubtree()){if(t(o)===false){r.stop=true;return}else{u=e.getSubtreeIterator();h(u,t,r);u.detach(true);if(r.stop){return}}}else{i=n.createIterator(o);while(s=i.next()){if(t(s)===false){r.stop=true;return}}}}}function p(e){var t;while(e.next()){if(e.isPartiallySelectedSubtree()){t=e.getSubtreeIterator();p(t);t.detach(true)}else{e.remove()}}}function d(e){for(var t,n=o(e.range).createDocumentFragment(),r;t=e.next();){if(e.isPartiallySelectedSubtree()){t=t.cloneNode(false);r=e.getSubtreeIterator();t.appendChild(d(r));r.detach(true)}else{e.remove()}if(t.nodeType==10){throw new i("HIERARCHY_REQUEST_ERR")}n.appendChild(t)}return n}function v(e,t,n){var r=!!(t&&t.length),i;var s=!!n;if(r){i=new RegExp("^("+t.join("|")+")$")}var o=[];h(new g(e,false),function(e){if((!r||i.test(e.nodeType))&&(!s||n(e))){o.push(e)}});return o}function m(e){var t=typeof e.getName=="undefined"?"Range":e.getName();return"["+t+"("+n.inspectNode(e.startContainer)+":"+e.startOffset+", "+n.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function g(e,t){this.range=e;this.clonePartiallySelectedTextNodes=t;if(!e.collapsed){this.sc=e.startContainer;this.so=e.startOffset;this.ec=e.endContainer;this.eo=e.endOffset;var r=e.commonAncestorContainer;if(this.sc===this.ec&&n.isCharacterDataNode(this.sc)){this.isSingleCharacterDataNode=true;this._first=this._last=this._next=this.sc}else{this._first=this._next=this.sc===r&&!n.isCharacterDataNode(this.sc)?this.sc.childNodes[this.so]:n.getClosestAncestorIn(this.sc,r,true);this._last=this.ec===r&&!n.isCharacterDataNode(this.ec)?this.ec.childNodes[this.eo-1]:n.getClosestAncestorIn(this.ec,r,true)}}}function y(e){this.code=this[e];this.codeName=e;this.message="RangeException: "+this.codeName}function b(e,t,n){this.nodes=v(e,t,n);this._next=this.nodes[0];this._position=0}function N(e){return function(t,r){var i,s=r?t:t.parentNode;while(s){i=s.nodeType;if(n.arrayContains(e,i)){return s}s=s.parentNode}return null}}function O(e,t){if(A(e,t)){throw new y("INVALID_NODE_TYPE_ERR")}}function M(e){if(!e.startContainer){throw new i("INVALID_STATE_ERR")}}function _(e,t){if(!n.arrayContains(t,e.nodeType)){throw new y("INVALID_NODE_TYPE_ERR")}}function D(e,t){if(t<0||t>(n.isCharacterDataNode(e)?e.length:e.childNodes.length)){throw new i("INDEX_SIZE_ERR")}}function P(e,t){if(k(e,true)!==k(t,true)){throw new i("WRONG_DOCUMENT_ERR")}}function H(e){if(L(e,true)){throw new i("NO_MODIFICATION_ALLOWED_ERR")}}function B(e,t){if(!e){throw new i(t)}}function j(e){return!n.arrayContains(E,e.nodeType)&&!k(e,true)}function F(e,t){return t<=(n.isCharacterDataNode(e)?e.length:e.childNodes.length)}function I(e){M(e);if(j(e.startContainer)||j(e.endContainer)||!F(e.startContainer,e.startOffset)||!F(e.endContainer,e.endOffset)){throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}}function Z(){}function et(e){e.START_TO_START=X;e.START_TO_END=V;e.END_TO_END=$;e.END_TO_START=J;e.NODE_BEFORE=K;e.NODE_AFTER=Q;e.NODE_BEFORE_AND_AFTER=G;e.NODE_INSIDE=Y}function tt(e){et(e);et(e.prototype)}function nt(e,t){return function(){I(this);var r=this.startContainer,i=this.startOffset,s=this.commonAncestorContainer;var o=new g(this,true);var u,a;if(r!==s){u=n.getClosestAncestorIn(r,s,true);a=f(u);r=a.node;i=a.offset}h(o,H);o.reset();var l=e(o);o.detach();t(this,r,i,r,i);return l}}function rt(t,r,i){function o(e,t){return function(n){M(this);_(n,w);_(C(n),E);var r=(e?a:f)(n);(t?u:l)(this,r.node,r.offset)}}function u(e,t,i){var s=e.endContainer,o=e.endOffset;if(t!==e.startContainer||i!==e.startOffset){if(C(t)!=C(s)||n.comparePoints(t,i,s,o)==1){s=t;o=i}r(e,t,i,s,o)}}function l(e,t,i){var s=e.startContainer,o=e.startOffset;if(t!==e.endContainer||i!==e.endOffset){if(C(t)!=C(s)||n.comparePoints(t,i,s,o)==-1){s=t;o=i}r(e,s,o,t,i)}}function c(e,t,n){if(t!==e.startContainer||n!==e.startOffset||t!==e.endContainer||n!==e.endOffset){r(e,t,n,t,n)}}t.prototype=new Z;e.util.extend(t.prototype,{setStart:function(e,t){M(this);O(e,true);D(e,t);u(this,e,t)},setEnd:function(e,t){M(this);O(e,true);D(e,t);l(this,e,t)},setStartBefore:o(true,true),setStartAfter:o(false,true),setEndBefore:o(true,false),setEndAfter:o(false,false),collapse:function(e){I(this);if(e){r(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset)}else{r(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)}},selectNodeContents:function(e){M(this);O(e,true);r(this,e,0,e,n.getNodeLength(e))},selectNode:function(e){M(this);O(e,false);_(e,w);var t=a(e),n=f(e);r(this,t.node,t.offset,n.node,n.offset)},extractContents:nt(d,r),deleteContents:nt(p,r),canSurroundContents:function(){I(this);H(this.startContainer);H(this.endContainer);var e=new g(this,true);var t=e._first&&s(e._first,this)||e._last&&s(e._last,this);e.detach();return!t},detach:function(){i(this)},splitBoundaries:function(){I(this);var e=this.startContainer,t=this.startOffset,i=this.endContainer,s=this.endOffset;var o=e===i;if(n.isCharacterDataNode(i)&&s>0&&s<i.length){n.splitDataNode(i,s)}if(n.isCharacterDataNode(e)&&t>0&&t<e.length){e=n.splitDataNode(e,t);if(o){s-=t;i=e}else{if(i==e.parentNode&&s>=n.getNodeIndex(e)){s++}}t=0}r(this,e,t,i,s)},normalizeBoundaries:function(){I(this);var e=this.startContainer,t=this.startOffset,i=this.endContainer,s=this.endOffset;var o=function(e){var t=e.nextSibling;if(t&&t.nodeType==e.nodeType){i=e;s=e.length;e.appendData(t.data);t.parentNode.removeChild(t)}};var u=function(r){var o=r.previousSibling;if(o&&o.nodeType==r.nodeType){e=r;var u=r.length;t=o.length;r.insertData(0,o.data);o.parentNode.removeChild(o);if(e==i){s+=t;i=e}else{if(i==r.parentNode){var a=n.getNodeIndex(r);if(s==a){i=r;s=u}else{if(s>a){s--}}}}}};var a=true;if(n.isCharacterDataNode(i)){if(i.length==s){o(i)}}else{if(s>0){var f=i.childNodes[s-1];if(f&&n.isCharacterDataNode(f)){o(f)}}a=!this.collapsed}if(a){if(n.isCharacterDataNode(e)){if(t==0){u(e)}}else{if(t<e.childNodes.length){var l=e.childNodes[t];if(l&&n.isCharacterDataNode(l)){u(l)}}}}else{e=i;t=s}r(this,e,t,i,s)},collapseToPoint:function(e,t){M(this);O(e,true);D(e,t);c(this,e,t)}});tt(t)}function it(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset;e.commonAncestorContainer=e.collapsed?e.startContainer:n.getCommonAncestor(e.startContainer,e.endContainer)}function st(e,t,n,r,i){var s=e.startContainer!==t||e.startOffset!==n;var o=e.endContainer!==r||e.endOffset!==i;e.startContainer=t;e.startOffset=n;e.endContainer=r;e.endOffset=i;it(e);u(e,"boundarychange",{startMoved:s,endMoved:o})}function ot(e){M(e);e.startContainer=e.startOffset=e.endContainer=e.endOffset=null;e.collapsed=e.commonAncestorContainer=null;u(e,"detach",null);e._listeners=null}function ut(e){this.startContainer=e;this.startOffset=0;this.endContainer=e;this.endOffset=0;this._listeners={boundarychange:[],detach:[]};it(this)}e.requireModules(["DomUtil"]);var n=e.dom;var r=n.DomPosition;var i=e.DOMException;g.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:false,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;if(e){this._next=e!==this._last?e.nextSibling:null;if(n.isCharacterDataNode(e)&&this.clonePartiallySelectedTextNodes){if(e===this.ec){(e=e.cloneNode(true)).deleteData(this.eo,e.length-this.eo)}if(this._current===this.sc){(e=e.cloneNode(true)).deleteData(0,this.so)}}}return e},remove:function(){var e=this._current,t,r;if(n.isCharacterDataNode(e)&&(e===this.sc||e===this.ec)){t=e===this.sc?this.so:0;r=e===this.ec?this.eo:e.length;if(t!=r){e.deleteData(t,r-t)}}else{if(e.parentNode){e.parentNode.removeChild(e)}else{}}},isPartiallySelectedSubtree:function(){var e=this._current;return s(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode){e=this.range.cloneRange();e.collapse()}else{e=new ut(o(this.range));var t=this._current;var r=t,i=0,s=t,u=n.getNodeLength(t);if(n.isAncestorOf(t,this.sc,true)){r=this.sc;i=this.so}if(n.isAncestorOf(t,this.ec,true)){s=this.ec;u=this.eo}st(e,r,i,s,u)}return new g(e,this.clonePartiallySelectedTextNodes)},detach:function(e){if(e){this.range.detach()}this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};y.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2};y.prototype.toString=function(){return this.message};b.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){this._current=this._next;this._next=this.nodes[++this._position];return this._current},detach:function(){this._current=this._next=this.nodes=null}};var w=[1,3,4,5,7,8,10];var E=[2,9,11];var S=[5,6,10,12];var x=[1,3,4,5,7,8,10,11];var T=[1,3,4,5,7,8];var C=n.getRootContainer;var k=N([9,11]);var L=N(S);var A=N([6,10,12]);var q=document.createElement("style");var R=false;try{q.innerHTML="<b>x</b>";R=q.firstChild.nodeType==3}catch(U){}e.features.htmlParsingConforms=R;var z=R?function(e){var t=this.startContainer;var r=n.getDocument(t);if(!t){throw new i("INVALID_STATE_ERR")}var s=null;if(t.nodeType==1){s=t}else{if(n.isCharacterDataNode(t)){s=n.parentElement(t)}}if(s===null||s.nodeName=="HTML"&&n.isHtmlNamespace(n.getDocument(s).documentElement)&&n.isHtmlNamespace(s)){s=r.createElement("body")}else{s=s.cloneNode(false)}s.innerHTML=e;return n.fragmentFromNodeChildren(s)}:function(e){M(this);var t=o(this);var r=t.createElement("body");r.innerHTML=e;return n.fragmentFromNodeChildren(r)};var W=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"];var X=0,V=1,$=2,J=3;var K=0,Q=1,G=2,Y=3;Z.prototype={attachListener:function(e,t){this._listeners[e].push(t)},compareBoundaryPoints:function(e,t){I(this);P(this.startContainer,t.startContainer);var r,i,s,o;var u=e==J||e==X?"start":"end";var a=e==V||e==X?"start":"end";r=this[u+"Container"];i=this[u+"Offset"];s=t[a+"Container"];o=t[a+"Offset"];return n.comparePoints(r,i,s,o)},insertNode:function(e){I(this);_(e,x);H(this.startContainer);if(n.isAncestorOf(e,this.startContainer,true)){throw new i("HIERARCHY_REQUEST_ERR")}var t=l(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){I(this);var e,t;if(this.collapsed){return o(this).createDocumentFragment()}else{if(this.startContainer===this.endContainer&&n.isCharacterDataNode(this.startContainer)){e=this.startContainer.cloneNode(true);e.data=e.data.slice(this.startOffset,this.endOffset);t=o(this).createDocumentFragment();t.appendChild(e);return t}else{var r=new g(this,true);e=c(r);r.detach()}return e}},canSurroundContents:function(){I(this);H(this.startContainer);H(this.endContainer);var e=new g(this,true);var t=e._first&&s(e._first,this)||e._last&&s(e._last,this);e.detach();return!t},surroundContents:function(e){_(e,T);if(!this.canSurroundContents()){throw new y("BAD_BOUNDARYPOINTS_ERR")}var t=this.extractContents();if(e.hasChildNodes()){while(e.lastChild){e.removeChild(e.lastChild)}}l(e,this.startContainer,this.startOffset);e.appendChild(t);this.selectNode(e)},cloneRange:function(){I(this);var e=new ut(o(this));var t=W.length,n;while(t--){n=W[t];e[n]=this[n]}return e},toString:function(){I(this);var e=this.startContainer;if(e===this.endContainer&&n.isCharacterDataNode(e)){return e.nodeType==3||e.nodeType==4?e.data.slice(this.startOffset,this.endOffset):""}else{var t=[],r=new g(this,true);h(r,function(e){if(e.nodeType==3||e.nodeType==4){t.push(e.data)}});r.detach();return t.join("")}},compareNode:function(e){I(this);var t=e.parentNode;var r=n.getNodeIndex(e);if(!t){throw new i("NOT_FOUND_ERR")}var s=this.comparePoint(t,r),o=this.comparePoint(t,r+1);if(s<0){return o>0?G:K}else{return o>0?Q:Y}},comparePoint:function(e,t){I(this);B(e,"HIERARCHY_REQUEST_ERR");P(e,this.startContainer);if(n.comparePoints(e,t,this.startContainer,this.startOffset)<0){return-1}else{if(n.comparePoints(e,t,this.endContainer,this.endOffset)>0){return 1}}return 0},createContextualFragment:z,toHtml:function(){I(this);var e=o(this).createElement("div");e.appendChild(this.cloneContents());return e.innerHTML},intersectsNode:function(e,t){I(this);B(e,"NOT_FOUND_ERR");if(n.getDocument(e)!==o(this)){return false}var r=e.parentNode,i=n.getNodeIndex(e);B(r,"NOT_FOUND_ERR");var s=n.comparePoints(r,i,this.endContainer,this.endOffset),u=n.comparePoints(r,i+1,this.startContainer,this.startOffset);return t?s<=0&&u>=0:s<0&&u>0},isPointInRange:function(e,t){I(this);B(e,"HIERARCHY_REQUEST_ERR");P(e,this.startContainer);return n.comparePoints(e,t,this.startContainer,this.startOffset)>=0&&n.comparePoints(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e,t){I(this);if(o(e)!=o(this)){throw new i("WRONG_DOCUMENT_ERR")}var r=n.comparePoints(this.startContainer,this.startOffset,e.endContainer,e.endOffset),s=n.comparePoints(this.endContainer,this.endOffset,e.startContainer,e.startOffset);return t?r<=0&&s>=0:r<0&&s>0},intersection:function(e){if(this.intersectsRange(e)){var t=n.comparePoints(this.startContainer,this.startOffset,e.startContainer,e.startOffset),r=n.comparePoints(this.endContainer,this.endOffset,e.endContainer,e.endOffset);var i=this.cloneRange();if(t==-1){i.setStart(e.startContainer,e.startOffset)}if(r==1){i.setEnd(e.endContainer,e.endOffset)}return i}return null},union:function(e){if(this.intersectsRange(e,true)){var t=this.cloneRange();if(n.comparePoints(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1){t.setStart(e.startContainer,e.startOffset)}if(n.comparePoints(e.endContainer,e.endOffset,this.endContainer,this.endOffset)==1){t.setEnd(e.endContainer,e.endOffset)}return t}else{throw new y("Ranges do not intersect")}},containsNode:function(e,t){if(t){return this.intersectsNode(e,false)}else{return this.compareNode(e)==Y}},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,n.getNodeLength(e))<=0},containsRange:function(e){return this.intersection(e).equals(e)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var r=n.pop();t.setEnd(r,r.length);var i=this.containsRange(t);t.detach();return i}else{return this.containsNodeContents(e)}},createNodeIterator:function(e,t){I(this);return new b(this,e,t)},getNodes:function(e,t){I(this);return v(this,e,t)},getDocument:function(){return o(this)},collapseBefore:function(e){M(this);this.setEndBefore(e);this.collapse(false)},collapseAfter:function(e){M(this);this.setStartAfter(e);this.collapse(true)},getName:function(){return"DomRange"},equals:function(e){return ut.rangesEqual(this,e)},inspect:function(){return m(this)}};rt(ut,st,ot);e.rangePrototype=Z.prototype;ut.rangeProperties=W;ut.RangeIterator=g;ut.copyComparisonConstants=tt;ut.createPrototypeRange=rt;ut.inspect=m;ut.getRangeDocument=o;ut.rangesEqual=function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset};e.DomRange=ut;e.RangeException=y});rangy.createModule("WrappedRange",function(e,t){function o(e){var t=e.parentElement();var n=e.duplicate();n.collapse(true);var i=n.parentElement();n=e.duplicate();n.collapse(false);var s=n.parentElement();var o=i==s?i:r.getCommonAncestor(i,s);return o==t?o:r.getCommonAncestor(t,o)}function u(e){return e.compareEndPoints("StartToEnd",e)==0}function a(e,t,n,s){var o=e.duplicate();o.collapse(n);var u=o.parentElement();if(!r.isAncestorOf(t,u,true)){u=t}if(!u.canHaveHTML){return new i(u.parentNode,r.getNodeIndex(u))}var a=r.getDocument(u).createElement("span");var f,l=n?"StartToStart":"StartToEnd";var h,p,d,v;do{u.insertBefore(a,a.previousSibling);o.moveToElementText(a)}while((f=o.compareEndPoints(l,e))>0&&a.previousSibling);v=a.nextSibling;if(f==-1&&v&&r.isCharacterDataNode(v)){o.setEndPoint(n?"EndToStart":"EndToEnd",e);var m;if(/[\r\n]/.test(v.data)){var g=o.duplicate();var y=g.text.replace(/\r\n/g,"\r").length;m=g.moveStart("character",y);while((f=g.compareEndPoints("StartToEnd",g))==-1){m++;g.moveStart("character",1)}}else{m=o.text.length}d=new i(v,m)}else{h=(s||!n)&&a.previousSibling;p=(s||n)&&a.nextSibling;if(p&&r.isCharacterDataNode(p)){d=new i(p,0)}else{if(h&&r.isCharacterDataNode(h)){d=new i(h,h.length)}else{d=new i(u,r.getNodeIndex(a))}}}a.parentNode.removeChild(a);return d}function f(e,t){var n,i,s=e.offset;var o=r.getDocument(e.node);var u,a,f=o.body.createTextRange();var l=r.isCharacterDataNode(e.node);if(l){n=e.node;i=n.parentNode}else{a=e.node.childNodes;n=s<a.length?a[s]:null;i=e.node}u=o.createElement("span");u.innerHTML="&#feff;";if(n){i.insertBefore(u,n)}else{i.appendChild(u)}f.moveToElementText(u);f.collapse(!t);i.removeChild(u);if(l){f[t?"moveStart":"moveEnd"]("character",s)}return f}e.requireModules(["DomUtil","DomRange"]);var n;var r=e.dom;var i=r.DomPosition;var s=e.DomRange;if(e.features.implementsDomRange&&(!e.features.implementsTextRange||!e.config.preferTextRange)){(function(){function u(e){var t=i.length,n;while(t--){n=i[t];e[n]=e.nativeRange[n]}}function a(e,t,n,r,i){var s=e.startContainer!==t||e.startOffset!=n;var o=e.endContainer!==r||e.endOffset!=i;if(s||o){e.setEnd(r,i);e.setStart(t,n)}}function f(e){e.nativeRange.detach();e.detached=true;var t=i.length,n;while(t--){n=i[t];e[n]=null}}var t;var i=s.rangeProperties;var o;var l;n=function(e){if(!e){throw new Error("Range must be specified")}this.nativeRange=e;u(this)};s.createPrototypeRange(n,a,f);t=n.prototype;t.selectNode=function(e){this.nativeRange.selectNode(e);u(this)};t.deleteContents=function(){this.nativeRange.deleteContents();u(this)};t.extractContents=function(){var e=this.nativeRange.extractContents();u(this);return e};t.cloneContents=function(){return this.nativeRange.cloneContents()};t.surroundContents=function(e){this.nativeRange.surroundContents(e);u(this)};t.collapse=function(e){this.nativeRange.collapse(e);u(this)};t.cloneRange=function(){return new n(this.nativeRange.cloneRange())};t.refresh=function(){u(this)};t.toString=function(){return this.nativeRange.toString()};var c=document.createTextNode("test");r.getBody(document).appendChild(c);var h=document.createRange();h.setStart(c,0);h.setEnd(c,0);try{h.setStart(c,1);o=true;t.setStart=function(e,t){this.nativeRange.setStart(e,t);u(this)};t.setEnd=function(e,t){this.nativeRange.setEnd(e,t);u(this)};l=function(e){return function(t){this.nativeRange[e](t);u(this)}}}catch(p){o=false;t.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t);this.nativeRange.setStart(e,t)}u(this)};t.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t);this.nativeRange.setEnd(e,t)}u(this)};l=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(r){this.nativeRange[t](n);this.nativeRange[e](n)}u(this)}}}t.setStartBefore=l("setStartBefore","setEndBefore");t.setStartAfter=l("setStartAfter","setEndAfter");t.setEndBefore=l("setEndBefore","setStartBefore");t.setEndAfter=l("setEndAfter","setStartAfter");h.selectNodeContents(c);if(h.startContainer==c&&h.endContainer==c&&h.startOffset==0&&h.endOffset==c.length){t.selectNodeContents=function(e){this.nativeRange.selectNodeContents(e);u(this)}}else{t.selectNodeContents=function(e){this.setStart(e,0);this.setEnd(e,s.getEndOffset(e))}}h.selectNodeContents(c);h.setEnd(c,3);var d=document.createRange();d.selectNodeContents(c);d.setEnd(c,4);d.setStart(c,2);if(h.compareBoundaryPoints(h.START_TO_END,d)==-1&h.compareBoundaryPoints(h.END_TO_START,d)==1){t.compareBoundaryPoints=function(e,t){t=t.nativeRange||t;if(e==t.START_TO_END){e=t.END_TO_START}else{if(e==t.END_TO_START){e=t.START_TO_END}}return this.nativeRange.compareBoundaryPoints(e,t)}}else{t.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)}}if(e.util.isHostMethod(h,"createContextualFragment")){t.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}}r.getBody(document).removeChild(c);h.detach();d.detach()})();e.createNativeRange=function(e){e=e||document;return e.createRange()}}else{if(e.features.implementsTextRange){n=function(e){this.textRange=e;this.refresh()};n.prototype=new s(document);n.prototype.refresh=function(){var e,t;var n=o(this.textRange);if(u(this.textRange)){t=e=a(this.textRange,n,true,true)}else{e=a(this.textRange,n,true,false);t=a(this.textRange,n,false,false)}this.setStart(e.node,e.offset);this.setEnd(t.node,t.offset)};s.copyComparisonConstants(n);var l=function(){return this}();if(typeof l.Range=="undefined"){l.Range=n}e.createNativeRange=function(e){e=e||document;return e.body.createTextRange()}}}if(e.features.implementsTextRange){n.rangeToTextRange=function(e){if(e.collapsed){var t=f(new i(e.startContainer,e.startOffset),true);return t}else{var n=f(new i(e.startContainer,e.startOffset),true);var s=f(new i(e.endContainer,e.endOffset),false);var o=r.getDocument(e.startContainer).body.createTextRange();o.setEndPoint("StartToStart",n);o.setEndPoint("EndToEnd",s);return o}}}n.prototype.getName=function(){return"WrappedRange"};e.WrappedRange=n;e.createRange=function(t){t=t||document;return new n(e.createNativeRange(t))};e.createRangyRange=function(e){e=e||document;return new s(e)};e.createIframeRange=function(t){return e.createRange(r.getIframeDocument(t))};e.createIframeRangyRange=function(t){return e.createRangyRange(r.getIframeDocument(t))};e.addCreateMissingNativeApiListener(function(t){var n=t.document;if(typeof n.createRange=="undefined"){n.createRange=function(){return e.createRange(this)}}n=t=null})});rangy.createModule("WrappedSelection",function(e,t){function p(e){return(e||window).getSelection()}function d(e){return(e||window).document.selection}function L(e,t,n){var r=n?"end":"start",i=n?"start":"end";e.anchorNode=t[r+"Container"];e.anchorOffset=t[r+"Offset"];e.focusNode=t[i+"Container"];e.focusOffset=t[i+"Offset"]}function A(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode;e.anchorOffset=t.anchorOffset;e.focusNode=t.focusNode;e.focusOffset=t.focusOffset}function O(e){e.anchorNode=e.focusNode=null;e.anchorOffset=e.focusOffset=0;e.rangeCount=0;e.isCollapsed=true;e._ranges.length=0}function M(t){var n;if(t instanceof o){n=t._selectionNativeRange;if(!n){n=e.createNativeRange(i.getDocument(t.startContainer));n.setEnd(t.endContainer,t.endOffset);n.setStart(t.startContainer,t.startOffset);t._selectionNativeRange=n;t.attachListener("detach",function(){this._selectionNativeRange=null})}}else{if(t instanceof u){n=t.nativeRange}else{if(e.features.implementsDomRange&&t instanceof i.getWindow(t.startContainer).Range){n=t}}}return n}function _(e){if(!e.length||e[0].nodeType!=1){return false}for(var t=1,n=e.length;t<n;++t){if(!i.isAncestorOf(e[0],e[t])){return false}}return true}function D(e){var t=e.getNodes();if(!_(t)){throw new Error("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element")}return t[0]}function P(e){return!!e&&typeof e.text!="undefined"}function H(e,t){var n=new u(t);e._ranges=[n];L(e,n,false);e.rangeCount=1;e.isCollapsed=n.collapsed}function B(t){t._ranges.length=0;if(t.docSelection.type=="None"){O(t)}else{var n=t.docSelection.createRange();if(P(n)){H(t,n)}else{t.rangeCount=n.length;var r,s=i.getDocument(n.item(0));for(var o=0;o<t.rangeCount;++o){r=e.createRange(s);r.selectNode(n.item(o));t._ranges.push(r)}t.isCollapsed=t.rangeCount==1&&t._ranges[0].collapsed;L(t,t._ranges[t.rangeCount-1],false)}}}function j(e,t){var n=e.docSelection.createRange();var r=D(t);var s=i.getDocument(n.item(0));var o=i.getBody(s).createControlRange();for(var u=0,a=n.length;u<a;++u){o.add(n.item(u))}try{o.add(r)}catch(f){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}o.select();B(e)}function I(e,t,n){this.nativeSelection=e;this.docSelection=t;this._ranges=[];this.win=n;this.refresh()}function R(e,t){var n=i.getDocument(t[0].startContainer);var r=i.getBody(n).createControlRange();for(var s=0,o;s<rangeCount;++s){o=D(t[s]);try{r.add(o)}catch(u){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}r.select();B(e)}function V(e,t){if(e.anchorNode&&i.getDocument(e.anchorNode)!==i.getDocument(t)){throw new a("WRONG_DOCUMENT_ERR")}}function $(e){var t=[];var n=new f(e.anchorNode,e.anchorOffset);var r=new f(e.focusNode,e.focusOffset);var i=typeof e.getName=="function"?e.getName():"Selection";if(typeof e.rangeCount!="undefined"){for(var s=0,u=e.rangeCount;s<u;++s){t[s]=o.inspect(e.getRangeAt(s))}}return"["+i+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+r.inspect()+"]"}e.requireModules(["DomUtil","DomRange","WrappedRange"]);e.config.checkSelectionRanges=true;var n="boolean",r="_rangySelection",i=e.dom,s=e.util,o=e.DomRange,u=e.WrappedRange,a=e.DOMException,f=i.DomPosition,l,c,h="Control";var v=e.util.isHostMethod(window,"getSelection"),m=e.util.isHostObject(document,"selection");var g=m&&(!v||e.config.preferTextRange);if(g){l=d;e.isSelectionValid=function(e){var t=(e||window).document,n=t.selection;return n.type!="None"||i.getDocument(n.createRange().parentElement())==t}}else{if(v){l=p;e.isSelectionValid=function(){return true}}else{t.fail("Neither document.selection or window.getSelection() detected.")}}e.getNativeSelection=l;var y=l();var b=e.createNativeRange(document);var w=i.getBody(document);var E=s.areHostObjects(y,["anchorNode","focusNode"]&&s.areHostProperties(y,["anchorOffset","focusOffset"]));e.features.selectionHasAnchorAndFocus=E;var S=s.isHostMethod(y,"extend");e.features.selectionHasExtend=S;var x=typeof y.rangeCount=="number";e.features.selectionHasRangeCount=x;var T=false;var N=true;if(s.areHostMethods(y,["addRange","getRangeAt","removeAllRanges"])&&typeof y.rangeCount=="number"&&e.features.implementsDomRange){(function(){var e=document.createElement("iframe");w.appendChild(e);var t=i.getIframeDocument(e);t.open();t.write("<html><head></head><body>12</body></html>");t.close();var n=i.getIframeWindow(e).getSelection();var r=t.documentElement;var s=r.lastChild,o=s.firstChild;var u=t.createRange();u.setStart(o,1);u.collapse(true);n.addRange(u);N=n.rangeCount==1;n.removeAllRanges();var a=u.cloneRange();u.setStart(o,0);a.setEnd(o,2);n.addRange(u);n.addRange(a);T=n.rangeCount==2;u.detach();a.detach();w.removeChild(e)})()}e.features.selectionSupportsMultipleRanges=T;e.features.collapsedNonEditableSelectionsSupported=N;var C=false,k;if(w&&s.isHostMethod(w,"createControlRange")){k=w.createControlRange();if(s.areHostProperties(k,["item","add"])){C=true}}e.features.implementsControlRange=C;if(E){c=function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}}else{c=function(e){return e.rangeCount?e.getRangeAt(e.rangeCount-1).collapsed:false}}var F;if(s.isHostMethod(y,"getRangeAt")){F=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}}else{if(E){F=function(t){var n=i.getDocument(t.anchorNode);var r=e.createRange(n);r.setStart(t.anchorNode,t.anchorOffset);r.setEnd(t.focusNode,t.focusOffset);if(r.collapsed!==this.isCollapsed){r.setStart(t.focusNode,t.focusOffset);r.setEnd(t.anchorNode,t.anchorOffset)}return r}}}e.getSelection=function(e){e=e||window;var t=e[r];var n=l(e),i=m?d(e):null;if(t){t.nativeSelection=n;t.docSelection=i;t.refresh(e)}else{t=new I(n,i,e);e[r]=t}return t};e.getIframeSelection=function(t){return e.getSelection(i.getIframeWindow(t))};var q=I.prototype;if(!g&&E&&s.areHostMethods(y,["removeAllRanges","addRange"])){q.removeAllRanges=function(){this.nativeSelection.removeAllRanges();O(this)};var U=function(t,n){var r=o.getRangeDocument(n);var i=e.createRange(r);i.collapseToPoint(n.endContainer,n.endOffset);t.nativeSelection.addRange(M(i));t.nativeSelection.extend(n.startContainer,n.startOffset);t.refresh()};if(x){q.addRange=function(t,n){if(C&&m&&this.docSelection.type==h){j(this,t)}else{if(n&&S){U(this,t)}else{var r;if(T){r=this.rangeCount}else{this.removeAllRanges();r=0}this.nativeSelection.addRange(M(t));this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==r+1){if(e.config.checkSelectionRanges){var i=F(this.nativeSelection,this.rangeCount-1);if(i&&!o.rangesEqual(i,t)){t=new u(i)}}this._ranges[this.rangeCount-1]=t;L(this,t,X(this.nativeSelection));this.isCollapsed=c(this)}else{this.refresh()}}}}}else{q.addRange=function(e,t){if(t&&S){U(this,e)}else{this.nativeSelection.addRange(M(e));this.refresh()}}}q.setRanges=function(e){if(C&&e.length>1){R(this,e)}else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t){this.addRange(e[t])}}}}else{if(s.isHostMethod(y,"empty")&&s.isHostMethod(b,"select")&&C&&g){q.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var e;if(this.anchorNode){e=i.getDocument(this.anchorNode)}else{if(this.docSelection.type==h){var t=this.docSelection.createRange();if(t.length){e=i.getDocument(t.item(0)).body.createTextRange()}}}if(e){var n=e.body.createTextRange();n.select();this.docSelection.empty()}}}catch(r){}O(this)};q.addRange=function(e){if(this.docSelection.type==h){j(this,e)}else{u.rangeToTextRange(e).select();this._ranges[0]=e;this.rangeCount=1;this.isCollapsed=this._ranges[0].collapsed;L(this,e,false)}};q.setRanges=function(e){this.removeAllRanges();var t=e.length;if(t>1){R(this,e)}else{if(t){this.addRange(e[0])}}}}else{t.fail("No means of selecting a Range or TextRange was found");return false}}q.getRangeAt=function(e){if(e<0||e>=this.rangeCount){throw new a("INDEX_SIZE_ERR")}else{return this._ranges[e]}};var z;if(g){z=function(t){var n;if(e.isSelectionValid(t.win)){n=t.docSelection.createRange()}else{n=i.getBody(t.win.document).createTextRange();n.collapse(true)}if(t.docSelection.type==h){B(t)}else{if(P(n)){H(t,n)}else{O(t)}}}}else{if(s.isHostMethod(y,"getRangeAt")&&typeof y.rangeCount=="number"){z=function(t){if(C&&m&&t.docSelection.type==h){B(t)}else{t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount;if(t.rangeCount){for(var n=0,r=t.rangeCount;n<r;++n){t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n))}L(t,t._ranges[t.rangeCount-1],X(t.nativeSelection));t.isCollapsed=c(t)}else{O(t)}}}}else{if(E&&typeof y.isCollapsed==n&&typeof b.collapsed==n&&e.features.implementsDomRange){z=function(e){var t,n=e.nativeSelection;if(n.anchorNode){t=F(n,0);e._ranges=[t];e.rangeCount=1;A(e);e.isCollapsed=c(e)}else{O(e)}}}else{t.fail("No means of obtaining a Range or TextRange from the user's selection was found");return false}}}q.refresh=function(e){var t=e?this._ranges.slice(0):null;z(this);if(e){var n=t.length;if(n!=this._ranges.length){return false}while(n--){if(!o.rangesEqual(t[n],this._ranges[n])){return false}}return true}};var W=function(e,t){var n=e.getAllRanges(),r=false;e.removeAllRanges();for(var i=0,s=n.length;i<s;++i){if(r||t!==n[i]){e.addRange(n[i])}else{r=true}}if(!e.rangeCount){O(e)}};if(C){q.removeRange=function(e){if(this.docSelection.type==h){var t=this.docSelection.createRange();var n=D(e);var r=i.getDocument(t.item(0));var s=i.getBody(r).createControlRange();var o,u=false;for(var a=0,f=t.length;a<f;++a){o=t.item(a);if(o!==n||u){s.add(t.item(a))}else{u=true}}s.select();B(this)}else{W(this,e)}}}else{q.removeRange=function(e){W(this,e)}}var X;if(!g&&E&&e.features.implementsDomRange){X=function(e){var t=false;if(e.anchorNode){t=i.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)==1}return t};q.isBackwards=function(){return X(this)}}else{X=q.isBackwards=function(){return false}}q.toString=function(){var e=[];for(var t=0,n=this.rangeCount;t<n;++t){e[t]=""+this._ranges[t]}return e.join("")};q.collapse=function(t,n){V(this,t);var r=e.createRange(i.getDocument(t));r.collapseToPoint(t,n);this.removeAllRanges();this.addRange(r);this.isCollapsed=true};q.collapseToStart=function(){if(this.rangeCount){var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)}else{throw new a("INVALID_STATE_ERR")}};q.collapseToEnd=function(){if(this.rangeCount){var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)}else{throw new a("INVALID_STATE_ERR")}};q.selectAllChildren=function(t){V(this,t);var n=e.createRange(i.getDocument(t));n.selectNodeContents(t);this.removeAllRanges();this.addRange(n)};q.deleteFromDocument=function(){if(C&&m&&this.docSelection.type==h){var e=this.docSelection.createRange();var t;while(e.length){t=e.item(0);e.remove(t);t.parentNode.removeChild(t)}this.refresh()}else{if(this.rangeCount){var n=this.getAllRanges();this.removeAllRanges();for(var r=0,i=n.length;r<i;++r){n[r].deleteContents()}this.addRange(n[i-1])}}};q.getAllRanges=function(){return this._ranges.slice(0)};q.setSingleRange=function(e){this.setRanges([e])};q.containsNode=function(e,t){for(var n=0,r=this._ranges.length;n<r;++n){if(this._ranges[n].containsNode(e,t)){return true}}return false};q.toHtml=function(){var e="";if(this.rangeCount){var t=o.getRangeDocument(this._ranges[0]).createElement("div");for(var n=0,r=this._ranges.length;n<r;++n){t.appendChild(this._ranges[n].cloneContents())}e=t.innerHTML}return e};q.getName=function(){return"WrappedSelection"};q.inspect=function(){return $(this)};q.detach=function(){this.win[r]=null;this.win=this.anchorNode=this.focusNode=null};I.inspect=$;e.Selection=I;e.selectionPrototype=q;e.addCreateMissingNativeApiListener(function(t){if(typeof t.getSelection=="undefined"){t.getSelection=function(){return e.getSelection(this)}}t=null})});var Base=function(){};Base.extend=function(e,t){var n=Base.prototype.extend;Base._prototyping=true;var r=new this;n.call(r,e);r.base=function(){};delete Base._prototyping;var i=r.constructor;var s=r.constructor=function(){if(!Base._prototyping){if(this._constructing||this.constructor==s){this._constructing=true;i.apply(this,arguments);delete this._constructing}else{if(arguments[0]!=null){return(arguments[0].extend||n).call(arguments[0],r)}}}};s.ancestor=this;s.extend=this.extend;s.forEach=this.forEach;s.implement=this.implement;s.prototype=r;s.toString=this.toString;s.valueOf=function(e){return e=="object"?s:i.valueOf()};n.call(s,t);if(typeof s.init=="function"){s.init()}return s};Base.prototype={extend:function(e,t){if(arguments.length>1){var n=this[e];if(n&&typeof t=="function"&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var r=t.valueOf();t=function(){var e=this.base||Base.prototype.base;this.base=n;var t=r.apply(this,arguments);this.base=e;return t};t.valueOf=function(e){return e=="object"?t:r};t.toString=Base.toString}this[e]=t}else{if(e){var i=Base.prototype.extend;if(!Base._prototyping&&typeof this!="function"){i=this.extend||i}var s={toSource:null};var o=["constructor","toString","valueOf"];var u=Base._prototyping?0:1;while(a=o[u++]){if(e[a]!=s[a]){i.call(this,a,e[a])}}for(var a in e){if(!s[a]){i.call(this,a,e[a])}}}}return this}};Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var r in e){if(this.prototype[r]===undefined){t.call(n,e[r],r,e)}}},implement:function(){for(var e=0;e<arguments.length;e++){if(typeof arguments[e]=="function"){arguments[e](this.prototype)}else{this.prototype.extend(arguments[e])}}return this},toString:function(){return String(this.valueOf())}});wysihtml5.browser=function(){function u(e){return(/ipad|iphone|ipod/.test(e)&&e.match(/ os (\d+).+? like mac os x/)||[,0])[1]}var e=navigator.userAgent,t=document.createElement("div"),n=e.indexOf("MSIE")!==-1&&e.indexOf("Opera")===-1,r=e.indexOf("Gecko")!==-1&&e.indexOf("KHTML")===-1,i=e.indexOf("AppleWebKit/")!==-1,s=e.indexOf("Chrome/")!==-1,o=e.indexOf("Opera/")!==-1;return{USER_AGENT:e,supported:function(){var e=this.USER_AGENT.toLowerCase(),n="contentEditable"in t,r=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,i=document.querySelector&&document.querySelectorAll,s=this.isIos()&&u(e)<5||e.indexOf("opera mobi")!==-1||e.indexOf("hpwos/")!==-1;return n&&r&&i&&!s},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){var e=this.USER_AGENT.toLowerCase();return e.indexOf("webkit")!==-1&&e.indexOf("mobile")!==-1},supportsSandboxedIframes:function(){return n},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return!r},hasCurrentStyleProperty:function(){return"currentStyle"in t},insertsLineBreaksOnReturn:function(){return r},supportsPlaceholderAttributeOn:function(e){return"placeholder"in e},supportsEvent:function(e){return"on"+e in t||function(){t.setAttribute("on"+e,"return;");return typeof t["on"+e]==="function"}()},supportsEventsInIframeCorrectly:function(){return!o},firesOnDropOnlyWhenOnDragOverIsCancelled:function(){return i||r},supportsDataTransfer:function(){try{return i&&(window.Clipboard||window.DataTransfer).prototype.getData}catch(e){return false}},supportsHTML5Tags:function(e){var t=e.createElement("div"),n="<article>foo</article>";t.innerHTML=n;return t.innerHTML.toLowerCase()===n},supportsCommand:function(){var e={formatBlock:n,insertUnorderedList:n||o||i,insertOrderedList:n||o||i};var t={insertHTML:r};return function(n,r){var i=e[r];if(!i){try{return n.queryCommandSupported(r)}catch(s){}try{return n.queryCommandEnabled(r)}catch(o){return!!t[r]}}return false}}(),doesAutoLinkingInContentEditable:function(){return n},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return r||o||i},supportsGetAttributeCorrectly:function(){var e=document.createElement("td");return e.getAttribute("rowspan")!="1"},canSelectImagesInContentEditable:function(){return r||n||o},clearsListsInContentEditableCorrectly:function(){return r||n||i},autoScrollsToCaret:function(){return!i},autoClosesUnclosedTags:function(){var e=t.cloneNode(false),n,r;e.innerHTML="<p><div></div>";r=e.innerHTML.toLowerCase();n=r==="<p></p><div></div>"||r==="<p><div></div></p>";this.autoClosesUnclosedTags=function(){return n};return n},supportsNativeGetElementsByClassName:function(){return String(document.getElementsByClassName).indexOf("[native code]")!==-1},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},supportsClassList:function(){return"classList"in t},needsSpaceAfterLineBreak:function(){return o},supportsSpeechApiOn:function(t){var n=e.match(/Chrome\/(\d+)/)||[,0];return n[1]>=11&&("onwebkitspeechchange"in t||"speech"in t)},crashesWhenDefineProperty:function(e){return n&&(e==="XMLHttpRequest"||e==="XDomainRequest")},doesAsyncFocus:function(){return n},hasProblemsSettingCaretAfterImg:function(){return n},hasUndoInContextMenu:function(){return r||s||o}}}();wysihtml5.lang.array=function(e){return{contains:function(t){if(e.indexOf){return e.indexOf(t)!==-1}else{for(var n=0,r=e.length;n<r;n++){if(e[n]===t){return true}}return false}},without:function(t){t=wysihtml5.lang.array(t);var n=[],r=0,i=e.length;for(;r<i;r++){if(!t.contains(e[r])){n.push(e[r])}}return n},get:function(){var t=0,n=e.length,r=[];for(;t<n;t++){r.push(e[t])}return r}}};wysihtml5.lang.Dispatcher=Base.extend({observe:function(e,t){this.events=this.events||{};this.events[e]=this.events[e]||[];this.events[e].push(t);return this},on:function(){return this.observe.apply(this,wysihtml5.lang.array(arguments).get())},fire:function(e,t){this.events=this.events||{};var n=this.events[e]||[],r=0;for(;r<n.length;r++){n[r].call(this,t)}return this},stopObserving:function(e,t){this.events=this.events||{};var n=0,r,i;if(e){r=this.events[e]||[],i=[];for(;n<r.length;n++){if(r[n]!==t&&t){i.push(r[n])}}this.events[e]=i}else{this.events={}}return this}});wysihtml5.lang.object=function(e){return{merge:function(t){for(var n in t){e[n]=t[n]}return this},get:function(){return e},clone:function(){var t={},n;for(n in e){t[n]=e[n]}return t},isArray:function(){return Object.prototype.toString.call(e)==="[object Array]"}}};(function(){var e=/^\s+/,t=/\s+$/;wysihtml5.lang.string=function(n){n=String(n);return{trim:function(){return n.replace(e,"").replace(t,"")},interpolate:function(e){for(var t in e){n=this.replace("#{"+t+"}").by(e[t])}return n},replace:function(e){return{by:function(t){return n.split(e).join(t)}}}}}})();(function(e){function o(e){if(l(e)){return e}if(e===e.ownerDocument.documentElement){e=e.ownerDocument.body}return c(e)}function u(e){return e.replace(n,function(e,t){var n=(t.match(r)||[])[1]||"",o=s[n];t=t.replace(r,"");if(t.split(o).length>t.split(n).length){t=t+n;n=""}var u=t,a=t;if(t.length>i){a=a.substr(0,i)+"..."}if(u.substr(0,4)==="www."){u="http://"+u}return'<a href="'+u+'">'+a+"</a>"+n})}function a(e){var t=e._wysihtml5_tempElement;if(!t){t=e._wysihtml5_tempElement=e.createElement("div")}return t}function f(e){var t=e.parentNode,n=a(t.ownerDocument);n.innerHTML="<span></span>"+u(e.data);n.removeChild(n.firstChild);while(n.firstChild){t.insertBefore(n.firstChild,e)}t.removeChild(e)}function l(e){var n;while(e.parentNode){e=e.parentNode;n=e.nodeName;if(t.contains(n)){return true}else{if(n==="body"){return false}}}return false}function c(r){if(t.contains(r.nodeName)){return}if(r.nodeType===e.TEXT_NODE&&r.data.match(n)){f(r);return}var i=e.lang.array(r.childNodes).get(),s=i.length,o=0;for(;o<s;o++){c(i[o])}return r}var t=e.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),n=/((https?:\/\/|www\.)[^\s<]{3,})/gi,r=/([^\w\/\-](,?))$/i,i=100,s={")":"(","]":"[","}":"{"};e.dom.autoLink=o;e.dom.autoLink.URL_REG_EXP=n})(wysihtml5);(function(e){var t=e.browser.supportsClassList(),n=e.dom;n.addClass=function(e,r){if(t){return e.classList.add(r)}if(n.hasClass(e,r)){return}e.className+=" "+r};n.removeClass=function(e,n){if(t){return e.classList.remove(n)}e.className=e.className.replace(new RegExp("(^|\\s+)"+n+"(\\s+|$)")," ")};n.hasClass=function(e,n){if(t){return e.classList.contains(n)}var r=e.className;return r.length>0&&(r==n||(new RegExp("(^|\\s)"+n+"(\\s|$)")).test(r))}})(wysihtml5);wysihtml5.dom.contains=function(){var e=document.documentElement;if(e.contains){return function(e,t){if(t.nodeType!==wysihtml5.ELEMENT_NODE){t=t.parentNode}return e!==t&&e.contains(t)}}else{if(e.compareDocumentPosition){return function(e,t){return!!(e.compareDocumentPosition(t)&16)}}}}();wysihtml5.dom.convertToList=function(){function e(e,t){var n=e.createElement("li");t.appendChild(n);return n}function t(e,t){return e.createElement(t)}function n(n,r){if(n.nodeName==="UL"||n.nodeName==="OL"||n.nodeName==="MENU"){return n}var i=n.ownerDocument,s=t(i,r),o=n.querySelectorAll("br"),u=o.length,a,f,l,h,p,v,m,g,y;for(y=0;y<u;y++){h=o[y];while((p=h.parentNode)&&p!==n&&p.lastChild===h){if(wysihtml5.dom.getStyle("display").from(p)==="block"){p.removeChild(h);break}wysihtml5.dom.insert(h).after(h.parentNode)}}a=wysihtml5.lang.array(n.childNodes).get();f=a.length;for(y=0;y<f;y++){g=g||e(i,s);l=a[y];v=wysihtml5.dom.getStyle("display").from(l)==="block";m=l.nodeName==="BR";if(v){g=g.firstChild?e(i,s):g;g.appendChild(l);g=null;continue}if(m){g=g.firstChild?null:g;continue}g.appendChild(l)}n.parentNode.replaceChild(s,n);return s}return n}();wysihtml5.dom.copyAttributes=function(e){return{from:function(t){return{to:function(n){var r,i=0,s=e.length;for(;i<s;i++){r=e[i];if(typeof t[r]!=="undefined"&&t[r]!==""){n[r]=t[r]}}return{andTo:arguments.callee}}}}}};(function(e){var t=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"];var n=function(t){if(r(t)){return parseInt(e.getStyle("width").from(t),10)<t.offsetWidth}return false};var r=function(n){var r=0,i=t.length;for(;r<i;r++){if(e.getStyle(t[r]).from(n)==="border-box"){return t[r]}}};e.copyStyles=function(r){return{from:function(i){if(n(i)){r=wysihtml5.lang.array(r).without(t)}var s="",o=r.length,u=0,a;for(;u<o;u++){a=r[u];s+=a+":"+e.getStyle(a).from(i)+";"}return{to:function(t){e.setStyles(s).on(t);return{andTo:arguments.callee}}}}}}})(wysihtml5.dom);(function(e){e.dom.delegate=function(t,n,r,i){return e.dom.observe(t,r,function(r){var s=r.target,o=e.lang.array(t.querySelectorAll(n));while(s&&s!==t){if(o.contains(s)){i.call(s,r);break}s=s.parentNode}})}})(wysihtml5);wysihtml5.dom.getAsDom=function(){var e=function(e,t){var n=t.createElement("div");n.style.display="none";t.body.appendChild(n);try{n.innerHTML=e}catch(r){}t.body.removeChild(n);return n};var t=function(e){if(e._wysihtml5_supportsHTML5Tags){return}for(var t=0,r=n.length;t<r;t++){e.createElement(n[t])}e._wysihtml5_supportsHTML5Tags=true};var n=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(n,r){r=r||document;var i;if(typeof n==="object"&&n.nodeType){i=r.createElement("div");i.appendChild(n)}else{if(wysihtml5.browser.supportsHTML5Tags(r)){i=r.createElement("div");i.innerHTML=n}else{t(r);i=e(n,r)}}return i}}();wysihtml5.dom.getParentElement=function(){function e(e,t){if(!t||!t.length){return true}if(typeof t==="string"){return e===t}else{return wysihtml5.lang.array(t).contains(e)}}function t(e){return e.nodeType===wysihtml5.ELEMENT_NODE}function n(e,t,n){var r=(e.className||"").match(n)||[];if(!t){return!!r.length}return r[r.length-1]===t}function r(t,n,r){while(r--&&t&&t.nodeName!=="BODY"){if(e(t.nodeName,n)){return t}t=t.parentNode}return null}function i(r,i,s,o,u){while(u--&&r&&r.nodeName!=="BODY"){if(t(r)&&e(r.nodeName,i)&&n(r,s,o)){return r}r=r.parentNode}return null}return function(e,t,n){n=n||50;if(t.className||t.classRegExp){return i(e,t.nodeName,t.className,t.classRegExp,n)}else{return r(e,t.nodeName,n)}}}();wysihtml5.dom.getStyle=function(){function n(e){return e.replace(t,function(e){return e.charAt(1).toUpperCase()})}var e={"float":"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},t=/\-[a-z]/g;return function(t){return{from:function(r){if(r.nodeType!==wysihtml5.ELEMENT_NODE){return}var i=r.ownerDocument,s=e[t]||n(t),o=r.style,u=r.currentStyle,a=o[s];if(a){return a}if(u){try{return u[s]}catch(f){}}var l=i.defaultView||i.parentWindow,h=(t==="height"||t==="width")&&r.nodeName==="TEXTAREA",p,d;if(l.getComputedStyle){if(h){p=o.overflow;o.overflow="hidden"}d=l.getComputedStyle(r,null).getPropertyValue(t);if(h){o.overflow=p||""}return d}}}}}();wysihtml5.dom.hasElementWithTagName=function(){function n(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=t++)}var e={},t=1;return function(t,r){var i=n(t)+":"+r,s=e[i];if(!s){s=e[i]=t.getElementsByTagName(r)}return s.length>0}}();(function(e){function r(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=n++)}var t={},n=1;e.dom.hasElementWithClassName=function(n,i){if(!e.browser.supportsNativeGetElementsByClassName()){return!!n.querySelector("."+i)}var s=r(n)+":"+i,o=t[s];if(!o){o=t[s]=n.getElementsByClassName(i)}return o.length>0}})(wysihtml5);wysihtml5.dom.insert=function(e){return{after:function(t){t.parentNode.insertBefore(e,t.nextSibling)},before:function(t){t.parentNode.insertBefore(e,t)},into:function(t){t.appendChild(e)}}};wysihtml5.dom.insertCSS=function(e){e=e.join("\n");return{into:function(t){var n=t.head||t.getElementsByTagName("head")[0],r=t.createElement("style");r.type="text/css";if(r.styleSheet){r.styleSheet.cssText=e}else{r.appendChild(t.createTextNode(e))}if(n){n.appendChild(r)}}}};wysihtml5.dom.observe=function(e,t,n){t=typeof t==="string"?[t]:t;var r,i,s=0,o=t.length;for(;s<o;s++){i=t[s];if(e.addEventListener){e.addEventListener(i,n,false)}else{r=function(t){if(!("target"in t)){t.target=t.srcElement}t.preventDefault=t.preventDefault||function(){this.returnValue=false};t.stopPropagation=t.stopPropagation||function(){this.cancelBubble=true};n.call(e,t)};e.attachEvent("on"+i,r)}}return{stop:function(){var i,s=0,o=t.length;for(;s<o;s++){i=t[s];if(e.removeEventListener){e.removeEventListener(i,n,false)}else{e.detachEvent("on"+i,r)}}}}};wysihtml5.dom.parse=function(){function s(e,t,n,s){wysihtml5.lang.object(i).merge(r).merge(t).get();n=n||e.ownerDocument||document;var u=n.createDocumentFragment(),a=typeof e==="string",f,l,c;if(a){f=wysihtml5.dom.getAsDom(e,n)}else{f=e}while(f.firstChild){c=f.firstChild;f.removeChild(c);l=o(c,s);if(l){u.appendChild(l)}}f.innerHTML="";f.appendChild(u);return a?wysihtml5.quirks.getCorrectInnerHTML(f):f}function o(n,r){var i=n.nodeType,s=n.childNodes,u=s.length,a,f=e[i],l=0;a=f&&f(n);if(!a){return null}for(l=0;l<u;l++){newChild=o(s[l],r);if(newChild){a.appendChild(newChild)}}if(r&&a.childNodes.length<=1&&a.nodeName.toLowerCase()===t&&!a.attributes.length){return a.firstChild}return a}function u(e){var n,r,s,o=i.tags,u=e.nodeName.toLowerCase(),f=e.scopeName;if(e._wysihtml5){return null}e._wysihtml5=1;if(e.className==="wysihtml5-temp"){return null}if(f&&f!="HTML"){u=f+":"+u}if("outerHTML"in e){if(!wysihtml5.browser.autoClosesUnclosedTags()&&e.nodeName==="P"&&e.outerHTML.slice(-4).toLowerCase()!=="</p>"){u="div"}}if(u in o){n=o[u];if(!n||n.remove){return null}n=typeof n==="string"?{rename_tag:n}:n}else{if(e.firstChild){n={rename_tag:t}}else{return null}}r=e.ownerDocument.createElement(n.rename_tag||u);a(e,r,n);e=null;return r}function a(e,t,r){var s={},o=r.set_class,u=r.add_class,a=r.set_attributes,f=r.check_attributes,c=i.classes,h=0,v=[],m=[],g=[],y=[],b,w,E,S,x,T,N;if(a){s=wysihtml5.lang.object(a).clone()}if(f){for(x in f){N=p[f[x]];if(!N){continue}T=N(l(e,x));if(typeof T==="string"){s[x]=T}}}if(o){v.push(o)}if(u){for(x in u){N=d[u[x]];if(!N){continue}S=N(l(e,x));if(typeof S==="string"){v.push(S)}}}c["_wysihtml5-temp-placeholder"]=1;y=e.getAttribute("class");if(y){v=v.concat(y.split(n))}b=v.length;for(;h<b;h++){E=v[h];if(c[E]){m.push(E)}}w=m.length;while(w--){E=m[w];if(!wysihtml5.lang.array(g).contains(E)){g.unshift(E)}}if(g.length){s["class"]=g.join(" ")}for(x in s){try{t.setAttribute(x,s[x])}catch(C){}}if(s.src){if(typeof s.width!=="undefined"){t.setAttribute("width",s.width)}if(typeof s.height!=="undefined"){t.setAttribute("height",s.height)}}}function l(e,t){t=t.toLowerCase();var n=e.nodeName;if(n=="IMG"&&t=="src"&&c(e)===true){return e.src}else{if(f&&"outerHTML"in e){var r=e.outerHTML.toLowerCase(),i=r.indexOf(" "+t+"=")!=-1;return i?e.getAttribute(t):null}else{return e.getAttribute(t)}}}function c(e){try{return e.complete&&!e.mozMatchesSelector(":-moz-broken")}catch(t){if(e.complete&&e.readyState==="complete"){return true}}}function h(e){return e.ownerDocument.createTextNode(e.data)}var e={1:u,3:h},t="span",n=/\s+/,r={tags:{},classes:{}},i={};var f=!wysihtml5.browser.supportsGetAttributeCorrectly();var p={url:function(){var e=/^https?:\/\//i;return function(t){if(!t||!t.match(e)){return null}return t.replace(e,function(e){return e.toLowerCase()})}}(),alt:function(){var e=/[^ a-z0-9_\-]/gi;return function(t){if(!t){return""}return t.replace(e,"")}}(),numbers:function(){var e=/\D/g;return function(t){t=(t||"").replace(e,"");return t||null}}()};var d={align_img:function(){var e={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(t){return e[String(t).toLowerCase()]}}(),align_text:function(){var e={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(t){return e[String(t).toLowerCase()]}}(),clear_br:function(){var e={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(t){return e[String(t).toLowerCase()]}}(),size_font:function(){var e={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(t){return e[String(t).charAt(0)]}}()};return s}();wysihtml5.dom.removeEmptyTextNodes=function(e){var t,n=wysihtml5.lang.array(e.childNodes).get(),r=n.length,i=0;for(;i<r;i++){t=n[i];if(t.nodeType===wysihtml5.TEXT_NODE&&t.data===""){t.parentNode.removeChild(t)}}};wysihtml5.dom.renameElement=function(e,t){var n=e.ownerDocument.createElement(t),r;while(r=e.firstChild){n.appendChild(r)}wysihtml5.dom.copyAttributes(["align","className"]).from(e).to(n);e.parentNode.replaceChild(n,e);return n};wysihtml5.dom.replaceWithChildNodes=function(e){if(!e.parentNode){return}if(!e.firstChild){e.parentNode.removeChild(e);return}var t=e.ownerDocument.createDocumentFragment();while(e.firstChild){t.appendChild(e.firstChild)}e.parentNode.replaceChild(t,e);e=t=null};(function(e){function t(t){return e.getStyle("display").from(t)==="block"}function n(e){return e.nodeName==="BR"}function r(e){var t=e.ownerDocument.createElement("br");e.appendChild(t)}function i(e){if(e.nodeName!=="MENU"&&e.nodeName!=="UL"&&e.nodeName!=="OL"){return}var i=e.ownerDocument,s=i.createDocumentFragment(),o=e.previousElementSibling||e.previousSibling,u,a,f,l,h;if(o&&!t(o)){r(s)}while(h=e.firstChild){a=h.lastChild;while(u=h.firstChild){f=u===a;l=f&&!t(u)&&!n(u);s.appendChild(u);if(l){r(s)}}h.parentNode.removeChild(h)}e.parentNode.replaceChild(s,e)}e.resolveList=i})(wysihtml5.dom);(function(e){var t=document,n=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],r=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],i=["referrer","write","open","close"];e.dom.Sandbox=Base.extend({constructor:function(t,n){this.callback=t||e.EMPTY_FUNCTION;this.config=e.lang.object({}).merge(n).get();this.iframe=this._createIframe()},insertInto:function(e){if(typeof e==="string"){e=t.getElementById(e)}e.appendChild(this.iframe)},getIframe:function(){return this.iframe},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var e=this.getIframe();e.parentNode.removeChild(e)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var n=this,r=t.createElement("iframe");r.className="wysihtml5-sandbox";e.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(r);if(e.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()){r.src="javascript:'<html></html>'"}r.onload=function(){r.onreadystatechange=r.onload=null;n._onLoadIframe(r)};r.onreadystatechange=function(){if(/loaded|complete/.test(r.readyState)){r.onreadystatechange=r.onload=null;n._onLoadIframe(r)}};return r},_onLoadIframe:function(s){if(!e.dom.contains(t.documentElement,s)){return}var o=this,u=s.contentWindow,a=s.contentWindow.document,l=t.characterSet||t.charset||"utf-8",h=this._getHtml({charset:l,stylesheets:this.config.stylesheets});a.open("text/html","replace");a.write(h);a.close();this.getWindow=function(){return s.contentWindow};this.getDocument=function(){return s.contentWindow.document};u.onerror=function(e,t,n){throw new Error("wysihtml5.Sandbox: "+e,t,n)};if(!e.browser.supportsSandboxedIframes()){var p,v;for(p=0,v=n.length;p<v;p++){this._unset(u,n[p])}for(p=0,v=r.length;p<v;p++){this._unset(u,r[p],e.EMPTY_FUNCTION)}for(p=0,v=i.length;p<v;p++){this._unset(a,i[p])}this._unset(a,"cookie","",true)}this.loaded=true;setTimeout(function(){o.callback(o)},0)},_getHtml:function(t){var n=t.stylesheets,r="",i=0,s;n=typeof n==="string"?[n]:n;if(n){s=n.length;for(;i<s;i++){r+='<link rel="stylesheet" href="'+n[i]+'">'}}t.stylesheets=r;return e.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(t)},_unset:function(t,n,r,i){try{t[n]=r}catch(s){}try{t.__defineGetter__(n,function(){return r})}catch(s){}if(i){try{t.__defineSetter__(n,function(){})}catch(s){}}if(!e.browser.crashesWhenDefineProperty(n)){try{var o={get:function(){return r}};if(i){o.set=function(){}}Object.defineProperty(t,n,o)}catch(s){}}}})})(wysihtml5);(function(){var e={className:"class"};wysihtml5.dom.setAttributes=function(t){return{on:function(n){for(var r in t){n.setAttribute(e[r]||r,t[r])}}}}})();wysihtml5.dom.setStyles=function(e){return{on:function(t){var n=t.style;if(typeof e==="string"){n.cssText+=";"+e;return}for(var r in e){if(r==="float"){n.cssFloat=e[r];n.styleFloat=e[r]}else{n[r]=e[r]}}}}};(function(e){e.simulatePlaceholder=function(t,n,r){var i="placeholder",s=function(){if(n.hasPlaceholderSet()){n.clear()}e.removeClass(n.element,i)},o=function(){if(n.isEmpty()){n.setValue(r);e.addClass(n.element,i)}};t.observe("set_placeholder",o).observe("unset_placeholder",s).observe("focus:composer",s).observe("paste:composer",s).observe("blur:composer",o);o()}})(wysihtml5.dom);(function(e){var t=document.documentElement;if("textContent"in t){e.setTextContent=function(e,t){e.textContent=t};e.getTextContent=function(e){return e.textContent}}else{if("innerText"in t){e.setTextContent=function(e,t){e.innerText=t};e.getTextContent=function(e){return e.innerText}}else{e.setTextContent=function(e,t){e.nodeValue=t};e.getTextContent=function(e){return e.nodeValue}}}})(wysihtml5.dom);wysihtml5.quirks.cleanPastedHTML=function(){function t(t,n,r){n=n||e;r=r||t.ownerDocument||document;var i,s=typeof t==="string",o,u,a,f,l=0;if(s){i=wysihtml5.dom.getAsDom(t,r)}else{i=t}for(f in n){u=i.querySelectorAll(f);o=n[f];a=u.length;for(;l<a;l++){o(u[l])}}u=t=n=null;return s?i.innerHTML:i}var e={"a u":wysihtml5.dom.replaceWithChildNodes};return t}();(function(e){var t=e.dom;e.quirks.ensureProperClearing=function(){var e=function(e){var t=this;setTimeout(function(){var e=t.innerHTML.toLowerCase();if(e=="<p>&nbsp;</p>"||e=="<p>&nbsp;</p><p>&nbsp;</p>"){t.innerHTML=""}},0)};return function(n){t.observe(n.element,["cut","keydown"],e)}}();e.quirks.ensureProperClearingOfLists=function(){var n=["OL","UL","MENU"];var r=function(r,i){if(!i.firstChild||!e.lang.array(n).contains(i.firstChild.nodeName)){return}var s=t.getParentElement(r,{nodeName:n});if(!s){return}var o=s==i.firstChild;if(!o){return}var u=s.childNodes.length<=1;if(!u){return}var a=s.firstChild?s.firstChild.innerHTML==="":true;if(!a){return}s.parentNode.removeChild(s)};return function(n){t.observe(n.element,"keydown",function(t){if(t.keyCode!==e.BACKSPACE_KEY){return}var i=n.selection.getSelectedNode();r(i,n.element)})}}()})(wysihtml5);(function(e){var t="%7E";e.quirks.getCorrectInnerHTML=function(n){var r=n.innerHTML;if(r.indexOf(t)===-1){return r}var i=n.querySelectorAll("[href*='~'], [src*='~']"),s,o,u,a;for(a=0,u=i.length;a<u;a++){s=i[a].href||i[a].src;o=e.lang.string(s).replace("~").by(t);r=e.lang.string(r).replace(o).by(s)}return r}})(wysihtml5);(function(e){var t=e.dom,n=["LI","P","H1","H2","H3","H4","H5","H6"],r=["UL","OL","MENU"];e.quirks.insertLineBreakOnReturn=function(i){function s(n){var r=t.getParentElement(n,{nodeName:["P","DIV"]},2);if(!r){return}var s=document.createTextNode(e.INVISIBLE_SPACE);t.insert(s).before(r);t.replaceWithChildNodes(r);i.selection.selectNode(s)}function o(o){var u=o.keyCode;if(o.shiftKey||u!==e.ENTER_KEY&&u!==e.BACKSPACE_KEY){return}var a=o.target,l=i.selection.getSelectedNode(),p=t.getParentElement(l,{nodeName:n},4);if(p){if(p.nodeName==="LI"&&(u===e.ENTER_KEY||u===e.BACKSPACE_KEY)){setTimeout(function(){var e=i.selection.getSelectedNode(),n,o;if(!e){return}n=t.getParentElement(e,{nodeName:r},2);if(n){return}s(e)},0)}else{if(p.nodeName.match(/H[1-6]/)&&u===e.ENTER_KEY){setTimeout(function(){s(i.selection.getSelectedNode())},0)}}return}if(u===e.ENTER_KEY&&!e.browser.insertsLineBreaksOnReturn()){i.commands.exec("insertLineBreak");o.preventDefault()}}t.observe(i.element.ownerDocument,"keydown",o)}})(wysihtml5);(function(e){var t="wysihtml5-quirks-redraw";e.quirks.redraw=function(n){e.dom.addClass(n,t);e.dom.removeClass(n,t);try{var r=n.ownerDocument;r.execCommand("italic",false,null);r.execCommand("italic",false,null)}catch(i){}}})(wysihtml5);(function(e){function n(e){var t=0;if(e.parentNode){do{t+=e.offsetTop||0;e=e.offsetParent}while(e)}return t}var t=e.dom;e.Selection=Base.extend({constructor:function(e){window.rangy.init();this.editor=e;this.composer=e.composer;this.doc=this.composer.doc},getBookmark:function(){var e=this.getRange();return e&&e.cloneRange()},setBookmark:function(e){if(!e){return}this.setSelection(e)},setBefore:function(e){var t=rangy.createRange(this.doc);t.setStartBefore(e);t.setEndBefore(e);return this.setSelection(t)},setAfter:function(e){var t=rangy.createRange(this.doc);t.setStartAfter(e);t.setEndAfter(e);return this.setSelection(t)},selectNode:function(n){var r=rangy.createRange(this.doc),i=n.nodeType===e.ELEMENT_NODE,s="canHaveHTML"in n?n.canHaveHTML:n.nodeName!=="IMG",o=i?n.innerHTML:n.data,u=o===""||o===e.INVISIBLE_SPACE,a=t.getStyle("display").from(n),f=a==="block"||a==="list-item";if(u&&i&&s){try{n.innerHTML=e.INVISIBLE_SPACE}catch(l){}}if(s){r.selectNodeContents(n)}else{r.selectNode(n)}if(s&&u&&i){r.collapse(f)}else{if(s&&u){r.setStartAfter(n);r.setEndAfter(n)}}this.setSelection(r)},getSelectedNode:function(e){var t,n;if(e&&this.doc.selection&&this.doc.selection.type==="Control"){n=this.doc.selection.createRange();if(n&&n.length){return n.item(0)}}t=this.getSelection(this.doc);if(t.focusNode===t.anchorNode){return t.focusNode}else{n=this.getRange(this.doc);return n?n.commonAncestorContainer:this.doc.body}},executeAndRestore:function(t,n){var r=this.doc.body,i=n&&r.scrollTop,s=n&&r.scrollLeft,o="_wysihtml5-temp-placeholder",u='<span class="'+o+'">'+e.INVISIBLE_SPACE+"</span>",a=this.getRange(this.doc),f;if(!a){t(r,r);return}var l=a.createContextualFragment(u);a.insertNode(l);try{t(a.startContainer,a.endContainer)}catch(c){setTimeout(function(){throw c},0)}caretPlaceholder=this.doc.querySelector("."+o);if(caretPlaceholder){f=rangy.createRange(this.doc);f.selectNode(caretPlaceholder);f.deleteContents();this.setSelection(f)}else{r.focus()}if(n){r.scrollTop=i;r.scrollLeft=s}try{caretPlaceholder.parentNode.removeChild(caretPlaceholder)}catch(h){}},executeAndRestoreSimple:function(e){var t=this.getRange(),n=this.doc.body,r,i,s,o,u;if(!t){e(n,n);return}o=t.getNodes([3]);i=o[0]||t.startContainer;s=o[o.length-1]||t.endContainer;u={collapsed:t.collapsed,startContainer:i,startOffset:i===t.startContainer?t.startOffset:0,endContainer:s,endOffset:s===t.endContainer?t.endOffset:s.length};try{e(t.startContainer,t.endContainer)}catch(a){setTimeout(function(){throw a},0)}r=rangy.createRange(this.doc);try{r.setStart(u.startContainer,u.startOffset)}catch(f){}try{r.setEnd(u.endContainer,u.endOffset)}catch(l){}try{this.setSelection(r)}catch(c){}},insertHTML:function(e){var t=rangy.createRange(this.doc),n=t.createContextualFragment(e),r=n.lastChild;this.insertNode(n);if(r){this.setAfter(r)}},insertNode:function(e){var t=this.getRange();if(t){t.insertNode(e)}},surround:function(e){var t=this.getRange();if(!t){return}try{t.surroundContents(e);this.selectNode(e)}catch(n){e.appendChild(t.extractContents());t.insertNode(e)}},scrollIntoView:function(){var t=this.doc,r=t.documentElement.scrollHeight>t.documentElement.offsetHeight,i=t._wysihtml5ScrollIntoViewElement=t._wysihtml5ScrollIntoViewElement||function(){var n=t.createElement("span");n.innerHTML=e.INVISIBLE_SPACE;return n}(),s;if(r){this.insertNode(i);s=n(i);i.parentNode.removeChild(i);if(s>t.body.scrollTop){t.body.scrollTop=s}}},selectLine:function(){if(e.browser.supportsSelectionModify()){this._selectLine_W3C()}else{if(this.doc.selection){this._selectLine_MSIE()}}},_selectLine_W3C:function(){var e=this.doc.defaultView,t=e.getSelection();t.modify("extend","left","lineboundary");t.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var e=this.doc.selection.createRange(),t=e.boundingTop,n=e.boundingHeight,r=this.doc.body.scrollWidth,i,s,o,u,a;if(!e.moveToPoint){return}if(t===0){o=this.doc.createElement("span");this.insertNode(o);t=o.offsetTop;o.parentNode.removeChild(o)}t+=1;for(u=-10;u<r;u+=2){try{e.moveToPoint(u,t);break}catch(f){}}i=t;s=this.doc.selection.createRange();for(a=r;a>=0;a--){try{s.moveToPoint(a,i);break}catch(l){}}e.setEndPoint("EndToEnd",s);e.select()},getText:function(){var e=this.getSelection();return e?e.toString():""},getNodes:function(e,t){var n=this.getRange();if(n){return n.getNodes([e],t)}else{return[]}},getRange:function(){var e=this.getSelection();return e&&e.rangeCount&&e.getRangeAt(0)},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(e){var t=this.doc.defaultView||this.doc.parentWindow,n=rangy.getSelection(t);return n.setSingleRange(e)}})})(wysihtml5);(function(e,t){function i(e,t,n){if(!e.className){return false}var r=e.className.match(n)||[];return r[r.length-1]===t}function s(e,t,n){if(e.className){o(e,n);e.className+=" "+t}else{e.className=t}}function o(e,t){if(e.className){e.className=e.className.replace(t,"")}}function u(e,t){return e.className.replace(r," ")==t.className.replace(r," ")}function a(e){var t=e.parentNode;while(e.firstChild){t.insertBefore(e.firstChild,e)}t.removeChild(e)}function f(e,t){if(e.attributes.length!=t.attributes.length){return false}for(var n=0,r=e.attributes.length,i,s,o;n<r;++n){i=e.attributes[n];o=i.name;if(o!="class"){s=t.attributes.getNamedItem(o);if(i.specified!=s.specified){return false}if(i.specified&&i.nodeValue!==s.nodeValue){return false}}}return true}function l(e,n){if(t.dom.isCharacterDataNode(e)){if(n==0){return!!e.previousSibling}else{if(n==e.length){return!!e.nextSibling}else{return true}}}return n>0&&n<e.childNodes.length}function c(e,n,r){var i;if(t.dom.isCharacterDataNode(n)){if(r==0){r=t.dom.getNodeIndex(n);n=n.parentNode}else{if(r==n.length){r=t.dom.getNodeIndex(n)+1;n=n.parentNode}else{i=t.dom.splitDataNode(n,r)}}}if(!i){i=n.cloneNode(false);if(i.id){i.removeAttribute("id")}var s;while(s=n.childNodes[r]){i.appendChild(s)}t.dom.insertAfter(i,n)}return n==e?i:c(e,i.parentNode,t.dom.getNodeIndex(i))}function h(t){this.isElementMerge=t.nodeType==e.ELEMENT_NODE;this.firstTextNode=this.isElementMerge?t.lastChild:t;this.textNodes=[this.firstTextNode]}function p(e,t,r,i){this.tagNames=e||[n];this.cssClass=t||"";this.similarClassRegExp=r;this.normalize=i;this.applyToAnyTagName=false}var n="span";var r=/\s+/g;h.prototype={doMerge:function(){var e=[],t,n,r;for(var i=0,s=this.textNodes.length;i<s;++i){t=this.textNodes[i];n=t.parentNode;e[i]=t.data;if(i){n.removeChild(t);if(!n.hasChildNodes()){n.parentNode.removeChild(n)}}}this.firstTextNode.data=r=e.join("");return r},getLength:function(){var e=this.textNodes.length,t=0;while(e--){t+=this.textNodes[e].length}return t},toString:function(){var e=[];for(var t=0,n=this.textNodes.length;t<n;++t){e[t]="'"+this.textNodes[t].data+"'"}return"[Merge("+e.join(",")+")]"}};p.prototype={getAncestorWithClass:function(n){var r;while(n){r=this.cssClass?i(n,this.cssClass,this.similarClassRegExp):true;if(n.nodeType==e.ELEMENT_NODE&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&r){return n}n=n.parentNode}return false},postApply:function(e,t){var n=e[0],r=e[e.length-1];var i=[],s;var o=n,u=r;var a=0,f=r.length;var l,c;for(var p=0,d=e.length;p<d;++p){l=e[p];c=this.getAdjacentMergeableTextNode(l.parentNode,false);if(c){if(!s){s=new h(c);i.push(s)}s.textNodes.push(l);if(l===n){o=s.firstTextNode;a=o.length}if(l===r){u=s.firstTextNode;f=s.getLength()}}else{s=null}}var v=this.getAdjacentMergeableTextNode(r.parentNode,true);if(v){if(!s){s=new h(r);i.push(s)}s.textNodes.push(v)}if(i.length){for(p=0,d=i.length;p<d;++p){i[p].doMerge()}t.setStart(o,a);t.setEnd(u,f)}},getAdjacentMergeableTextNode:function(t,n){var r=t.nodeType==e.TEXT_NODE;var i=r?t.parentNode:t;var s;var o=n?"nextSibling":"previousSibling";if(r){s=t[o];if(s&&s.nodeType==e.TEXT_NODE){return s}}else{s=i[o];if(s&&this.areElementsMergeable(t,s)){return s[n?"firstChild":"lastChild"]}}return null},areElementsMergeable:function(e,n){return t.dom.arrayContains(this.tagNames,(e.tagName||"").toLowerCase())&&t.dom.arrayContains(this.tagNames,(n.tagName||"").toLowerCase())&&u(e,n)&&f(e,n)},createContainer:function(e){var t=e.createElement(this.tagNames[0]);if(this.cssClass){t.className=this.cssClass}return t},applyToTextNode:function(e){var n=e.parentNode;if(n.childNodes.length==1&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())){if(this.cssClass){s(n,this.cssClass,this.similarClassRegExp)}}else{var r=this.createContainer(t.dom.getDocument(e));e.parentNode.insertBefore(r,e);r.appendChild(e)}},isRemovable:function(n){return t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&e.lang.string(n.className).trim()==this.cssClass},undoToTextNode:function(e,t,n){if(!t.containsNode(n)){var r=t.cloneRange();r.selectNode(n);if(r.isPointInRange(t.endContainer,t.endOffset)&&l(t.endContainer,t.endOffset)){c(n,t.endContainer,t.endOffset);t.setEndAfter(n)}if(r.isPointInRange(t.startContainer,t.startOffset)&&l(t.startContainer,t.startOffset)){n=c(n,t.startContainer,t.startOffset)}}if(this.similarClassRegExp){o(n,this.similarClassRegExp)}if(this.isRemovable(n)){a(n)}},applyToRange:function(t){var n=t.getNodes([e.TEXT_NODE]);if(!n.length){try{var r=this.createContainer(t.endContainer.ownerDocument);t.surroundContents(r);this.selectNode(t,r);return}catch(i){}}t.splitBoundaries();n=t.getNodes([e.TEXT_NODE]);if(n.length){var s;for(var o=0,u=n.length;o<u;++o){s=n[o];if(!this.getAncestorWithClass(s)){this.applyToTextNode(s)}}t.setStart(n[0],0);s=n[n.length-1];t.setEnd(s,s.length);if(this.normalize){this.postApply(n,t)}}},undoToRange:function(t){var n=t.getNodes([e.TEXT_NODE]),r,i;if(n.length){t.splitBoundaries();n=t.getNodes([e.TEXT_NODE])}else{var s=t.endContainer.ownerDocument,o=s.createTextNode(e.INVISIBLE_SPACE);t.insertNode(o);t.selectNode(o);n=[o]}for(var u=0,a=n.length;u<a;++u){r=n[u];i=this.getAncestorWithClass(r);if(i){this.undoToTextNode(r,t,i)}}if(a==1){this.selectNode(t,n[0])}else{t.setStart(n[0],0);r=n[n.length-1];t.setEnd(r,r.length);if(this.normalize){this.postApply(n,t)}}},selectNode:function(t,n){var r=n.nodeType===e.ELEMENT_NODE,i="canHaveHTML"in n?n.canHaveHTML:true,s=r?n.innerHTML:n.data,o=s===""||s===e.INVISIBLE_SPACE;if(o&&r&&i){try{n.innerHTML=e.INVISIBLE_SPACE}catch(u){}}t.selectNodeContents(n);if(o&&r){t.collapse(false)}else{if(o){t.setStartAfter(n);t.setEndAfter(n)}}},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var r=n.intersection(t);var i=r?r.toString():"";n.detach();return i},isAppliedToRange:function(t){var n=[],r,i=t.getNodes([e.TEXT_NODE]);if(!i.length){r=this.getAncestorWithClass(t.startContainer);return r?[r]:false}for(var s=0,o=i.length,u;s<o;++s){u=this.getTextSelectedByRange(i[s],t);r=this.getAncestorWithClass(i[s]);if(u!=""&&!r){return false}else{n.push(r)}}return n},toggleRange:function(e){if(this.isAppliedToRange(e)){this.undoToRange(e)}else{this.applyToRange(e)}}};e.selection.HTMLApplier=p})(wysihtml5,rangy);wysihtml5.Commands=Base.extend({constructor:function(e){this.editor=e;this.composer=e.composer;this.doc=this.composer.doc},support:function(e){return wysihtml5.browser.supportsCommand(this.doc,e)},exec:function(e,t){var n=wysihtml5.commands[e],r=wysihtml5.lang.array(arguments).get(),i=n&&n.exec,s=null;this.editor.fire("beforecommand:composer");if(i){r.unshift(this.composer);s=i.apply(n,r)}else{try{s=this.doc.execCommand(e,false,t)}catch(o){}}this.editor.fire("aftercommand:composer");return s},state:function(e,t){var n=wysihtml5.commands[e],r=wysihtml5.lang.array(arguments).get(),i=n&&n.state;if(i){r.unshift(this.composer);return i.apply(n,r)}else{try{return this.doc.queryCommandState(e)}catch(s){return false}}},value:function(e){var t=wysihtml5.commands[e],n=t&&t.value;if(n){return n.call(t,this.composer,e)}else{try{return this.doc.queryCommandValue(e)}catch(r){return null}}}});(function(e){var t;e.commands.bold={exec:function(t,n){return e.commands.formatInline.exec(t,n,"b")},state:function(t,n,r){return e.commands.formatInline.state(t,n,"b")},value:function(){return t}}})(wysihtml5);(function(e){function i(e,t){var n=t.length,i=0,s,o,u;for(;i<n;i++){s=t[i];o=r.getParentElement(s,{nodeName:"code"});u=r.getTextContent(s);if(u.match(r.autoLink.URL_REG_EXP)&&!o){o=r.renameElement(s,"code")}else{r.replaceWithChildNodes(s)}}}function s(i,s){var o=i.doc,u="_wysihtml5-temp-"+ +(new Date),a=/non-matching-class/g,l=0,c,h,p,v,m,y,b,w,E;e.commands.formatInline.exec(i,t,n,u,a);h=o.querySelectorAll(n+"."+u);c=h.length;for(;l<c;l++){p=h[l];p.removeAttribute("class");for(E in s){p.setAttribute(E,s[E])}}y=p;if(c===1){b=r.getTextContent(p);v=!!p.querySelector("*");m=b===""||b===e.INVISIBLE_SPACE;if(!v&&m){r.setTextContent(p,s.text||p.href);w=o.createTextNode(" ");i.selection.setAfter(p);i.selection.insertNode(w);y=w}}i.selection.setAfter(y)}var t,n="A",r=e.dom;e.commands.createLink={exec:function(e,t,n){var r=this.state(e,t);if(r){e.selection.executeAndRestore(function(){i(e,r)})}else{n=typeof n==="object"?n:{href:n};s(e,n)}},state:function(t,n){return e.commands.formatInline.state(t,n,"A")},value:function(){return t}}})(wysihtml5);(function(e){var t,n=/wysiwyg-font-size-[a-z\-]+/g;e.commands.fontSize={exec:function(t,r,i){return e.commands.formatInline.exec(t,r,"span","wysiwyg-font-size-"+i,n)},state:function(t,r,i){return e.commands.formatInline.state(t,r,"span","wysiwyg-font-size-"+i,n)},value:function(){return t}}})(wysihtml5);(function(e){var t,n=/wysiwyg-color-[a-z]+/g;e.commands.foreColor={exec:function(t,r,i){return e.commands.formatInline.exec(t,r,"span","wysiwyg-color-"+i,n)},state:function(t,r,i){return e.commands.formatInline.state(t,r,"span","wysiwyg-color-"+i,n)},value:function(){return t}}})(wysihtml5);(function(e){function s(e,t,n){if(e.className){o(e,n);e.className+=" "+t}else{e.className=t}}function o(e,t){e.className=e.className.replace(t,"")}function u(t){return t.nodeType===e.TEXT_NODE&&!e.lang.string(t.data).trim()}function a(e){var t=e.previousSibling;while(t&&u(t)){t=t.previousSibling}return t}function f(e){var t=e.nextSibling;while(t&&u(t)){t=t.nextSibling}return t}function l(e){var t=e.ownerDocument,n=f(e),r=a(e);if(n&&!d(n)){e.parentNode.insertBefore(t.createElement("br"),n)}if(r&&!d(r)){e.parentNode.insertBefore(t.createElement("br"),e)}}function c(e){var t=f(e),n=a(e);if(t&&p(t)){t.parentNode.removeChild(t)}if(n&&p(n)){n.parentNode.removeChild(n)}}function h(e){var t=e.lastChild;if(t&&p(t)){t.parentNode.removeChild(t)}}function p(e){return e.nodeName==="BR"}function d(e){if(p(e)){return true}if(n.getStyle("display").from(e)==="block"){return true}return false}function v(t,r,i,s){if(s){var o=n.observe(t,"DOMNodeInserted",function(t){var r=t.target,i;if(r.nodeType!==e.ELEMENT_NODE){return}i=n.getStyle("display").from(r);if(i.substr(0,6)!=="inline"){r.className+=" "+s}})}t.execCommand(r,false,i);if(o){o.stop()}}function m(e,t){e.selection.selectLine();e.selection.surround(t);c(t);h(t);e.selection.selectNode(t)}function g(t){return!!e.lang.string(t.className).trim()}var t,n=e.dom,r="DIV",i=["H1","H2","H3","H4","H5","H6","P","BLOCKQUOTE",r];e.commands.formatBlock={exec:function(t,u,a,f,c){var h=t.doc,p=this.state(t,u,a,f,c),d;a=typeof a==="string"?a.toUpperCase():a;if(p){t.selection.executeAndRestoreSimple(function(){if(c){o(p,c)}var e=g(p);if(!e&&p.nodeName===(a||r)){l(p);n.replaceWithChildNodes(p)}else{if(e){n.renameElement(p,r)}}});return}if(a===null||e.lang.array(i).contains(a)){d=t.selection.getSelectedNode();p=n.getParentElement(d,{nodeName:i});if(p){t.selection.executeAndRestoreSimple(function(){if(a){p=n.renameElement(p,a)}if(f){s(p,f,c)}});return}}if(t.commands.support(u)){v(h,u,a||r,f);return}p=h.createElement(a||r);if(f){p.className=f}m(t,p)},state:function(e,t,r,i,s){r=typeof r==="string"?r.toUpperCase():r;var o=e.selection.getSelectedNode();return n.getParentElement(o,{nodeName:r,className:i,classRegExp:s})},value:function(){return t}}})(wysihtml5);(function(e){function i(e){var t=n[e];return t?[e.toLowerCase(),t.toLowerCase()]:[e.toLowerCase()]}function s(t,n,s){var o=t+":"+n;if(!r[o]){r[o]=new e.selection.HTMLApplier(i(t),n,s,true)}return r[o]}var t,n={strong:"b",em:"i",b:"strong",i:"em"},r={};e.commands.formatInline={exec:function(e,t,n,r,i){var o=e.selection.getRange();if(!o){return false}s(n,r,i).toggleRange(o);e.selection.setSelection(o)},state:function(t,r,i,o,u){var a=t.doc,f=n[i]||i,l;if(!e.dom.hasElementWithTagName(a,i)&&!e.dom.hasElementWithTagName(a,f)){return false}if(o&&!e.dom.hasElementWithClassName(a,o)){return false}l=t.selection.getRange();if(!l){return false}return s(i,o,u).isAppliedToRange(l)},value:function(){return t}}})(wysihtml5);(function(e){var t;e.commands.insertHTML={exec:function(e,t,n){if(e.commands.support(t)){e.doc.execCommand(t,false,n)}else{e.selection.insertHTML(n)}},state:function(){return false},value:function(){return t}}})(wysihtml5);(function(e){var t="IMG";e.commands.insertImage={exec:function(n,r,i){i=typeof i==="object"?i:{src:i};var s=n.doc,o=this.state(n),u,a,f;if(o){n.selection.setBefore(o);f=o.parentNode;f.removeChild(o);e.dom.removeEmptyTextNodes(f);if(f.nodeName==="A"&&!f.firstChild){n.selection.setAfter(f);f.parentNode.removeChild(f)}e.quirks.redraw(n.element);return}o=s.createElement(t);for(a in i){o[a]=i[a]}n.selection.insertNode(o);if(e.browser.hasProblemsSettingCaretAfterImg()){u=s.createTextNode(e.INVISIBLE_SPACE);n.selection.insertNode(u);n.selection.setAfter(u)}else{n.selection.setAfter(o)}},state:function(n){var r=n.doc,i,s,o;if(!e.dom.hasElementWithTagName(r,t)){return false}i=n.selection.getSelectedNode();if(!i){return false}if(i.nodeName===t){return i}if(i.nodeType!==e.ELEMENT_NODE){return false}s=n.selection.getText();s=e.lang.string(s).trim();if(s){return false}o=n.selection.getNodes(e.ELEMENT_NODE,function(e){return e.nodeName==="IMG"});if(o.length!==1){return false}return o[0]},value:function(e){var t=this.state(e);return t&&t.src}}})(wysihtml5);(function(e){var t,n="<br>"+(e.browser.needsSpaceAfterLineBreak()?" ":"");e.commands.insertLineBreak={exec:function(t,r){if(t.commands.support(r)){t.doc.execCommand(r,false,null);if(!e.browser.autoScrollsToCaret()){t.selection.scrollIntoView()}}else{t.commands.exec("insertHTML",n)}},state:function(){return false},value:function(){return t}}})(wysihtml5);(function(e){var t;e.commands.insertOrderedList={exec:function(t,n){var r=t.doc,i=t.selection.getSelectedNode(),s=e.dom.getParentElement(i,{nodeName:"OL"}),o=e.dom.getParentElement(i,{nodeName:"UL"}),u="_wysihtml5-temp-"+(new Date).getTime(),a,f;if(t.commands.support(n)){r.execCommand(n,false,null);return}if(s){t.selection.executeAndRestoreSimple(function(){e.dom.resolveList(s)})}else{if(o){t.selection.executeAndRestoreSimple(function(){e.dom.renameElement(o,"ol")})}else{t.commands.exec("formatBlock","div",u);f=r.querySelector("."+u);a=f.innerHTML===""||f.innerHTML===e.INVISIBLE_SPACE;t.selection.executeAndRestoreSimple(function(){s=e.dom.convertToList(f,"ol")});if(a){t.selection.selectNode(s.querySelector("li"))}}}},state:function(t){var n=t.selection.getSelectedNode();return e.dom.getParentElement(n,{nodeName:"OL"})},value:function(){return t}}})(wysihtml5);(function(e){var t;e.commands.insertUnorderedList={exec:function(t,n){var r=t.doc,i=t.selection.getSelectedNode(),s=e.dom.getParentElement(i,{nodeName:"UL"}),o=e.dom.getParentElement(i,{nodeName:"OL"}),u="_wysihtml5-temp-"+(new Date).getTime(),a,f;if(t.commands.support(n)){r.execCommand(n,false,null);return}if(s){t.selection.executeAndRestoreSimple(function(){e.dom.resolveList(s)})}else{if(o){t.selection.executeAndRestoreSimple(function(){e.dom.renameElement(o,"ul")})}else{t.commands.exec("formatBlock","div",u);f=r.querySelector("."+u);a=f.innerHTML===""||f.innerHTML===e.INVISIBLE_SPACE;t.selection.executeAndRestoreSimple(function(){s=e.dom.convertToList(f,"ul")});if(a){t.selection.selectNode(s.querySelector("li"))}}}},state:function(t){var n=t.selection.getSelectedNode();return e.dom.getParentElement(n,{nodeName:"UL"})},value:function(){return t}}})(wysihtml5);(function(e){var t;e.commands.italic={exec:function(t,n){return e.commands.formatInline.exec(t,n,"i")},state:function(t,n,r){return e.commands.formatInline.state(t,n,"i")},value:function(){return t}}})(wysihtml5);(function(e){var t,n="wysiwyg-text-align-center",r=/wysiwyg-text-align-[a-z]+/g;e.commands.justifyCenter={exec:function(t,i){return e.commands.formatBlock.exec(t,"formatBlock",null,n,r)},state:function(t,i){return e.commands.formatBlock.state(t,"formatBlock",null,n,r)},value:function(){return t}}})(wysihtml5);(function(e){var t,n="wysiwyg-text-align-left",r=/wysiwyg-text-align-[a-z]+/g;e.commands.justifyLeft={exec:function(t,i){return e.commands.formatBlock.exec(t,"formatBlock",null,n,r)},state:function(t,i){return e.commands.formatBlock.state(t,"formatBlock",null,n,r)},value:function(){return t}}})(wysihtml5);(function(e){var t,n="wysiwyg-text-align-right",r=/wysiwyg-text-align-[a-z]+/g;e.commands.justifyRight={exec:function(t,i){return e.commands.formatBlock.exec(t,"formatBlock",null,n,r)},state:function(t,i){return e.commands.formatBlock.state(t,"formatBlock",null,n,r)},value:function(){return t}}})(wysihtml5);(function(e){var t;e.commands.underline={exec:function(t,n){return e.commands.formatInline.exec(t,n,"u")},state:function(t,n){return e.commands.formatInline.state(t,n,"u")},value:function(){return t}}})(wysihtml5);(function(e){function f(e){var t;while(t=e.querySelector("._wysihtml5-temp")){t.parentNode.removeChild(t)}}var t=90,n=89,r=8,i=46,s=40,o='<span id="_wysihtml5-undo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",u='<span id="_wysihtml5-redo" class="_wysihtml5-temp">'+e.INVISIBLE_SPACE+"</span>",a=e.dom;e.UndoManager=e.lang.Dispatcher.extend({constructor:function(e){this.editor=e;this.composer=e.composer;this.element=this.composer.element;this.history=[this.composer.getValue()];this.position=1;if(this.composer.commands.support("insertHTML")){this._observe()}},_observe:function(){var s=this,l=this.composer.sandbox.getDocument(),p;a.observe(this.element,"keydown",function(e){if(e.altKey||!e.ctrlKey&&!e.metaKey){return}var r=e.keyCode,i=r===t&&!e.shiftKey,o=r===t&&e.shiftKey||r===n;if(i){s.undo();e.preventDefault()}else{if(o){s.redo();e.preventDefault()}}});a.observe(this.element,"keydown",function(e){var t=e.keyCode;if(t===p){return}p=t;if(t===r||t===i){s.transact()}});if(e.browser.hasUndoInContextMenu()){var v,m,y=function(){f(l);clearInterval(v)};a.observe(this.element,"contextmenu",function(){y();s.composer.selection.executeAndRestoreSimple(function(){if(s.element.lastChild){s.composer.selection.setAfter(s.element.lastChild)}l.execCommand("insertHTML",false,o);l.execCommand("insertHTML",false,u);l.execCommand("undo",false,null)});v=setInterval(function(){if(l.getElementById("_wysihtml5-redo")){y();s.redo()}else{if(!l.getElementById("_wysihtml5-undo")){y();s.undo()}}},400);if(!m){m=true;a.observe(document,"mousedown",y);a.observe(l,["mousedown","paste","cut","copy"],y)}})}this.editor.observe("newword:composer",function(){s.transact()}).observe("beforecommand:composer",function(){s.transact()})},transact:function(){var e=this.history[this.position-1],t=this.composer.getValue();if(t==e){return}var n=this.history.length=this.position;if(n>s){this.history.shift();this.position--}this.position++;this.history.push(t)},undo:function(){this.transact();if(this.position<=1){return}this.set(this.history[--this.position-1]);this.editor.fire("undo:composer")},redo:function(){if(this.position>=this.history.length){return}this.set(this.history[++this.position-1]);this.editor.fire("redo:composer")},set:function(e){this.composer.setValue(e);this.editor.focus(true)}})})(wysihtml5);wysihtml5.views.View=Base.extend({constructor:function(e,t,n){this.parent=e;this.element=t;this.config=n;this._observeViewChange()},_observeViewChange:function(){var e=this;this.parent.observe("beforeload",function(){e.parent.observe("change_view",function(t){if(t===e.name){e.parent.currentView=e;e.show();setTimeout(function(){e.focus()},0)}else{e.hide()}})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")===this.element){return}try{this.element.focus()}catch(e){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}});(function(e){var t=e.dom,n=e.browser;e.views.Composer=e.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,t,n){this.base(e,t,n);this.textarea=this.parent.textarea;this._initSandbox()},clear:function(){this.element.innerHTML=n.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(t){var n=this.isEmpty()?"":e.quirks.getCorrectInnerHTML(this.element);if(t){n=this.parent.parse(n)}n=e.lang.string(n).replace(e.INVISIBLE_SPACE).by("");return n},setValue:function(e,t){if(t){e=this.parent.parse(e)}this.element.innerHTML=e},show:function(){this.iframe.style.display=this._displayStyle||"";this.disable();this.enable()},hide:function(){this._displayStyle=t.getStyle("display").from(this.iframe);if(this._displayStyle==="none"){this._displayStyle=null}this.iframe.style.display="none"},disable:function(){this.element.removeAttribute("contentEditable");this.base()},enable:function(){this.element.setAttribute("contentEditable","true");this.base()},focus:function(t){if(e.browser.doesAsyncFocus()&&this.hasPlaceholderSet()){this.clear()}this.base();var n=this.element.lastChild;if(t&&n){if(n.nodeName==="BR"){this.selection.setBefore(this.element.lastChild)}else{this.selection.setAfter(this.element.lastChild)}}},getTextContent:function(){return t.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==this.textarea.element.getAttribute("placeholder")},isEmpty:function(){var e=this.element.innerHTML,t="blockquote, ul, ol, img, embed, object, table, iframe, svg, video, audio, button, input, select, textarea";return e===""||e===this.CARET_HACK||this.hasPlaceholderSet()||this.getTextContent()===""&&!this.element.querySelector(t)},_initSandbox:function(){var e=this;this.sandbox=new t.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets});this.iframe=this.sandbox.getIframe();var n=document.createElement("input");n.type="hidden";n.name="_wysihtml5_mode";n.value=1;var r=this.textarea.element;t.insert(this.iframe).after(r);t.insert(n).after(r)},_create:function(){var r=this;this.doc=this.sandbox.getDocument();this.element=this.doc.body;this.textarea=this.parent.textarea;this.element.innerHTML=this.textarea.getValue(true);this.enable();this.selection=new e.Selection(this.parent);this.commands=new e.Commands(this.parent);t.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element);t.addClass(this.element,this.config.composerClassName);if(this.config.style){this.style()}this.observe();var i=this.config.name;if(i){t.addClass(this.element,i);t.addClass(this.iframe,i)}var s=typeof this.config.placeholder==="string"?this.config.placeholder:this.textarea.element.getAttribute("placeholder");if(s){t.simulatePlaceholder(this.parent,this,s)}this.commands.exec("styleWithCSS",false);this._initAutoLinking();this._initObjectResizing();this._initUndoManager();if(this.textarea.element.hasAttribute("autofocus")||document.querySelector(":focus")==this.textarea.element){setTimeout(function(){r.focus()},100)}e.quirks.insertLineBreakOnReturn(this);if(!n.clearsContentEditableCorrectly()){e.quirks.ensureProperClearing(this)}if(!n.clearsListsInContentEditableCorrectly()){e.quirks.ensureProperClearingOfLists(this)}if(this.initSync&&this.config.sync){this.initSync()}this.textarea.hide();this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var r=this,i=n.canDisableAutoLinking(),s=n.doesAutoLinkingInContentEditable();if(i){this.commands.exec("autoUrlDetect",false)}if(!this.config.autoLink){return}if(!s||s&&i){this.parent.observe("newword:composer",function(){r.selection.executeAndRestore(function(e,n){t.autoLink(n.parentNode)})})}var o=this.sandbox.getDocument().getElementsByTagName("a"),u=t.autoLink.URL_REG_EXP,a=function(n){var r=e.lang.string(t.getTextContent(n)).trim();if(r.substr(0,4)==="www."){r="http://"+r}return r};t.observe(this.element,"keydown",function(e){if(!o.length){return}var n=r.selection.getSelectedNode(e.target.ownerDocument),i=t.getParentElement(n,{nodeName:"A"},4),s;if(!i){return}s=a(i);setTimeout(function(){var e=a(i);if(e===s){return}if(e.match(u)){i.setAttribute("href",e)}},0)})},_initObjectResizing:function(){var r=["width","height"],i=r.length,s=this.element;this.commands.exec("enableObjectResizing",this.config.allowObjectResizing);if(this.config.allowObjectResizing){if(n.supportsEvent("resizeend")){t.observe(s,"resizeend",function(t){var n=t.target||t.srcElement,o=n.style,u=0,a;for(;u<i;u++){a=r[u];if(o[a]){n.setAttribute(a,parseInt(o[a],10));o[a]=""}}e.quirks.redraw(s)})}}else{if(n.supportsEvent("resizestart")){t.observe(s,"resizestart",function(e){e.preventDefault()})}}},_initUndoManager:function(){new e.UndoManager(this.parent)}})})(wysihtml5);(function(e){var t=e.dom,n=document,r=window,i=n.createElement("div"),s=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],o=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],u=["width","height","top","left","right","bottom"],a=["html             { height: 100%; }","body             { min-height: 100%; padding: 0; margin: 0; margin-top: -1px; padding-top: 1px; }","._wysihtml5-temp { display: none; }",e.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","body[disabled]   { background-color: #eee !important; color: #999 !important; cursor: default !important; }","img:-moz-broken  { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"];var f=function(e){if(e.setActive){try{e.setActive()}catch(i){}}else{var s=e.style,o=n.documentElement.scrollTop||n.body.scrollTop,u=n.documentElement.scrollLeft||n.body.scrollLeft,a={position:s.position,top:s.top,left:s.left,WebkitUserSelect:s.WebkitUserSelect};t.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(e);e.focus();t.setStyles(a).on(e);if(r.scrollTo){r.scrollTo(u,o)}}};e.views.Composer.prototype.style=function(){var l=this,p=n.querySelector(":focus"),v=this.textarea.element,m=v.hasAttribute("placeholder"),y=m&&v.getAttribute("placeholder");this.focusStylesHost=this.focusStylesHost||i.cloneNode(false);this.blurStylesHost=this.blurStylesHost||i.cloneNode(false);if(m){v.removeAttribute("placeholder")}if(v===p){v.blur()}t.copyStyles(o).from(v).to(this.iframe).andTo(this.blurStylesHost);t.copyStyles(s).from(v).to(this.element).andTo(this.blurStylesHost);t.insertCSS(a).into(this.element.ownerDocument);f(v);t.copyStyles(o).from(v).to(this.focusStylesHost);t.copyStyles(s).from(v).to(this.focusStylesHost);var w=e.lang.array(o).without(["display"]);if(p){p.focus()}else{v.blur()}if(m){v.setAttribute("placeholder",y)}if(!e.browser.hasCurrentStyleProperty()){var E=t.observe(r,"resize",function(){if(!t.contains(document.documentElement,l.iframe)){E.stop();return}var e=t.getStyle("display").from(v),n=t.getStyle("display").from(l.iframe);v.style.display="";l.iframe.style.display="none";t.copyStyles(u).from(v).to(l.iframe).andTo(l.focusStylesHost).andTo(l.blurStylesHost);l.iframe.style.display=n;v.style.display=e})}this.parent.observe("focus:composer",function(){t.copyStyles(w).from(l.focusStylesHost).to(l.iframe);t.copyStyles(s).from(l.focusStylesHost).to(l.element)});this.parent.observe("blur:composer",function(){t.copyStyles(w).from(l.blurStylesHost).to(l.iframe);t.copyStyles(s).from(l.blurStylesHost).to(l.element)});return this}})(wysihtml5);(function(e){var t=e.dom,n=e.browser,r={66:"bold",73:"italic",85:"underline"};e.views.Composer.prototype.observe=function(){var i=this,s=this.getValue(),o=this.sandbox.getIframe(),u=this.element,a=n.supportsEventsInIframeCorrectly()?u:this.sandbox.getWindow(),f=n.supportsEvent("drop")?["drop","paste"]:["dragdrop","paste"];t.observe(o,"DOMNodeRemoved",function(){clearInterval(l);i.parent.fire("destroy:composer")});var l=setInterval(function(){if(!t.contains(document.documentElement,o)){clearInterval(l);i.parent.fire("destroy:composer")}},250);t.observe(a,"focus",function(){i.parent.fire("focus").fire("focus:composer");setTimeout(function(){s=i.getValue()},0)});t.observe(a,"blur",function(){if(s!==i.getValue()){i.parent.fire("change").fire("change:composer")}i.parent.fire("blur").fire("blur:composer")});if(e.browser.isIos()){t.observe(u,"blur",function(){var e=u.ownerDocument.createElement("input"),t=document.documentElement.scrollTop||document.body.scrollTop,n=document.documentElement.scrollLeft||document.body.scrollLeft;try{i.selection.insertNode(e)}catch(r){u.appendChild(e)}e.focus();e.parentNode.removeChild(e);window.scrollTo(n,t)})}t.observe(u,"dragenter",function(){i.parent.fire("unset_placeholder")});if(n.firesOnDropOnlyWhenOnDragOverIsCancelled()){t.observe(u,["dragover","dragenter"],function(e){e.preventDefault()})}t.observe(u,f,function(e){var t=e.dataTransfer,r;console.log("PASTED",e);if(t&&n.supportsDataTransfer()){r=t.getData("text/html")||t.getData("text/plain")}if(r){u.focus();i.commands.exec("insertHTML",r);i.parent.fire("paste").fire("paste:composer");e.stopPropagation();e.preventDefault()}else{setTimeout(function(){i.parent.fire("paste").fire("paste:composer")},0)}});t.observe(u,"keyup",function(t){var n=t.keyCode;if(n===e.SPACE_KEY||n===e.ENTER_KEY){i.parent.fire("newword:composer")}});this.parent.observe("paste:composer",function(){setTimeout(function(){i.parent.fire("newword:composer")},0)});if(!n.canSelectImagesInContentEditable()){t.observe(u,"mousedown",function(e){var t=e.target;if(t.nodeName==="IMG"){i.selection.selectNode(t);e.preventDefault()}})}t.observe(u,"keydown",function(e){var t=e.keyCode,n=r[t];if((e.ctrlKey||e.metaKey)&&!e.altKey&&n){i.commands.exec(n);e.preventDefault()}});t.observe(u,"keydown",function(t){var n=i.selection.getSelectedNode(true),r=t.keyCode,s;if(n&&n.nodeName==="IMG"&&(r===e.BACKSPACE_KEY||r===e.DELETE_KEY)){s=n.parentNode;s.removeChild(n);if(s.nodeName==="A"&&!s.firstChild){s.parentNode.removeChild(s)}setTimeout(function(){e.quirks.redraw(u)},0);t.preventDefault()}});var h={IMG:"Image: ",A:"Link: "};t.observe(u,"mouseover",function(e){var t=e.target,n=t.nodeName,r;if(n!=="A"&&n!=="IMG"){return}var i=t.hasAttribute("title");if(!i){r=h[n]+(t.getAttribute("href")||t.getAttribute("src"));t.setAttribute("title",r)}})}})(wysihtml5);(function(e){var t=400;e.views.Synchronizer=Base.extend({constructor:function(e,t,n){this.editor=e;this.textarea=t;this.composer=n;this._observe()},fromComposerToTextarea:function(t){this.textarea.setValue(e.lang.string(this.composer.getValue()).trim(),t)},fromTextareaToComposer:function(e){var t=this.textarea.getValue();if(t){this.composer.setValue(t,e)}else{this.composer.clear();this.editor.fire("set_placeholder")}},sync:function(e){if(this.editor.currentView.name==="textarea"){this.fromTextareaToComposer(e)}else{this.fromComposerToTextarea(e)}},_observe:function(){var n,r=this,i=this.textarea.element.form,s=function(){n=setInterval(function(){r.fromComposerToTextarea()},t)},o=function(){clearInterval(n);n=null};s();if(i){e.dom.observe(i,"submit",function(){r.sync(true)});e.dom.observe(i,"reset",function(){setTimeout(function(){r.fromTextareaToComposer()},0)})}this.editor.observe("change_view",function(e){if(e==="composer"&&!n){r.fromTextareaToComposer(true);s()}else{if(e==="textarea"){r.fromComposerToTextarea(true);o()}}});this.editor.observe("destroy:composer",o)}})})(wysihtml5);wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(e,t,n){this.base(e,t,n);this._observe()},clear:function(){this.element.value=""},getValue:function(e){var t=this.isEmpty()?"":this.element.value;if(e){t=this.parent.parse(t)}return t},setValue:function(e,t){if(t){e=this.parent.parse(e)}this.element.value=e},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),t=this.element.getAttribute("placeholder")||null,n=this.element.value,r=!n;return e&&r||n===t},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var e=this.element,t=this.parent,n={focusin:"focus",focusout:"blur"},r=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];t.observe("beforeload",function(){wysihtml5.dom.observe(e,r,function(e){var r=n[e.type]||e.type;t.fire(r).fire(r+":textarea")});wysihtml5.dom.observe(e,["paste","drop"],function(){setTimeout(function(){t.fire("paste").fire("paste:textarea")},0)})})}});(function(e){var t=e.dom,n="wysihtml5-command-dialog-opened",r="input, select, textarea",i="[data-wysihtml5-dialog-field]",s="data-wysihtml5-dialog-field";e.toolbar.Dialog=e.lang.Dispatcher.extend({constructor:function(e,t){this.link=e;this.container=t},_observe:function(){if(this._observed){return}var i=this,s=function(e){var t=i._serialize();if(t==i.elementToChange){i.fire("edit",t)}else{i.fire("save",t)}i.hide();e.preventDefault();e.stopPropagation()};t.observe(i.link,"click",function(e){if(t.hasClass(i.link,n)){setTimeout(function(){i.hide()},0)}});t.observe(this.container,"keydown",function(t){var n=t.keyCode;if(n===e.ENTER_KEY){s(t)}if(n===e.ESCAPE_KEY){i.hide()}});t.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",s);t.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){i.fire("cancel");i.hide();e.preventDefault();e.stopPropagation()});var o=this.container.querySelectorAll(r),u=0,a=o.length,l=function(){clearInterval(i.interval)};for(;u<a;u++){t.observe(o[u],"change",l)}this._observed=true},_serialize:function(){var e=this.elementToChange||{},t=this.container.querySelectorAll(i),n=t.length,r=0;for(;r<n;r++){e[t[r].getAttribute(s)]=t[r].value}return e},_interpolate:function(e){var t,n,r,o=document.querySelector(":focus"),u=this.container.querySelectorAll(i),a=u.length,f=0;for(;f<a;f++){t=u[f];if(t===o){continue}if(e&&t.type==="hidden"){continue}n=t.getAttribute(s);r=this.elementToChange?this.elementToChange[n]||"":t.defaultValue;t.value=r}},show:function(e){var i=this,s=this.container.querySelector(r);this.elementToChange=e;this._observe();this._interpolate();if(e){this.interval=setInterval(function(){i._interpolate(true)},500)}t.addClass(this.link,n);this.container.style.display="";this.fire("show");if(s&&!e){try{s.focus()}catch(o){}}},hide:function(){clearInterval(this.interval);this.elementToChange=null;t.removeClass(this.link,n);this.container.style.display="none";this.fire("hide")}})})(wysihtml5);(function(e){var t=e.dom;var n={position:"relative"};var r={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1};var i={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"};var s={"x-webkit-speech":"",speech:""};e.toolbar.Speech=function(o,u){var a=document.createElement("input");if(!e.browser.supportsSpeechApiOn(a)){u.style.display="none";return}var l=document.createElement("div");e.lang.object(r).merge({width:u.offsetWidth+"px",height:u.offsetHeight+"px"});t.insert(a).into(l);t.insert(l).into(u);t.setStyles(i).on(a);t.setAttributes(s).on(a);t.setStyles(r).on(l);t.setStyles(n).on(u);var h="onwebkitspeechchange"in a?"webkitspeechchange":"speechchange";t.observe(a,h,function(){o.execCommand("insertText",a.value);a.value=""});t.observe(a,"click",function(e){if(t.hasClass(u,"wysihtml5-command-disabled")){e.preventDefault()}e.stopPropagation()})}})(wysihtml5);(function(e){var t="wysihtml5-command-disabled",n="wysihtml5-commands-disabled",r="wysihtml5-command-active",i="wysihtml5-action-active",s=e.dom;e.toolbar.Toolbar=Base.extend({constructor:function(t,n){this.editor=t;this.container=typeof n==="string"?document.getElementById(n):n;this.composer=t.composer;this._getLinks("command");this._getLinks("action");this._observe();this.show();var r=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),i=r.length,s=0;for(;s<i;s++){new e.toolbar.Speech(this,r[s])}},_getLinks:function(t){var n=this[t+"Links"]=e.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+t+"]")).get(),r=n.length,i=0,s=this[t+"Mapping"]={},o,u,a,f,l;for(;i<r;i++){o=n[i];a=o.getAttribute("data-wysihtml5-"+t);f=o.getAttribute("data-wysihtml5-"+t+"-value");u=this.container.querySelector("[data-wysihtml5-"+t+"-group='"+a+"']");l=this._getDialog(o,a);s[a+":"+f]={link:o,group:u,name:a,value:f,dialog:l,state:false}}},_getDialog:function(t,n){var r=this,i=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']"),s,o;if(i){s=new e.toolbar.Dialog(t,i);s.observe("show",function(){o=r.composer.selection.getBookmark();r.editor.fire("show:dialog",{command:n,dialogContainer:i,commandLink:t})});s.observe("save",function(e){if(o){r.composer.selection.setBookmark(o)}r._execCommand(n,e);r.editor.fire("save:dialog",{command:n,dialogContainer:i,commandLink:t})});s.observe("cancel",function(){r.editor.focus(false);r.editor.fire("cancel:dialog",{command:n,dialogContainer:i,commandLink:t})})}return s},execCommand:function(e,t){if(this.commandsDisabled){return}var n=this.commandMapping[e+":"+t];if(n&&n.dialog&&!n.state){n.dialog.show()}else{this._execCommand(e,t)}},_execCommand:function(e,t){this.editor.focus(false);this.composer.commands.exec(e,t);this._updateLinkStates()},execAction:function(e){var t=this.editor;switch(e){case"change_view":if(t.currentView===t.textarea){t.fire("change_view","composer")}else{t.fire("change_view","textarea")}break}},_observe:function(){var e=this,t=this.editor,r=this.container,i=this.commandLinks.concat(this.actionLinks),o=i.length,u=0;for(;u<o;u++){s.setAttributes({href:"javascript:;",unselectable:"on"}).on(i[u])}s.delegate(r,"[data-wysihtml5-command]","mousedown",function(e){e.preventDefault()});s.delegate(r,"[data-wysihtml5-command]","click",function(t){var n=this,r=n.getAttribute("data-wysihtml5-command"),i=n.getAttribute("data-wysihtml5-command-value");e.execCommand(r,i);t.preventDefault()});s.delegate(r,"[data-wysihtml5-action]","click",function(t){var n=this.getAttribute("data-wysihtml5-action");e.execAction(n);t.preventDefault()});t.observe("focus:composer",function(){e.bookmark=null;clearInterval(e.interval);e.interval=setInterval(function(){e._updateLinkStates()},500)});t.observe("blur:composer",function(){clearInterval(e.interval)});t.observe("destroy:composer",function(){clearInterval(e.interval)});t.observe("change_view",function(t){setTimeout(function(){e.commandsDisabled=t!=="composer";e._updateLinkStates();if(e.commandsDisabled){s.addClass(r,n)}else{s.removeClass(r,n)}},0)})},_updateLinkStates:function(){var n=this.composer.element,o=this.commandMapping,u=this.actionMapping,a,l,c,h;for(a in o){h=o[a];if(this.commandsDisabled){l=false;s.removeClass(h.link,r);if(h.group){s.removeClass(h.group,r)}if(h.dialog){h.dialog.hide()}}else{l=this.composer.commands.state(h.name,h.value);if(e.lang.object(l).isArray()){l=l.length===1?l[0]:true}s.removeClass(h.link,t);if(h.group){s.removeClass(h.group,t)}}if(h.state===l){continue}h.state=l;if(l){s.addClass(h.link,r);if(h.group){s.addClass(h.group,r)}if(h.dialog){if(typeof l==="object"){h.dialog.show(l)}else{h.dialog.hide()}}}else{s.removeClass(h.link,r);if(h.group){s.removeClass(h.group,r)}if(h.dialog){h.dialog.hide()}}}for(a in u){c=u[a];if(c.name==="change_view"){c.state=this.editor.currentView===this.editor.textarea;if(c.state){s.addClass(c.link,i)}else{s.removeClass(c.link,i)}}}},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})})(wysihtml5);(function(e){var t;var n={name:t,style:true,toolbar:t,autoLink:true,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:e.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",stylesheets:[],placeholderText:t,allowObjectResizing:true,supportTouchDevices:true};e.Editor=e.lang.Dispatcher.extend({constructor:function(t,r){this.textareaElement=typeof t==="string"?document.getElementById(t):t;this.config=e.lang.object({}).merge(n).merge(r).get();this.textarea=new e.views.Textarea(this,this.textareaElement,this.config);this.currentView=this.textarea;this._isCompatible=e.browser.supported();if(!this._isCompatible||!this.config.supportTouchDevices&&e.browser.isTouchDevice()){var i=this;setTimeout(function(){i.fire("beforeload").fire("load")},0);return}e.dom.addClass(document.body,this.config.bodyClassName);this.composer=new e.views.Composer(this,this.textareaElement,this.config);this.currentView=this.composer;if(typeof this.config.parser==="function"){this._initParser()}this.observe("beforeload",function(){this.synchronizer=new e.views.Synchronizer(this,this.textarea,this.composer);if(this.config.toolbar){this.toolbar=new e.toolbar.Toolbar(this,this.config.toolbar)}});try{console.log("Heya! This page is using wysihtml5 for rich text editing. Check out https://github.com/xing/wysihtml5")}catch(s){}},isCompatible:function(){return this._isCompatible},clear:function(){this.currentView.clear();return this},getValue:function(e){return this.currentView.getValue(e)},setValue:function(e,t){if(!e){return this.clear()}this.currentView.setValue(e,t);return this},focus:function(e){this.currentView.focus(e);return this},disable:function(){this.currentView.disable();return this},enable:function(){this.currentView.enable();return this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(t){var n=this.config.parser(t,this.config.parserRules,this.composer.sandbox.getDocument(),true);if(typeof t==="object"){e.quirks.redraw(t)}return n},_initParser:function(){this.observe("paste:composer",function(){var t=true,n=this;n.composer.selection.executeAndRestore(function(){e.quirks.cleanPastedHTML(n.composer.element);n.parse(n.composer.element)},t)});this.observe("paste:textarea",function(){var e=this.textarea.getValue(),t;t=this.parse(e);this.textarea.setValue(t)})}})})(wysihtml5);!function(e,t){var n={"font-styles":function(e,t){var n=t&&t.size?" btn-"+t.size:"";return"<li class='dropdown'><a class='btn dropdown-toggle"+n+"' data-toggle='dropdown' href='#'><i class='icon-font'></i>&nbsp;<span class='current-font'>"+e.font_styles.normal+"</span>&nbsp;<b class='caret'></b></a><ul class='dropdown-menu'><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='div'>"+e.font_styles.normal+"</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h1'>"+e.font_styles.h1+"</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h2'>"+e.font_styles.h2+"</a></li><li><a data-wysihtml5-command='formatBlock' data-wysihtml5-command-value='h3'>"+e.font_styles.h3+"</a></li></ul></li>"},emphasis:function(e,t){var n=t&&t.size?" btn-"+t.size:"";return"<li><div class='btn-group'><a class='btn"+n+"' data-wysihtml5-command='bold' title='CTRL+B'>"+e.emphasis.bold+"</a><a class='btn"+n+"' data-wysihtml5-command='italic' title='CTRL+I'>"+e.emphasis.italic+"</a><a class='btn"+n+"' data-wysihtml5-command='underline' title='CTRL+U'>"+e.emphasis.underline+"</a></div></li>"},lists:function(e,t){var n=t&&t.size?" btn-"+t.size:"";return"<li><div class='btn-group'><a class='btn"+n+"' data-wysihtml5-command='insertUnorderedList' title='"+e.lists.unordered+"'><i class='icon-list'></i></a><a class='btn"+n+"' data-wysihtml5-command='insertOrderedList' title='"+e.lists.ordered+"'><i class='icon-th-list'></i></a><a class='btn"+n+"' data-wysihtml5-command='Outdent' title='"+e.lists.outdent+"'><i class='icon-indent-right'></i></a><a class='btn"+n+"' data-wysihtml5-command='Indent' title='"+e.lists.indent+"'><i class='icon-indent-left'></i></a></div></li>"},link:function(e,t){var n=t&&t.size?" btn-"+t.size:"";return"<li><div class='bootstrap-wysihtml5-insert-link-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>"+e.link.insert+"</h3></div><div class='modal-body'><input value='http://' class='bootstrap-wysihtml5-insert-link-url input-xlarge'></div><div class='modal-footer'><a href='#' class='btn' data-dismiss='modal'>"+e.link.cancel+"</a><a href='#' class='btn btn-primary' data-dismiss='modal'>"+e.link.insert+"</a></div></div><a class='btn"+n+"' data-wysihtml5-command='createLink' title='"+e.link.insert+"'><i class='icon-share'></i></a></li>"},image:function(e,t){var n=t&&t.size?" btn-"+t.size:"";return"<li><div class='bootstrap-wysihtml5-insert-image-modal modal hide fade'><div class='modal-header'><a class='close' data-dismiss='modal'>&times;</a><h3>"+e.image.insert+"</h3></div><div class='modal-body'><input value='http://' class='bootstrap-wysihtml5-insert-image-url input-xlarge'></div><div class='modal-footer'><a href='#' class='btn' data-dismiss='modal'>"+e.image.cancel+"</a><a href='#' class='btn btn-primary' data-dismiss='modal'>"+e.image.insert+"</a></div></div><a class='btn"+n+"' data-wysihtml5-command='insertImage' title='"+e.image.insert+"'><i class='icon-picture'></i></a></li>"},html:function(e,t){var n=t&&t.size?" btn-"+t.size:"";return"<li><div class='btn-group'><a class='btn"+n+"' data-wysihtml5-action='change_view' title='"+e.html.edit+"'><i class='icon-pencil'></i></a></div></li>"},color:function(e,t){var n=t&&t.size?" btn-"+t.size:"";return"<li class='dropdown'><a class='btn dropdown-toggle"+n+"' data-toggle='dropdown' href='#'><span class='current-color'>"+e.colours.black+"</span>&nbsp;<b class='caret'></b></a><ul class='dropdown-menu'><li><div class='wysihtml5-colors' data-wysihtml5-command-value='black'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='black'>"+e.colours.black+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='silver'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='silver'>"+e.colours.silver+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='gray'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='gray'>"+e.colours.gray+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='maroon'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='maroon'>"+e.colours.maroon+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='red'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='red'>"+e.colours.red+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='purple'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='purple'>"+e.colours.purple+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='green'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='green'>"+e.colours.green+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='olive'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='olive'>"+e.colours.olive+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='navy'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='navy'>"+e.colours.navy+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='blue'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='blue'>"+e.colours.blue+"</a></li><li><div class='wysihtml5-colors' data-wysihtml5-command-value='orange'></div><a class='wysihtml5-colors-title' data-wysihtml5-command='foreColor' data-wysihtml5-command-value='orange'>"+e.colours.orange+"</a></li></ul></li>"}};var r=function(e,t,r){return n[e](t,r)};var i=function(t,r){this.el=t;var i=r||o;for(var s in i.customTemplates){n[s]=i.customTemplates[s]}this.toolbar=this.createToolbar(t,i);this.editor=this.createEditor(r);window.editor=this.editor;e("iframe.wysihtml5-sandbox").each(function(t,n){e(n.contentWindow).off("focus.wysihtml5").on({"focus.wysihtml5":function(){e("li.dropdown").removeClass("open")}})})};i.prototype={constructor:i,createEditor:function(e){e=e||{};e.toolbar=this.toolbar[0];var n=new t.Editor(this.el[0],e);if(e&&e.events){for(var r in e.events){n.on(r,e.events[r])}}return n},createToolbar:function(t,n){var i=this;var s=e("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"});var a=n.locale||o.locale||"en";for(var l in o){var h=false;if(n[l]!==undefined){if(n[l]===true){h=true}}else{h=o[l]}if(h===true){s.append(r(l,u[a],n));if(l==="html"){this.initHtml(s)}if(l==="link"){this.initInsertLink(s)}if(l==="image"){this.initInsertImage(s)}}}if(n.toolbar){for(l in n.toolbar){s.append(n.toolbar[l])}}s.find("a[data-wysihtml5-command='formatBlock']").click(function(t){var n=t.target||t.srcElement;var r=e(n);i.toolbar.find(".current-font").text(r.html())});s.find("a[data-wysihtml5-command='foreColor']").click(function(t){var n=t.target||t.srcElement;var r=e(n);i.toolbar.find(".current-color").text(r.html())});this.el.before(s);return s},initHtml:function(e){var t="a[data-wysihtml5-action='change_view']";e.find(t).click(function(n){e.find("a.btn").not(t).toggleClass("disabled")})},initInsertImage:function(t){var n=this;var r=t.find(".bootstrap-wysihtml5-insert-image-modal");var i=r.find(".bootstrap-wysihtml5-insert-image-url");var s=r.find("a.btn-primary");var o=i.val();var u;var a=function(){var e=i.val();i.val(o);n.editor.currentView.element.focus();if(u){n.editor.composer.selection.setBookmark(u);u=null}n.editor.composer.commands.exec("insertImage",e)};i.keypress(function(e){if(e.which==13){a();r.modal("hide")}});s.click(a);r.on("shown",function(){i.focus()});r.on("hide",function(){n.editor.currentView.element.focus()});t.find("a[data-wysihtml5-command=insertImage]").click(function(){var t=e(this).hasClass("wysihtml5-command-active");if(!t){n.editor.currentView.element.focus(false);u=n.editor.composer.selection.getBookmark();r.modal("show");r.on("click.dismiss.modal",'[data-dismiss="modal"]',function(e){e.stopPropagation()});return false}else{return true}})},initInsertLink:function(t){var n=this;var r=t.find(".bootstrap-wysihtml5-insert-link-modal");var i=r.find(".bootstrap-wysihtml5-insert-link-url");var s=r.find("a.btn-primary");var o=i.val();var u;var a=function(){var e=i.val();i.val(o);n.editor.currentView.element.focus();if(u){n.editor.composer.selection.setBookmark(u);u=null}n.editor.composer.commands.exec("createLink",{href:e,target:"_blank",rel:"nofollow"})};var f=false;i.keypress(function(e){if(e.which==13){a();r.modal("hide")}});s.click(a);r.on("shown",function(){i.focus()});r.on("hide",function(){n.editor.currentView.element.focus()});t.find("a[data-wysihtml5-command=createLink]").click(function(){var t=e(this).hasClass("wysihtml5-command-active");if(!t){n.editor.currentView.element.focus(false);u=n.editor.composer.selection.getBookmark();r.appendTo("body").modal("show");r.on("click.dismiss.modal",'[data-dismiss="modal"]',function(e){e.stopPropagation()});return false}else{return true}})}};var s={resetDefaults:function(){e.fn.wysihtml5.defaultOptions=e.extend(true,{},e.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(t){return this.each(function(){var n=e(this);n.data("wysihtml5",new i(n,t))})},shallowExtend:function(t){var n=e.extend({},e.fn.wysihtml5.defaultOptions,t||{});var r=this;return s.bypassDefaults.apply(r,[n])},deepExtend:function(t){var n=e.extend(true,{},e.fn.wysihtml5.defaultOptions,t||{});var r=this;return s.bypassDefaults.apply(r,[n])},init:function(e){var t=this;return s.shallowExtend.apply(t,[e])}};e.fn.wysihtml5=function(t){if(s[t]){return s[t].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof t==="object"||!t){return s.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.wysihtml5")}}};e.fn.wysihtml5.Constructor=i;var o=e.fn.wysihtml5.defaultOptions={"font-styles":true,color:false,emphasis:true,lists:true,html:false,link:true,image:true,events:{},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{set_attributes:{target:"_blank",rel:"nofollow"},check_attributes:{href:"url"}},span:1,div:1}},stylesheets:["./lib/css/wysiwyg-color.css"],locale:"en"};if(typeof e.fn.wysihtml5.defaultOptionsCache==="undefined"){e.fn.wysihtml5.defaultOptionsCache=e.extend(true,{},e.fn.wysihtml5.defaultOptions)}var u=e.fn.wysihtml5.locale={en:{font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}}}(window.jQuery,window.wysihtml5);(function(e){var t=function(t,n){this.options=e.extend({},e.fn.editableform.defaults,n);this.$div=e(t);if(!this.options.scope){this.options.scope=this}};t.prototype={constructor:t,initInput:function(){this.input=this.options.input;this.value=this.input.str2value(this.options.value)},initTemplate:function(){this.$form=e(e.fn.editableform.template)},initButtons:function(){var t=this.$form.find(".editable-buttons");t.append(e.fn.editableform.buttons);if(this.options.showbuttons==="bottom"){t.addClass("editable-buttons-bottom")}},render:function(){this.$loading=e(e.fn.editableform.loading);this.$div.empty().append(this.$loading);this.initTemplate();if(this.options.showbuttons){this.initButtons()}else{this.$form.find(".editable-buttons").remove()}this.showLoading();this.isSaving=false;this.$div.triggerHandler("rendering");this.initInput();this.input.prerender();this.$form.find("div.editable-input").append(this.input.$tpl);this.$div.append(this.$form);e.when(this.input.render()).then(e.proxy(function(){if(!this.options.showbuttons){this.input.autosubmit()}this.$form.find(".editable-cancel").click(e.proxy(this.cancel,this));if(this.input.error){this.error(this.input.error);this.$form.find(".editable-submit").attr("disabled",true);this.input.$input.attr("disabled",true);this.$form.submit(function(e){e.preventDefault()})}else{this.error(false);this.input.$input.removeAttr("disabled");this.$form.find(".editable-submit").removeAttr("disabled");this.input.value2input(this.value);this.$form.submit(e.proxy(this.submit,this))}this.$div.triggerHandler("rendered");this.showForm();if(this.input.postrender){this.input.postrender()}},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var e,t;if(this.$form){e=this.$form.outerWidth();t=this.$form.outerHeight();if(e){this.$loading.width(e)}if(t){this.$loading.height(t)}this.$form.hide()}else{e=this.$loading.parent().width();if(e){this.$loading.width(e)}}this.$loading.show()},showForm:function(e){this.$loading.hide();this.$form.show();if(e!==false){this.input.activate()}this.$div.triggerHandler("show")},error:function(t){var n=this.$form.find(".control-group"),r=this.$form.find(".editable-error-block"),i;if(t===false){n.removeClass(e.fn.editableform.errorGroupClass);r.removeClass(e.fn.editableform.errorBlockClass).empty().hide()}else{if(t){i=t.split("\n");for(var s=0;s<i.length;s++){i[s]=e("<div>").text(i[s]).html()}t=i.join("<br>")}n.addClass(e.fn.editableform.errorGroupClass);r.addClass(e.fn.editableform.errorBlockClass).html(t).show()}},submit:function(t){t.stopPropagation();t.preventDefault();var n,r=this.input.input2value();if(n=this.validate(r)){this.error(n);this.showForm();return}if(!this.options.savenochange&&this.input.value2str(r)==this.input.value2str(this.value)){this.$div.triggerHandler("nochange");return}var i=this.input.value2submit(r);this.isSaving=true;e.when(this.save(i)).done(e.proxy(function(e){this.isSaving=false;var t=typeof this.options.success==="function"?this.options.success.call(this.options.scope,e,r):null;if(t===false){this.error(false);this.showForm(false);return}if(typeof t==="string"){this.error(t);this.showForm();return}if(t&&typeof t==="object"&&t.hasOwnProperty("newValue")){r=t.newValue}this.error(false);this.value=r;this.$div.triggerHandler("save",{newValue:r,submitValue:i,response:e})},this)).fail(e.proxy(function(e){this.isSaving=false;var t;if(typeof this.options.error==="function"){t=this.options.error.call(this.options.scope,e,r)}else{t=typeof e==="string"?e:e.responseText||e.statusText||"Unknown error!"}this.error(t);this.showForm()},this))},save:function(t){this.options.pk=e.fn.editableutils.tryParseJson(this.options.pk,true);var n=typeof this.options.pk==="function"?this.options.pk.call(this.options.scope):this.options.pk,r=!!(typeof this.options.url==="function"||this.options.url&&(this.options.send==="always"||this.options.send==="auto"&&n!==null&&n!==undefined)),i;if(r){this.showLoading();i={name:this.options.name||"",value:t,pk:n};if(typeof this.options.params==="function"){i=this.options.params.call(this.options.scope,i)}else{this.options.params=e.fn.editableutils.tryParseJson(this.options.params,true);e.extend(i,this.options.params)}if(typeof this.options.url==="function"){return this.options.url.call(this.options.scope,i)}else{return e.ajax(e.extend({url:this.options.url,data:i,type:"POST"},this.options.ajaxOptions))}}},validate:function(e){if(e===undefined){e=this.value}if(typeof this.options.validate==="function"){return this.options.validate.call(this.options.scope,e)}},option:function(e,t){if(e in this.options){this.options[e]=t}if(e==="value"){this.setValue(t)}},setValue:function(e,t){if(t){this.value=this.input.str2value(e)}else{this.value=e}if(this.$form&&this.$form.is(":visible")){this.input.value2input(this.value)}}};e.fn.editableform=function(n){var r=arguments;return this.each(function(){var i=e(this),s=i.data("editableform"),o=typeof n==="object"&&n;if(!s){i.data("editableform",s=new t(this,o))}if(typeof n==="string"){s[n].apply(s,Array.prototype.slice.call(r,1))}})};e.fn.editableform.Constructor=t;e.fn.editableform.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:true,scope:null,savenochange:false};e.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"></div><div class="editable-buttons"></div></div><div class="editable-error-block"></div></div></form>';e.fn.editableform.loading='<div class="editableform-loading"></div>';e.fn.editableform.buttons='<button type="submit" class="editable-submit">ok</button><button type="button" class="editable-cancel">cancel</button>';e.fn.editableform.errorGroupClass=null;e.fn.editableform.errorBlockClass="editable-error"})(window.jQuery);(function(e){e.fn.editableutils={inherit:function(e,t){var n=function(){};n.prototype=t.prototype;e.prototype=new n;e.prototype.constructor=e;e.superclass=t.prototype},setCursorPosition:function(e,t){if(e.setSelectionRange){e.setSelectionRange(t,t)}else{if(e.createTextRange){var n=e.createTextRange();n.collapse(true);n.moveEnd("character",t);n.moveStart("character",t);n.select()}}},tryParseJson:function(e,t){if(typeof e==="string"&&e.length&&e.match(/^[\{\[].*[\}\]]$/)){if(t){try{e=(new Function("return "+e))()}catch(n){}finally{return e}}else{e=(new Function("return "+e))()}}return e},sliceObj:function(t,n,r){var i,s,o={};if(!e.isArray(n)||!n.length){return o}for(var u=0;u<n.length;u++){i=n[u];if(t.hasOwnProperty(i)){o[i]=t[i]}if(r===true){continue}s=i.toLowerCase();if(t.hasOwnProperty(s)){o[i]=t[s]}}return o},getConfigData:function(t){var n={};e.each(t.data(),function(e,t){if(typeof t!=="object"||t&&typeof t==="object"&&(t.constructor===Object||t.constructor===Array)){n[e]=t}});return n},objectKeys:function(e){if(Object.keys){return Object.keys(e)}else{if(e!==Object(e)){throw new TypeError("Object.keys called on a non-object")}var t=[],n;for(n in e){if(Object.prototype.hasOwnProperty.call(e,n)){t.push(n)}}return t}},escape:function(t){return e("<div>").text(t).html()},itemsByValue:function(t,n,r){if(!n||t===null){return[]}r=r||"value";var i=e.isArray(t),s=[],o=this;e.each(n,function(n,u){if(u.children){s=s.concat(o.itemsByValue(t,u.children,r))}else{if(i){if(e.grep(t,function(e){return e==(u&&typeof u==="object"?u[r]:u)}).length){s.push(u)}}else{if(t==(u&&typeof u==="object"?u[r]:u)){s.push(u)}}}});return s},createInput:function(t){var n,r,i,s=t.type;if(s==="date"){if(t.mode==="inline"){if(e.fn.editabletypes.datefield){s="datefield"}else{if(e.fn.editabletypes.dateuifield){s="dateuifield"}}}else{if(e.fn.editabletypes.date){s="date"}else{if(e.fn.editabletypes.dateui){s="dateui"}}}if(s==="date"&&!e.fn.editabletypes.date){s="combodate"}}if(s==="datetime"&&t.mode==="inline"){s="datetimefield"}if(s==="wysihtml5"&&!e.fn.editabletypes[s]){s="textarea"}if(typeof e.fn.editabletypes[s]==="function"){n=e.fn.editabletypes[s];r=this.sliceObj(t,this.objectKeys(n.defaults));i=new n(r);return i}else{e.error("Unknown type: "+s);return false}},supportsTransitions:function(){var e=document.body||document.documentElement,t=e.style,n="transition",r=["Moz","Webkit","Khtml","O","ms"];if(typeof t[n]==="string"){return true}n=n.charAt(0).toUpperCase()+n.substr(1);for(var i=0;i<r.length;i++){if(typeof t[r[i]+n]==="string"){return true}}return false}}})(window.jQuery);(function(e){var t=function(e,t){this.init(e,t)};var n=function(e,t){this.init(e,t)};t.prototype={containerName:null,innerCss:null,containerClass:"editable-container editable-popup",init:function(n,r){this.$element=e(n);this.options=e.extend({},e.fn.editableContainer.defaults,r);this.splitOptions();this.formOptions.scope=this.$element[0];this.initContainer();this.delayedHide=false;this.$element.on("destroyed",e.proxy(function(){this.destroy()},this));if(!e(document).data("editable-handlers-attached")){e(document).on("keyup.editable",function(t){if(t.which===27){e(".editable-open").editableContainer("hide")}});e(document).on("click.editable",function(n){var r=e(n.target),i,s=[".editable-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(!e.contains(document.documentElement,n.target)){return}if(r.is(document)){return}for(i=0;i<s.length;i++){if(r.is(s[i])||r.parents(s[i]).length){return}}t.prototype.closeOthers(n.target)});e(document).data("editable-handlers-attached",true)}},splitOptions:function(){this.containerOptions={};this.formOptions={};if(!e.fn[this.containerName]){throw new Error(this.containerName+" not found. Have you included corresponding js file?")}var t=e.fn[this.containerName].defaults;for(var n in this.options){if(n in t){this.containerOptions[n]=this.options[n]}else{this.formOptions[n]=this.options[n]}}},tip:function(){return this.container()?this.container().$tip:null},container:function(){return this.$element.data(this.containerDataName||this.containerName)},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:e.proxy(this.save,this),nochange:e.proxy(function(){this.hide("nochange")},this),cancel:e.proxy(function(){this.hide("cancel")},this),show:e.proxy(function(){if(this.delayedHide){this.hide(this.delayedHide.reason);this.delayedHide=false}else{this.setPosition()}},this),rendering:e.proxy(this.setPosition,this),resize:e.proxy(this.setPosition,this),rendered:e.proxy(function(){this.$element.triggerHandler("shown",this)},this)}).editableform("render")},show:function(t){this.$element.addClass("editable-open");if(t!==false){this.closeOthers(this.$element[0])}this.innerShow();this.tip().addClass(this.containerClass);if(this.$form){}this.$form=e("<div>");if(this.tip().is(this.innerCss)){this.tip().append(this.$form)}else{this.tip().find(this.innerCss).append(this.$form)}this.renderForm()},hide:function(e){if(!this.tip()||!this.tip().is(":visible")||!this.$element.hasClass("editable-open")){return}if(this.$form.data("editableform").isSaving){this.delayedHide={reason:e};return}else{this.delayedHide=false}this.$element.removeClass("editable-open");this.innerHide();this.$element.triggerHandler("hidden",e||"manual")},innerShow:function(){},innerHide:function(){},toggle:function(e){if(this.container()&&this.tip()&&this.tip().is(":visible")){this.hide()}else{this.show(e)}},setPosition:function(){},save:function(e,t){this.$element.triggerHandler("save",t);this.hide("save")},option:function(e,t){this.options[e]=t;if(e in this.containerOptions){this.containerOptions[e]=t;this.setContainerOption(e,t)}else{this.formOptions[e]=t;if(this.$form){this.$form.editableform("option",e,t)}}},setContainerOption:function(e,t){this.call("option",e,t)},destroy:function(){this.hide();this.innerDestroy();this.$element.off("destroyed");this.$element.removeData("editableContainer")},innerDestroy:function(){},closeOthers:function(t){e(".editable-open").each(function(n,r){if(r===t||e(r).find(t).length){return}var i=e(r),s=i.data("editableContainer");if(!s){return}if(s.options.onblur==="cancel"){i.data("editableContainer").hide("onblur")}else{if(s.options.onblur==="submit"){i.data("editableContainer").tip().find("form").submit()}}})},activate:function(){if(this.tip&&this.tip().is(":visible")&&this.$form){this.$form.data("editableform").input.activate()}}};e.fn.editableContainer=function(r){var i=arguments;return this.each(function(){var s=e(this),o="editableContainer",u=s.data(o),a=typeof r==="object"&&r,l=a.mode==="inline"?n:t;if(!u){s.data(o,u=new l(this,a))}if(typeof r==="string"){u[r].apply(u,Array.prototype.slice.call(i,1))}})};e.fn.editableContainer.Popup=t;e.fn.editableContainer.Inline=n;e.fn.editableContainer.defaults={value:null,placement:"top",autohide:true,onblur:"cancel",anim:false,mode:"popup"};jQuery.event.special.destroyed={remove:function(e){if(e.handler){e.handler()}}}})(window.jQuery);(function(e){e.extend(e.fn.editableContainer.Inline.prototype,e.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",containerClass:"editable-container editable-inline",initContainer:function(){this.$tip=e("<span></span>");if(!this.options.anim){this.options.anim=0}},splitOptions:function(){this.containerOptions={};this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide();this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,e.proxy(function(){this.$element.show();this.innerDestroy()},this))},innerDestroy:function(){if(this.tip()){this.tip().empty().remove()}}})})(window.jQuery);(function(e){var t=function(t,n){this.$element=e(t);this.options=e.extend({},e.fn.editable.defaults,n,e.fn.editableutils.getConfigData(this.$element));if(this.options.selector){this.initLive()}else{this.init()}if(this.options.highlight&&!e.fn.editableutils.supportsTransitions()){this.options.highlight=false}};t.prototype={constructor:t,init:function(){var t=false,n,r;this.options.name=this.options.name||this.$element.attr("id");this.options.scope=this.$element[0];this.input=e.fn.editableutils.createInput(this.options);if(!this.input){return}if(this.options.value===undefined||this.options.value===null){this.value=this.input.html2value(e.trim(this.$element.html()));t=true}else{this.options.value=e.fn.editableutils.tryParseJson(this.options.value,true);if(typeof this.options.value==="string"){this.value=this.input.str2value(this.options.value)}else{this.value=this.options.value}}this.$element.addClass("editable");if(this.options.toggle!=="manual"){this.$element.addClass("editable-click");this.$element.on(this.options.toggle+".editable",e.proxy(function(e){if(!this.options.disabled){e.preventDefault()}if(this.options.toggle==="mouseenter"){this.show()}else{var t=this.options.toggle!=="click";this.toggle(t)}},this))}else{this.$element.attr("tabindex",-1)}if(typeof this.options.display==="function"){this.options.autotext="always"}switch(this.options.autotext){case"always":n=true;break;case"auto":n=!e.trim(this.$element.text()).length&&this.value!==null&&this.value!==undefined&&!t;break;default:n=false}e.when(n?this.render():true).then(e.proxy(function(){if(this.options.disabled){this.disable()}else{this.enable()}this.$element.triggerHandler("init",this)},this))},initLive:function(){var t=this.options.selector;this.options.selector=false;this.options.autotext="never";this.$element.on(this.options.toggle+".editable",t,e.proxy(function(t){var n=e(t.target);if(!n.data("editable")){if(n.hasClass(this.options.emptyclass)){n.empty()}n.editable(this.options).trigger(t)}},this))},render:function(e){if(this.options.display===false){return}if(this.input.value2htmlFinal){return this.input.value2html(this.value,this.$element[0],this.options.display,e)}else{if(typeof this.options.display==="function"){return this.options.display.call(this.$element[0],this.value,e)}else{return this.input.value2html(this.value,this.$element[0])}}},enable:function(){this.options.disabled=false;this.$element.removeClass("editable-disabled");this.handleEmpty(this.isEmpty);if(this.options.toggle!=="manual"){if(this.$element.attr("tabindex")==="-1"){this.$element.removeAttr("tabindex")}}},disable:function(){this.options.disabled=true;this.hide();this.$element.addClass("editable-disabled");this.handleEmpty(this.isEmpty);this.$element.attr("tabindex",-1)},toggleDisabled:function(){if(this.options.disabled){this.enable()}else{this.disable()}},option:function(t,n){if(t&&typeof t==="object"){e.each(t,e.proxy(function(t,n){this.option(e.trim(t),n)},this));return}this.options[t]=n;if(t==="disabled"){return n?this.disable():this.enable()}if(t==="value"){this.setValue(n)}if(this.container){this.container.option(t,n)}if(this.input.option){this.input.option(t,n)}},handleEmpty:function(t){if(this.options.display===false){return}if(t!==undefined){this.isEmpty=t}else{if(e.trim(this.$element.html())===""){this.isEmpty=true}else{if(e.trim(this.$element.text())!==""){this.isEmpty=false}else{this.isEmpty=!this.$element.height()||!this.$element.width()}}}if(!this.options.disabled){if(this.isEmpty){this.$element.html(this.options.emptytext);if(this.options.emptyclass){this.$element.addClass(this.options.emptyclass)}}else{if(this.options.emptyclass){this.$element.removeClass(this.options.emptyclass)}}}else{if(this.isEmpty){this.$element.empty();if(this.options.emptyclass){this.$element.removeClass(this.options.emptyclass)}}}},show:function(t){if(this.options.disabled){return}if(!this.container){var n=e.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(n);this.$element.on("save.internal",e.proxy(this.save,this));this.container=this.$element.data("editableContainer")}else{if(this.container.tip().is(":visible")){return}}this.container.show(t)},hide:function(){if(this.container){this.container.hide()}},toggle:function(e){if(this.container&&this.container.tip().is(":visible")){this.hide()}else{this.show(e)}},save:function(e,t){if(this.options.unsavedclass){var n=false;n=n||typeof this.options.url==="function";n=n||this.options.display===false;n=n||t.response!==undefined;n=n||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(t.newValue);if(n){this.$element.removeClass(this.options.unsavedclass)}else{this.$element.addClass(this.options.unsavedclass)}}if(this.options.highlight){var r=this.$element,i=r.css("background-color");r.css("background-color",this.options.highlight);setTimeout(function(){r.css("background-color",i);r.addClass("editable-bg-transition");setTimeout(function(){r.removeClass("editable-bg-transition")},1700)},0)}this.setValue(t.newValue,false,t.response)},validate:function(){if(typeof this.options.validate==="function"){return this.options.validate.call(this,this.value)}},setValue:function(t,n,r){if(n){this.value=this.input.str2value(t)}else{this.value=t}if(this.container){this.container.option("value",this.value)}e.when(this.render(r)).then(e.proxy(function(){this.handleEmpty()},this))},activate:function(){if(this.container){this.container.activate()}},destroy:function(){this.disable();if(this.container){this.container.destroy()}this.input.destroy();if(this.options.toggle!=="manual"){this.$element.removeClass("editable-click");this.$element.off(this.options.toggle+".editable")}this.$element.off("save.internal");this.$element.removeClass("editable editable-open editable-disabled");this.$element.removeData("editable")}};e.fn.editable=function(n){var r={},i=arguments,s="editable";switch(n){case"validate":this.each(function(){var t=e(this),n=t.data(s),i;if(n&&(i=n.validate())){r[n.options.name]=i}});return r;case"getValue":if(arguments.length===2&&arguments[1]===true){r=this.eq(0).data(s).value}else{this.each(function(){var t=e(this),n=t.data(s);if(n&&n.value!==undefined&&n.value!==null){r[n.options.name]=n.input.value2submit(n.value)}})}return r;case"submit":var o=arguments[1]||{},u=this,a=this.editable("validate"),f;if(e.isEmptyObject(a)){f=this.editable("getValue");if(o.data){e.extend(f,o.data)}e.ajax(e.extend({url:o.url,data:f,type:"POST"},o.ajaxOptions)).success(function(e){if(typeof o.success==="function"){o.success.call(u,e,o)}}).error(function(){if(typeof o.error==="function"){o.error.apply(u,arguments)}})}else{if(typeof o.error==="function"){o.error.call(u,a)}}return this}return this.each(function(){var r=e(this),o=r.data(s),u=typeof n==="object"&&n;if(!o){r.data(s,o=new t(this,u))}if(typeof n==="string"){o[n].apply(o,Array.prototype.slice.call(i,1))}})};e.fn.editable.defaults={type:"text",disabled:false,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null,highlight:"#FFFF80"}})(window.jQuery);(function(e){e.fn.editabletypes={};var t=function(){};t.prototype={init:function(t,n,r){this.type=t;this.options=e.extend({},r,n)},prerender:function(){this.$tpl=e(this.options.tpl);this.$input=this.$tpl;this.$clear=null;this.error=null},render:function(){},value2html:function(t,n){e(n).text(e.trim(t))},html2value:function(t){return e("<div>").html(t).text()},value2str:function(e){return e},str2value:function(e){return e},value2submit:function(e){return e},value2input:function(e){this.$input.val(e)},input2value:function(){return this.$input.val()},activate:function(){if(this.$input.is(":visible")){this.$input.focus()}},clear:function(){this.$input.val(null)},escape:function(t){return e("<div>").text(t).html()},autosubmit:function(){},destroy:function(){},setClass:function(){if(this.options.inputclass){this.$input.addClass(this.options.inputclass)}},setAttr:function(e){if(this.options[e]!==undefined&&this.options[e]!==null){this.$input.attr(e,this.options[e])}},option:function(e,t){this.options[e]=t}};t.defaults={tpl:"",inputclass:"input-medium",scope:null,showbuttons:true};e.extend(e.fn.editabletypes,{abstractinput:t})})(window.jQuery);(function(e){var t=function(e){};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{render:function(){var t=e.Deferred();this.error=null;this.onSourceReady(function(){this.renderList();t.resolve()},function(){this.error=this.options.sourceError;t.resolve()});return t.promise()},html2value:function(e){return null},value2html:function(t,n,r,i){var s=e.Deferred(),o=function(){if(typeof r==="function"){r.call(n,t,this.sourceData,i)}else{this.value2htmlFinal(t,n)}s.resolve()};if(t===null){o.call(this)}else{this.onSourceReady(o,function(){s.resolve()})}return s.promise()},onSourceReady:function(t,n){var r;if(e.isFunction(this.options.source)){r=this.options.source.call(this.options.scope);this.sourceData=null}else{r=this.options.source}if(this.options.sourceCache&&e.isArray(this.sourceData)){t.call(this);return}try{r=e.fn.editableutils.tryParseJson(r,false)}catch(i){n.call(this);return}if(typeof r==="string"){if(this.options.sourceCache){var s=r,o;if(!e(document).data(s)){e(document).data(s,{})}o=e(document).data(s);if(o.loading===false&&o.sourceData){this.sourceData=o.sourceData;this.doPrepend();t.call(this);return}else{if(o.loading===true){o.callbacks.push(e.proxy(function(){this.sourceData=o.sourceData;this.doPrepend();t.call(this)},this));o.err_callbacks.push(e.proxy(n,this));return}else{o.loading=true;o.callbacks=[];o.err_callbacks=[]}}}e.ajax({url:r,type:"get",cache:false,dataType:"json",success:e.proxy(function(r){if(o){o.loading=false}this.sourceData=this.makeArray(r);if(e.isArray(this.sourceData)){if(o){o.sourceData=this.sourceData;e.each(o.callbacks,function(){this.call()})}this.doPrepend();t.call(this)}else{n.call(this);if(o){e.each(o.err_callbacks,function(){this.call()})}}},this),error:e.proxy(function(){n.call(this);if(o){o.loading=false;e.each(o.err_callbacks,function(){this.call()})}},this)})}else{this.sourceData=this.makeArray(r);if(e.isArray(this.sourceData)){this.doPrepend();t.call(this)}else{n.call(this)}}},doPrepend:function(){if(this.options.prepend===null||this.options.prepend===undefined){return}if(!e.isArray(this.prependData)){if(e.isFunction(this.options.prepend)){this.options.prepend=this.options.prepend.call(this.options.scope)}this.options.prepend=e.fn.editableutils.tryParseJson(this.options.prepend,true);if(typeof this.options.prepend==="string"){this.options.prepend={"":this.options.prepend}}this.prependData=this.makeArray(this.options.prepend)}if(e.isArray(this.prependData)&&e.isArray(this.sourceData)){this.sourceData=this.prependData.concat(this.sourceData)}},renderList:function(){},value2htmlFinal:function(e,t){},makeArray:function(t){var n,r,i=[],s,o;if(!t||typeof t==="string"){return null}if(e.isArray(t)){o=function(e,t){r={value:e,text:t};if(n++>=2){return false}};for(var u=0;u<t.length;u++){s=t[u];if(typeof s==="object"){n=0;e.each(s,o);if(n===1){i.push(r)}else{if(n>1){if(s.children){s.children=this.makeArray(s.children)}i.push(s)}}}else{i.push({value:s,text:s})}}}else{e.each(t,function(e,t){i.push({value:e,text:t})})}return i},option:function(e,t){this.options[e]=t;if(e==="source"){this.sourceData=null}if(e==="prepend"){this.prependData=null}}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{source:null,prepend:false,sourceError:"Error when loading list",sourceCache:true});e.fn.editabletypes.list=t})(window.jQuery);(function(e){var t=function(e){this.init("text",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{render:function(){this.renderClear();this.setClass();this.setAttr("placeholder")},activate:function(){if(this.$input.is(":visible")){this.$input.focus();e.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length);if(this.toggleClear){this.toggleClear()}}},renderClear:function(){if(this.options.clear){this.$clear=e('<span class="editable-clear-x"></span>');this.$input.after(this.$clear).css("padding-right",24).keyup(e.proxy(function(t){if(~e.inArray(t.keyCode,[40,38,9,13,27])){return}clearTimeout(this.t);var n=this;this.t=setTimeout(function(){n.toggleClear(t)},100)},this)).parent().css("position","relative");this.$clear.click(e.proxy(this.clear,this))}},postrender:function(){},toggleClear:function(e){if(!this.$clear){return}var t=this.$input.val().length,n=this.$clear.is(":visible");if(t&&!n){this.$clear.show()}if(!t&&n){this.$clear.hide()}},clear:function(){this.$clear.hide();this.$input.val("").focus()}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:true});e.fn.editabletypes.text=t})(window.jQuery);(function(e){var t=function(e){this.init("textarea",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{render:function(){this.setClass();this.setAttr("placeholder");this.setAttr("rows");this.$input.keydown(function(t){if(t.ctrlKey&&t.which===13){e(this).closest("form").submit()}})},value2html:function(t,n){var r="",i;if(t){i=t.split("\n");for(var s=0;s<i.length;s++){i[s]=e("<div>").text(i[s]).html()}r=i.join("<br>")}e(n).html(r)},html2value:function(t){if(!t){return""}var n=new RegExp(String.fromCharCode(10),"g");var r=t.split(/<br\s*\/?>/i);for(var i=0;i<r.length;i++){var s=e("<div>").html(r[i]).text();s=s.replace(n,"");r[i]=s}return r.join("\n")},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7});e.fn.editabletypes.textarea=t})(window.jQuery);(function(e){var t=function(e){this.init("select",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.list);e.extend(t.prototype,{renderList:function(){this.$input.empty();var t=function(n,r){if(e.isArray(r)){for(var i=0;i<r.length;i++){if(r[i].children){n.append(t(e("<optgroup>",{label:r[i].text}),r[i].children))}else{n.append(e("<option>",{value:r[i].value}).text(r[i].text))}}}return n};t(this.$input,this.sourceData);this.setClass();this.$input.on("keydown.editable",function(t){if(t.which===13){e(this).closest("form").submit()}})},value2htmlFinal:function(t,n){var r="",i=e.fn.editableutils.itemsByValue(t,this.sourceData);if(i.length){r=i[0].text}e(n).text(r)},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){e(this).closest("form").submit()})}});t.defaults=e.extend({},e.fn.editabletypes.list.defaults,{tpl:"<select></select>"});e.fn.editabletypes.select=t})(window.jQuery);(function(e){var t=function(e){this.init("checklist",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.list);e.extend(t.prototype,{renderList:function(){var t,n;this.$tpl.empty();if(!e.isArray(this.sourceData)){return}for(var r=0;r<this.sourceData.length;r++){t=e("<label>").append(e("<input>",{type:"checkbox",value:this.sourceData[r].value})).append(e("<span>").text(" "+this.sourceData[r].text));e("<div>").append(t).appendTo(this.$tpl)}this.$input=this.$tpl.find('input[type="checkbox"]');this.setClass()},value2str:function(t){return e.isArray(t)?t.sort().join(e.trim(this.options.separator)):""},str2value:function(t){var n,r=null;if(typeof t==="string"&&t.length){n=new RegExp("\\s*"+e.trim(this.options.separator)+"\\s*");r=t.split(n)}else{if(e.isArray(t)){r=t}else{r=[t]}}return r},value2input:function(t){this.$input.prop("checked",false);if(e.isArray(t)&&t.length){this.$input.each(function(n,r){var i=e(r);e.each(t,function(e,t){if(i.val()==t){i.prop("checked",true)}})})}},input2value:function(){var t=[];this.$input.filter(":checked").each(function(n,r){t.push(e(r).val())});return t},value2htmlFinal:function(t,n){var r=[],i=e.fn.editableutils.itemsByValue(t,this.sourceData);if(i.length){e.each(i,function(t,n){r.push(e.fn.editableutils.escape(n.text))});e(n).html(r.join("<br>"))}else{e(n).empty()}},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(t){if(t.which===13){e(this).closest("form").submit()}})}});t.defaults=e.extend({},e.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"></div>',inputclass:null,separator:","});e.fn.editabletypes.checklist=t})(window.jQuery);(function(e){var t=function(e){this.init("password",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text);e.extend(t.prototype,{value2html:function(t,n){if(t){e(n).text("[hidden]")}else{e(n).empty()}},html2value:function(e){return null}});t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="password">'});e.fn.editabletypes.password=t})(window.jQuery);(function(e){var t=function(e){this.init("email",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text);t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="email">'});e.fn.editabletypes.email=t})(window.jQuery);(function(e){var t=function(e){this.init("url",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text);t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="url">'});e.fn.editabletypes.url=t})(window.jQuery);(function(e){var t=function(e){this.init("tel",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text);t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'});e.fn.editabletypes.tel=t})(window.jQuery);(function(e){var t=function(e){this.init("number",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text);e.extend(t.prototype,{render:function(){t.superclass.render.call(this);this.setAttr("min");this.setAttr("max");this.setAttr("step")},postrender:function(){if(this.$clear){this.$clear.css({right:24})}}});t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null});e.fn.editabletypes.number=t})(window.jQuery);(function(e){var t=function(e){this.init("range",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.number);e.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input");this.setClass();this.setAttr("min");this.setAttr("max");this.setAttr("step");this.$input.on("input",function(){e(this).siblings("output").text(e(this).val())})},activate:function(){this.$input.focus()}});t.defaults=e.extend({},e.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"});e.fn.editabletypes.range=t})(window.jQuery);(function(e){var t=function(n){this.init("select2",n,t.defaults);n.select2=n.select2||{};this.sourceData=null;if(n.placeholder){n.select2.placeholder=n.placeholder}if(!n.select2.tags&&n.source){var r=n.source;if(e.isFunction(n.source)){r=n.source.call(n.scope)}if(typeof r==="string"){n.select2.ajax=n.select2.ajax||{};if(!n.select2.ajax.data){n.select2.ajax.data=function(e){return{query:e}}}if(!n.select2.ajax.results){n.select2.ajax.results=function(e){return{results:e}}}n.select2.ajax.url=r}else{this.sourceData=this.convertSource(r);n.select2.data=this.sourceData}}this.options.select2=e.extend({},t.defaults.select2,n.select2);this.isMultiple=this.options.select2.tags||this.options.select2.multiple;this.isRemote="ajax"in this.options.select2};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{render:function(){this.setClass();this.$input.select2(this.options.select2);if(this.isRemote){this.$input.on("select2-loaded",e.proxy(function(e){this.sourceData=e.items.results},this))}if(this.isMultiple){this.$input.on("change",function(){e(this).closest("form").parent().triggerHandler("resize")})}},value2html:function(t,n){var r="",i;if(this.options.select2.tags){i=t}else{if(this.sourceData){i=e.fn.editableutils.itemsByValue(t,this.sourceData,"id")}else{}}if(e.isArray(i)){r=[];e.each(i,function(e,t){r.push(t&&typeof t==="object"?t.text:t)})}else{if(i){r=i.text}}r=e.isArray(r)?r.join(this.options.viewseparator):r;e(n).text(r)},html2value:function(e){return this.options.select2.tags?this.str2value(e,this.options.viewseparator):null},value2input:function(t){if(this.isRemote){var n,r;if(this.sourceData){r=e.fn.editableutils.itemsByValue(t,this.sourceData,"id");if(r.length){n=r[0]}}if(!n){n={id:t,text:e(this.options.scope).text()}}this.$input.select2("data",n).trigger("change",true)}else{this.$input.val(t).trigger("change",true)}},input2value:function(){return this.$input.select2("val")},str2value:function(t,n){if(typeof t!=="string"||!this.isMultiple){return t}n=n||this.options.select2.separator||e.fn.select2.defaults.separator;var r,i,s;if(t===null||t.length<1){return null}r=t.split(n);for(i=0,s=r.length;i<s;i=i+1){r[i]=e.trim(r[i])}return r},autosubmit:function(){this.$input.on("change",function(t,n){if(!n){e(this).closest("form").submit()}})},convertSource:function(t){if(e.isArray(t)&&t.length&&t[0].value!==undefined){for(var n=0;n<t.length;n++){if(t[n].value!==undefined){t[n].id=t[n].value;delete t[n].value}}}return t}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "});e.fn.editabletypes.select2=t})(window.jQuery);(function(e){var t=function(t,n){this.$element=e(t);if(!this.$element.is("input")){e.error("Combodate should be applied to INPUT element");return}this.options=e.extend({},e.fn.combodate.defaults,n,this.$element.data());this.init()};t.prototype={constructor:t,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]};this.$widget=e('<span class="combodate"></span>').html(this.getTemplate());this.initCombos();this.$widget.on("change","select",e.proxy(function(){this.$element.val(this.getValue())},this));this.$widget.find("select").css("width","auto");this.$element.hide().after(this.$widget);this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var t=this.options.template;e.each(this.map,function(e,n){n=n[0];var r=new RegExp(n+"+"),i=n.length>1?n.substring(1,2):n;t=t.replace(r,"{"+i+"}")});t=t.replace(/ /g,"&nbsp;");e.each(this.map,function(e,n){n=n[0];var r=n.length>1?n.substring(1,2):n;t=t.replace("{"+r+"}",'<select class="'+e+'"></select>')});return t},initCombos:function(){var t=this;e.each(this.map,function(e,n){var r=t.$widget.find("."+e),i,s;if(r.length){t["$"+e]=r;i="fill"+e.charAt(0).toUpperCase()+e.slice(1);s=t[i]();t["$"+e].html(t.renderItems(s))}})},initItems:function(e){var t=[],n;if(this.options.firstItem==="name"){n=moment.relativeTime||moment.langData()._relativeTime;var r=typeof n[e]==="function"?n[e](1,true,e,false):n[e];r=r.split(" ").reverse()[0];t.push(["",r])}else{if(this.options.firstItem==="empty"){t.push(["",""])}}return t},renderItems:function(e){var t=[];for(var n=0;n<e.length;n++){t.push('<option value="'+e[n][0]+'">'+e[n][1]+"</option>")}return t.join("\n")},fillDay:function(){var e=this.initItems("d"),t,n,r=this.options.template.indexOf("DD")!==-1;for(n=1;n<=31;n++){t=r?this.leadZero(n):n;e.push([n,t])}return e},fillMonth:function(){var e=this.initItems("M"),t,n,r=this.options.template.indexOf("MMMM")!==-1,i=this.options.template.indexOf("MMM")!==-1,s=this.options.template.indexOf("MM")!==-1;for(n=0;n<=11;n++){if(r){t=moment().date(1).month(n).format("MMMM")}else{if(i){t=moment().date(1).month(n).format("MMM")}else{if(s){t=this.leadZero(n+1)}else{t=n+1}}}e.push([n,t])}return e},fillYear:function(){var e=[],t,n,r=this.options.template.indexOf("YYYY")!==-1;for(n=this.options.maxYear;n>=this.options.minYear;n--){t=r?n:(n+"").substring(2);e[this.options.yearDescending?"push":"unshift"]([n,t])}e=this.initItems("y").concat(e);return e},fillHour:function(){var e=this.initItems("h"),t,n,r=this.options.template.indexOf("h")!==-1,i=this.options.template.indexOf("H")!==-1,s=this.options.template.toLowerCase().indexOf("hh")!==-1,o=r?1:0,u=r?12:23;for(n=o;n<=u;n++){t=s?this.leadZero(n):n;e.push([n,t])}return e},fillMinute:function(){var e=this.initItems("m"),t,n,r=this.options.template.indexOf("mm")!==-1;for(n=0;n<=59;n+=this.options.minuteStep){t=r?this.leadZero(n):n;e.push([n,t])}return e},fillSecond:function(){var e=this.initItems("s"),t,n,r=this.options.template.indexOf("ss")!==-1;for(n=0;n<=59;n+=this.options.secondStep){t=r?this.leadZero(n):n;e.push([n,t])}return e},fillAmpm:function(){var e=this.options.template.indexOf("a")!==-1,t=this.options.template.indexOf("A")!==-1,n=[["am",e?"am":"AM"],["pm",e?"pm":"PM"]];return n},getValue:function(t){var n,r={},i=this,s=false;e.each(this.map,function(e,t){if(e==="ampm"){return}var n=e==="day"?1:0;r[e]=i["$"+e]?parseInt(i["$"+e].val(),10):n;if(isNaN(r[e])){s=true;return false}});if(s){return""}if(this.$ampm){if(r.hour===12){r.hour=this.$ampm.val()==="am"?0:12}else{r.hour=this.$ampm.val()==="am"?r.hour:r.hour+12}}n=moment([r.year,r.month,r.day,r.hour,r.minute,r.second]);this.highlight(n);t=t===undefined?this.options.format:t;if(t===null){return n.isValid()?n:null}else{return n.isValid()?n.format(t):""}},setValue:function(t){function s(t,n){var r={};t.children("option").each(function(t,i){var s=e(i).attr("value"),o;if(s===""){return}o=Math.abs(s-n);if(typeof r.distance==="undefined"||o<r.distance){r={value:s,distance:o}}});return r.value}if(!t){return}var n=typeof t==="string"?moment(t,this.options.format):moment(t),r=this,i={};if(n.isValid()){e.each(this.map,function(e,t){if(e==="ampm"){return}i[e]=n[t[1]]()});if(this.$ampm){if(i.hour>=12){i.ampm="pm";if(i.hour>12){i.hour-=12}}else{i.ampm="am";if(i.hour===0){i.hour=12}}}e.each(i,function(e,t){if(r["$"+e]){if(e==="minute"&&r.options.minuteStep>1&&r.options.roundTime){t=s(r["$"+e],t)}if(e==="second"&&r.options.secondStep>1&&r.options.roundTime){t=s(r["$"+e],t)}r["$"+e].val(t)}});this.$element.val(n.format(this.options.format))}},highlight:function(e){if(!e.isValid()){if(this.options.errorClass){this.$widget.addClass(this.options.errorClass)}else{if(!this.borderColor){this.borderColor=this.$widget.find("select").css("border-color")}this.$widget.find("select").css("border-color","red")}}else{if(this.options.errorClass){this.$widget.removeClass(this.options.errorClass)}else{this.$widget.find("select").css("border-color",this.borderColor)}}},leadZero:function(e){return e<=9?"0"+e:e},destroy:function(){this.$widget.remove();this.$element.removeData("combodate").show()}};e.fn.combodate=function(n){var r,i=Array.apply(null,arguments);i.shift();if(n==="getValue"&&this.length&&(r=this.eq(0).data("combodate"))){return r.getValue.apply(r,i)}return this.each(function(){var r=e(this),s=r.data("combodate"),o=typeof n=="object"&&n;if(!s){r.data("combodate",s=new t(this,o))}if(typeof n=="string"&&typeof s[n]=="function"){s[n].apply(s,i)}})};e.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:2015,yearDescending:true,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:true}})(window.jQuery);(function(e){var t=function(n){this.init("combodate",n,t.defaults);if(!this.options.viewformat){this.options.viewformat=this.options.format}n.combodate=e.fn.editableutils.tryParseJson(n.combodate,true);this.options.combodate=e.extend({},t.defaults.combodate,n.combodate,{format:this.options.format,template:this.options.template})};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{render:function(){this.$input.combodate(this.options.combodate)},value2html:function(t,n){var r=t?t.format(this.options.viewformat):"";e(n).text(r)},html2value:function(e){return e?moment(e,this.options.viewformat):null},value2str:function(e){return e?e.format(this.options.format):""},str2value:function(e){return e?moment(e,this.options.format):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.combodate("setValue",e)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null});e.fn.editabletypes.combodate=t})(window.jQuery);(function(e){e.extend(e.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=e(e.fn.editableform.template);this.$form.find(".editable-error-block").addClass("help-block")}});e.fn.editableform.buttons='<button type="submit" class="btn btn-primary editable-submit"><i class="icon-ok icon-white"></i></button><button type="button" class="btn editable-cancel"><i class="icon-remove"></i></button>';e.fn.editableform.errorGroupClass="error";e.fn.editableform.errorBlockClass=null})(window.jQuery);(function(e){e.extend(e.fn.editableContainer.Popup.prototype,{containerName:"popover",innerCss:e.fn.popover&&e(e.fn.popover.defaults.template).find("p").length?".popover-content p":".popover-content",initContainer:function(){e.extend(this.containerOptions,{trigger:"manual",selector:false,content:" ",template:e.fn.popover.defaults.template});var t;if(this.$element.data("template")){t=this.$element.data("template");this.$element.removeData("template")}this.call(this.containerOptions);if(t){this.$element.data("template",t)}},innerShow:function(){this.call("show")},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setContainerOption:function(e,t){this.container().options[e]=t},setPosition:function(){(function(){var e=this.tip(),t,n,r,i,s,o;s=typeof this.options.placement==="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement;t=/in/.test(s);e.removeClass("top right bottom left").css({top:0,left:0,display:"block"});n=this.getPosition(t);r=e[0].offsetWidth;i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width};break}e.offset(o).addClass(s).addClass("in")}).call(this.container())}})})(window.jQuery);(function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}function n(){var e=new Date;return t(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())}function s(t,n){var r=e(t).data(),i={},s,o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var u in r){if(n.test(u)){s=u.replace(o,function(e,t){return t.toLowerCase()});i[s]=r[u]}}return i}function o(t){var n={};if(!c[t]){t=t.split("-")[0];if(!c[t]){return}}var r=c[t];e.each(l,function(e,t){if(t in r){n[t]=r[t]}});return n}var r=function(t,n){var r=this;this._process_options(n);this.element=e(t);this.isInline=false;this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on, .btn"):false;this.hasInput=this.component&&this.element.find("input").length;if(this.component&&this.component.length===0){this.component=false}this.picker=e(h.template);this._buildEvents();this._attachEvents();if(this.isInline){this.picker.addClass("datepicker-inline").appendTo(this.element)}else{this.picker.addClass("datepicker-dropdown dropdown-menu")}if(this.o.rtl){this.picker.addClass("datepicker-rtl");this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")}this.viewMode=this.o.startView;if(this.o.calendarWeeks){this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1})}this._allow_update=false;this.setStartDate(this.o.startDate);this.setEndDate(this.o.endDate);this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);this.fillDow();this.fillMonths();this._allow_update=true;this.update();this.showMode();if(this.isInline){this.show()}};r.prototype={constructor:r,_process_options:function(t){this._o=e.extend({},this._o,t);var n=this.o=e.extend({},this._o);var r=n.language;if(!c[r]){r=r.split("-")[0];if(!c[r]){r=f.language}}n.language=r;switch(n.startView){case 2:case"decade":n.startView=2;break;case 1:case"year":n.startView=1;break;default:n.startView=0}switch(n.minViewMode){case 1:case"months":n.minViewMode=1;break;case 2:case"years":n.minViewMode=2;break;default:n.minViewMode=0}n.startView=Math.max(n.startView,n.minViewMode);n.weekStart%=7;n.weekEnd=(n.weekStart+6)%7;var i=h.parseFormat(n.format);if(n.startDate!==-Infinity){n.startDate=h.parseDate(n.startDate,i,n.language)}if(n.endDate!==Infinity){n.endDate=h.parseDate(n.endDate,i,n.language)}n.daysOfWeekDisabled=n.daysOfWeekDisabled||[];if(!e.isArray(n.daysOfWeekDisabled)){n.daysOfWeekDisabled=n.daysOfWeekDisabled.split(/[,\s]*/)}n.daysOfWeekDisabled=e.map(n.daysOfWeekDisabled,function(e){return parseInt(e,10)})},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t=0,n,r;t<e.length;t++){n=e[t][0];r=e[t][1];n.on(r)}},_unapplyEvents:function(e){for(var t=0,n,r;t<e.length;t++){n=e[t][0];r=e[t][1];n.off(r)}},_buildEvents:function(){if(this.isInput){this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]}else{if(this.component&&this.hasInput){this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]}else{if(this.element.is("div")){this.isInline=true}else{this._events=[[this.element,{click:e.proxy(this.show,this)}]]}}}this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{mousedown:e.proxy(function(e){if(!(this.element.is(e.target)||this.element.find(e.target).size()||this.picker.is(e.target)||this.picker.find(e.target).size())){this.hide()}},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var r=n||this.date,i=new Date(r.getTime()+r.getTimezoneOffset()*6e4);this.element.trigger({type:t,date:i,format:e.proxy(function(e){var t=e||this.o.format;return h.formatDate(r,t,this.o.language)},this)})},show:function(e){if(!this.isInline){this.picker.appendTo("body")}this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();this._attachSecondaryEvents();if(e){e.preventDefault()}this._trigger("show")},hide:function(e){if(this.isInline){return}if(!this.picker.is(":visible")){return}this.picker.hide().detach();this._detachSecondaryEvents();this.viewMode=this.o.startView;this.showMode();if(this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())){this.setValue()}this._trigger("hide")},remove:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;if(!this.isInput){delete this.element.data().date}},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+e.getTimezoneOffset()*6e4)},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-e.getTimezoneOffset()*6e4))},setUTCDate:function(e){this.date=e;this.setValue()},setValue:function(){var e=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find("input").val(e)}}else{this.element.val(e)}},getFormattedDate:function(e){if(e===undefined){e=this.o.format}return h.formatDate(this.date,e,this.o.language)},setStartDate:function(e){this._process_options({startDate:e});this.update();this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e});this.update();this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e});this.update();this.updateNavArrows()},place:function(){if(this.isInline){return}var t=parseInt(this.element.parents().filter(function(){return e(this).css("z-index")!="auto"}).first().css("z-index"))+10;var n=this.component?this.component.parent().offset():this.element.offset();var r=this.component?this.component.outerHeight(true):this.element.outerHeight(true);this.picker.css({top:n.top+r,left:n.left,zIndex:t})},_allow_update:true,update:function(){if(!this._allow_update){return}var e,t=false;if(arguments&&arguments.length&&(typeof arguments[0]==="string"||arguments[0]instanceof Date)){e=arguments[0];t=true}else{e=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val();delete this.element.data().date}this.date=h.parseDate(e,this.o.format,this.o.language);if(t){this.setValue()}if(this.date<this.o.startDate){this.viewDate=new Date(this.o.startDate)}else{if(this.date>this.o.endDate){this.viewDate=new Date(this.o.endDate)}else{this.viewDate=new Date(this.date)}}this.fill()},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="cw">&nbsp;</th>';t+=n;this.picker.find(".datepicker-days thead tr:first-child").prepend(n)}while(e<this.o.weekStart+7){t+='<th class="dow">'+c[this.o.language].daysMin[e++%7]+"</th>"}t+="</tr>";this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){var e="",t=0;while(t<12){e+='<span class="month">'+c[this.o.language].monthsShort[t++]+"</span>"}this.picker.find(".datepicker-months td").html(e)},setRange:function(t){if(!t||!t.length){delete this.range}else{this.range=e.map(t,function(e){return e.valueOf()})}this.fill()},getClassNames:function(t){var n=[],r=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),s=this.date.valueOf(),o=new Date;if(t.getUTCFullYear()<r||t.getUTCFullYear()==r&&t.getUTCMonth()<i){n.push("old")}else{if(t.getUTCFullYear()>r||t.getUTCFullYear()==r&&t.getUTCMonth()>i){n.push("new")}}if(this.o.todayHighlight&&t.getUTCFullYear()==o.getFullYear()&&t.getUTCMonth()==o.getMonth()&&t.getUTCDate()==o.getDate()){n.push("today")}if(s&&t.valueOf()==s){n.push("active")}if(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)!==-1){n.push("disabled")}if(this.range){if(t>this.range[0]&&t<this.range[this.range.length-1]){n.push("range")}if(e.inArray(t.valueOf(),this.range)!=-1){n.push("selected")}}return n},fill:function(){var n=new Date(this.viewDate),r=n.getUTCFullYear(),i=n.getUTCMonth(),s=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,o=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,u=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,a=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,f=this.date&&this.date.valueOf(),l;this.picker.find(".datepicker-days thead th.datepicker-switch").text(c[this.o.language].months[i]+" "+r);this.picker.find("tfoot th.today").text(c[this.o.language].today).toggle(this.o.todayBtn!==false);this.picker.find("tfoot th.clear").text(c[this.o.language].clear).toggle(this.o.clearBtn!==false);this.updateNavArrows();this.fillMonths();var p=t(r,i-1,28,0,0,0,0),d=h.getDaysInMonth(p.getUTCFullYear(),p.getUTCMonth());p.setUTCDate(d);p.setUTCDate(d-(p.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(p);v.setUTCDate(v.getUTCDate()+42);v=v.valueOf();var m=[];var g;while(p.valueOf()<v){if(p.getUTCDay()==this.o.weekStart){m.push("<tr>");if(this.o.calendarWeeks){var y=new Date(+p+(this.o.weekStart-p.getUTCDay()-7)%7*864e5),b=new Date(+y+(7+4-y.getUTCDay())%7*864e5),w=new Date(+(w=t(b.getUTCFullYear(),0,1))+(7+4-w.getUTCDay())%7*864e5),E=(b-w)/864e5/7+1;m.push('<td class="cw">'+E+"</td>")}}g=this.getClassNames(p);g.push("day");var S=this.o.beforeShowDay(p);if(S===undefined){S={}}else{if(typeof S==="boolean"){S={enabled:S}}else{if(typeof S==="string"){S={classes:S}}}}if(S.enabled===false){g.push("disabled")}if(S.classes){g=g.concat(S.classes.split(/\s+/))}if(S.tooltip){l=S.tooltip}g=e.unique(g);m.push('<td class="'+g.join(" ")+'"'+(l?' title="'+l+'"':"")+">"+p.getUTCDate()+"</td>");if(p.getUTCDay()==this.o.weekEnd){m.push("</tr>")}p.setUTCDate(p.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(m.join(""));var x=this.date&&this.date.getUTCFullYear();var T=this.picker.find(".datepicker-months").find("th:eq(1)").text(r).end().find("span").removeClass("active");if(x&&x==r){T.eq(this.date.getUTCMonth()).addClass("active")}if(r<s||r>u){T.addClass("disabled")}if(r==s){T.slice(0,o).addClass("disabled")}if(r==u){T.slice(a+1).addClass("disabled")}m="";r=parseInt(r/10,10)*10;var N=this.picker.find(".datepicker-years").find("th:eq(1)").text(r+"-"+(r+9)).end().find("td");r-=1;for(var C=-1;C<11;C++){m+='<span class="year'+(C==-1?" old":C==10?" new":"")+(x==r?" active":"")+(r<s||r>u?" disabled":"")+'">'+r+"</span>";r+=1}N.html(m)},updateNavArrows:function(){if(!this._allow_update){return}var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:if(this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break;case 1:case 2:if(this.o.startDate!==-Infinity&&t<=this.o.startDate.getUTCFullYear()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.o.endDate!==Infinity&&t>=this.o.endDate.getUTCFullYear()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break}},click:function(n){n.preventDefault();var r=e(n.target).closest("span, td, th");if(r.length==1){switch(r[0].nodeName.toLowerCase()){case"th":switch(r[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var i=h.modes[this.viewMode].navStep*(r[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,i);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,i);break}this.fill();break;case"today":var s=new Date;s=t(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0);this.showMode(-2);var o=this.o.todayBtn=="linked"?null:"view";this._setDate(s,o);break;case"clear":var u;if(this.isInput){u=this.element}else{if(this.component){u=this.element.find("input")}}if(u){u.val("").change()}this._trigger("changeDate");this.update();if(this.o.autoclose){this.hide()}break}break;case"span":if(!r.is(".disabled")){this.viewDate.setUTCDate(1);if(r.is(".month")){var a=1;var f=r.parent().find("span").index(r);var l=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(f);this._trigger("changeMonth",this.viewDate);if(this.o.minViewMode===1){this._setDate(t(l,f,a,0,0,0,0))}}else{var l=parseInt(r.text(),10)||0;var a=1;var f=0;this.viewDate.setUTCFullYear(l);this._trigger("changeYear",this.viewDate);if(this.o.minViewMode===2){this._setDate(t(l,f,a,0,0,0,0))}}this.showMode(-1);this.fill()}break;case"td":if(r.is(".day")&&!r.is(".disabled")){var a=parseInt(r.text(),10)||1;var l=this.viewDate.getUTCFullYear(),f=this.viewDate.getUTCMonth();if(r.is(".old")){if(f===0){f=11;l-=1}else{f-=1}}else{if(r.is(".new")){if(f==11){f=0;l+=1}else{f+=1}}}this._setDate(t(l,f,a,0,0,0,0))}break}}},_setDate:function(e,t){if(!t||t=="date"){this.date=new Date(e)}if(!t||t=="view"){this.viewDate=new Date(e)}this.fill();this.setValue();this._trigger("changeDate");var n;if(this.isInput){n=this.element}else{if(this.component){n=this.element.find("input")}}if(n){n.change();if(this.o.autoclose&&(!t||t=="date")){this.hide()}}},moveMonth:function(e,t){if(!t){return e}var n=new Date(e.valueOf()),r=n.getUTCDate(),i=n.getUTCMonth(),s=Math.abs(t),o,u;t=t>0?1:-1;if(s==1){u=t==-1?function(){return n.getUTCMonth()==i}:function(){return n.getUTCMonth()!=o};o=i+t;n.setUTCMonth(o);if(o<0||o>11){o=(o+12)%12}}else{for(var a=0;a<s;a++){n=this.moveMonth(n,t)}o=n.getUTCMonth();n.setUTCDate(r);u=function(){return o!=n.getUTCMonth()}}while(u()){n.setUTCDate(--r);n.setUTCMonth(o)}return n},moveYear:function(e,t){return this.moveMonth(e,t*12)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)")){if(e.keyCode==27){this.show()}return}var t=false,n,r,i,s,o;switch(e.keyCode){case 27:this.hide();e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation){break}n=e.keyCode==37?-1:1;if(e.ctrlKey){s=this.moveYear(this.date,n);o=this.moveYear(this.viewDate,n)}else{if(e.shiftKey){s=this.moveMonth(this.date,n);o=this.moveMonth(this.viewDate,n)}else{s=new Date(this.date);s.setUTCDate(this.date.getUTCDate()+n);o=new Date(this.viewDate);o.setUTCDate(this.viewDate.getUTCDate()+n)}}if(this.dateWithinRange(s)){this.date=s;this.viewDate=o;this.setValue();this.update();e.preventDefault();t=true}break;case 38:case 40:if(!this.o.keyboardNavigation){break}n=e.keyCode==38?-1:1;if(e.ctrlKey){s=this.moveYear(this.date,n);o=this.moveYear(this.viewDate,n)}else{if(e.shiftKey){s=this.moveMonth(this.date,n);o=this.moveMonth(this.viewDate,n)}else{s=new Date(this.date);s.setUTCDate(this.date.getUTCDate()+n*7);o=new Date(this.viewDate);o.setUTCDate(this.viewDate.getUTCDate()+n*7)}}if(this.dateWithinRange(s)){this.date=s;this.viewDate=o;this.setValue();this.update();e.preventDefault();t=true}break;case 13:this.hide();e.preventDefault();break;case 9:this.hide();break}if(t){this._trigger("changeDate");var u;if(this.isInput){u=this.element}else{if(this.component){u=this.element.find("input")}}if(u){u.change()}}},showMode:function(e){if(e){this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))}this.picker.find(">div").hide().filter(".datepicker-"+h.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows()}};var i=function(t,n){this.element=e(t);this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e});delete n.inputs;e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this));this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")});this.updateDates()};i.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.date});this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){var n=e(t.target).data("datepicker"),r=n.getUTCDate(),i=e.inArray(t.target,this.inputs),s=this.inputs.length;if(i==-1){return}if(r<this.dates[i]){while(i>=0&&r<this.dates[i]){this.pickers[i--].setUTCDate(r)}}else{if(r>this.dates[i]){while(i<s&&r>this.dates[i]){this.pickers[i++].setUTCDate(r)}}}this.updateDates()},remove:function(){e.map(this.pickers,function(e){e.remove()});delete this.element.data().datepicker}};var u=e.fn.datepicker;var a=e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var u,a;this.each(function(){var a=e(this),l=a.data("datepicker"),c=typeof t=="object"&&t;if(!l){var h=s(this,"date"),p=e.extend({},f,h,c),d=o(p.language),v=e.extend({},f,d,h,c);if(a.is(".input-daterange")||v.inputs){var m={inputs:v.inputs||a.find("input").toArray()};a.data("datepicker",l=new i(this,e.extend(v,m)))}else{a.data("datepicker",l=new r(this,v))}}if(typeof t=="string"&&typeof l[t]=="function"){u=l[t].apply(l,n);if(u!==undefined){return false}}});if(u!==undefined){return u}else{return this}};var f=e.fn.datepicker.defaults={autoclose:false,beforeShowDay:e.noop,calendarWeeks:false,clearBtn:false,daysOfWeekDisabled:[],endDate:Infinity,forceParse:true,format:"mm/dd/yyyy",keyboardNavigation:true,language:"en",minViewMode:0,rtl:false,startDate:-Infinity,startView:0,todayBtn:false,todayHighlight:false,weekStart:0};var l=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=r;var c=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}};var h={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,h.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||n.length===0){throw new Error("Invalid date format.")}return{separators:t,parts:n}},parseDate:function(n,i,s){if(n instanceof Date){return n}if(typeof i==="string"){i=h.parseFormat(i)}if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(n)){var o=/([\-+]\d+)([dmwy])/,u=n.match(/([\-+]\d+)([dmwy])/g),a,f;n=new Date;for(var l=0;l<u.length;l++){a=o.exec(u[l]);f=parseInt(a[1]);switch(a[2]){case"d":n.setUTCDate(n.getUTCDate()+f);break;case"m":n=r.prototype.moveMonth.call(r.prototype,n,f);break;case"w":n.setUTCDate(n.getUTCDate()+f*7);break;case"y":n=r.prototype.moveYear.call(r.prototype,n,f);break}}return t(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0,0,0)}var u=n&&n.match(this.nonpunctuation)||[],n=new Date,p={},d=["yyyy","yy","M","MM","m","mm","d","dd"],v={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){t-=1;while(t<0){t+=12}t%=12;e.setUTCMonth(t);while(e.getUTCMonth()!=t){e.setUTCDate(e.getUTCDate()-1)}return e},d:function(e,t){return e.setUTCDate(t)}},m,g,a;v.M=v.MM=v.mm=v.m;v.dd=v.d;n=t(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var y=i.parts.slice();if(u.length!=y.length){y=e(y).filter(function(t,n){return e.inArray(n,d)!==-1}).toArray()}if(u.length==y.length){for(var l=0,b=y.length;l<b;l++){m=parseInt(u[l],10);a=y[l];if(isNaN(m)){switch(a){case"MM":g=e(c[s].months).filter(function(){var e=this.slice(0,u[l].length),t=u[l].slice(0,e.length);return e==t});m=e.inArray(g[0],c[s].months)+1;break;case"M":g=e(c[s].monthsShort).filter(function(){var e=this.slice(0,u[l].length),t=u[l].slice(0,e.length);return e==t});m=e.inArray(g[0],c[s].monthsShort)+1;break}}p[a]=m}for(var l=0,w;l<d.length;l++){w=d[l];if(w in p&&!isNaN(p[w])){v[w](n,p[w])}}}return n},formatDate:function(t,n,r){if(typeof n==="string"){n=h.parseFormat(n)}var i={d:t.getUTCDate(),D:c[r].daysShort[t.getUTCDay()],DD:c[r].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:c[r].monthsShort[t.getUTCMonth()],MM:c[r].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};i.dd=(i.d<10?"0":"")+i.d;i.mm=(i.m<10?"0":"")+i.m;var t=[],s=e.extend([],n.separators);for(var o=0,u=n.parts.length;o<=u;o++){if(s.length){t.push(s.shift())}t.push(i[n.parts[o]])}return t.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="datepicker-switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};h.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+h.headTemplate+"<tbody></tbody>"+h.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+"</table></div></div>";e.fn.datepicker.DPGlobal=h;e.fn.datepicker.noConflict=function(){e.fn.datepicker=u;return this};e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);if(n.data("datepicker")){return}t.preventDefault();a.call(n,"show")});e(function(){a.call(e('[data-provide="datepicker-inline"]'))})})(window.jQuery);(function(e){e.fn.bdatepicker=e.fn.datepicker.noConflict();if(!e.fn.datepicker){e.fn.datepicker=e.fn.bdatepicker}var t=function(e){this.init("date",e,t.defaults);this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{initPicker:function(t,n){if(!this.options.viewformat){this.options.viewformat=this.options.format}this.options.datepicker=e.extend({},n.datepicker,t.datepicker,{format:this.options.viewformat});this.options.datepicker.language=this.options.datepicker.language||"en";this.dpg=e.fn.bdatepicker.DPGlobal;this.parsedFormat=this.dpg.parseFormat(this.options.format);this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat)},render:function(){this.$input.bdatepicker(this.options.datepicker);if(this.options.clear){this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault();e.stopPropagation();this.clear()},this));this.$tpl.parent().append(e('<div class="editable-clear">').append(this.$clear))}},value2html:function(e,n){var r=e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):"";t.superclass.value2html(r,n)},html2value:function(e){return this.parseDate(e,this.parsedViewFormat)},value2str:function(e){return e?this.dpg.formatDate(e,this.parsedFormat,this.options.datepicker.language):""},str2value:function(e){return this.parseDate(e,this.parsedFormat)},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.bdatepicker("update",e)},input2value:function(){return this.$input.data("datepicker").date},activate:function(){},clear:function(){this.$input.data("datepicker").date=null;this.$input.find(".active").removeClass("active");if(!this.options.showbuttons){this.$input.closest("form").submit()}},autosubmit:function(){this.$input.on("mouseup",".day",function(t){if(e(t.currentTarget).is(".old")||e(t.currentTarget).is(".new")){return}var n=e(this).closest("form");setTimeout(function(){n.submit()},200)})},parseDate:function(e,t){var n=null,r;if(e){n=this.dpg.parseDate(e,t,this.options.datepicker.language);if(typeof e==="string"){r=this.dpg.formatDate(n,t,this.options.datepicker.language);if(e!==r){n=null}}}return n}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:false},clear:"&times; clear"});e.fn.editabletypes.date=t})(window.jQuery);(function(e){var t=function(e){this.init("datefield",e,t.defaults);this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.date);e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input");this.setClass();this.setAttr("placeholder");this.$tpl.bdatepicker(this.options.datepicker);this.$input.off("focus keydown");this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date");this.$tpl.bdatepicker("update")},this))},value2input:function(e){this.$input.val(e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):"");this.$tpl.bdatepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}});t.defaults=e.extend({},e.fn.editabletypes.date.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-small",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:true}});e.fn.editabletypes.datefield=t})(window.jQuery);(function(e){var t=function(e){this.init("datetime",e,t.defaults);this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{initPicker:function(t,n){if(!this.options.viewformat){this.options.viewformat=this.options.format}this.options.datetimepicker=e.extend({},n.datetimepicker,t.datetimepicker,{format:this.options.viewformat});this.options.datetimepicker.language=this.options.datetimepicker.language||"en";this.dpg=e.fn.datetimepicker.DPGlobal;this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType);this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker);this.$input.on("changeMode",function(t){var n=e(this).closest("form").parent();setTimeout(function(){n.triggerHandler("resize")},0)});if(this.options.clear){this.$clear=e('<a href="#"></a>').html(this.options.clear).click(e.proxy(function(e){e.preventDefault();e.stopPropagation();this.clear()},this));this.$tpl.parent().append(e('<div class="editable-clear">').append(this.$clear))}},value2html:function(e,n){var r=e?this.dpg.formatDate(this.toUTC(e),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):"";if(n){t.superclass.value2html(r,n)}else{return r}},html2value:function(e){var t=this.parseDate(e,this.parsedViewFormat);return t?this.fromUTC(t):null},value2str:function(e){return e?this.dpg.formatDate(this.toUTC(e),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):""},str2value:function(e){var t=this.parseDate(e,this.parsedFormat);return t?this.fromUTC(t):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){if(e){this.$input.data("datetimepicker").setDate(e)}},input2value:function(){var e=this.$input.data("datetimepicker");return e.date?e.getDate():null},activate:function(){},clear:function(){this.$input.data("datetimepicker").date=null;this.$input.find(".active").removeClass("active");if(!this.options.showbuttons){this.$input.closest("form").submit()}},autosubmit:function(){this.$input.on("mouseup",".minute",function(t){var n=e(this).closest("form");setTimeout(function(){n.submit()},200)})},toUTC:function(e){return e?new Date(e.valueOf()-e.getTimezoneOffset()*6e4):e},fromUTC:function(e){return e?new Date(e.valueOf()+e.getTimezoneOffset()*6e4):e},parseDate:function(e,t){var n=null,r;if(e){n=this.dpg.parseDate(e,t,this.options.datetimepicker.language,this.options.formatType);if(typeof e==="string"){r=this.dpg.formatDate(n,t,this.options.datetimepicker.language,this.options.formatType);if(e!==r){n=null}}}return n}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd hh:ii",formatType:"standard",viewformat:null,datetimepicker:{todayHighlight:false,autoclose:false},clear:"&times; clear"});e.fn.editabletypes.datetime=t})(window.jQuery);(function(e){var t=function(e){this.init("datetimefield",e,t.defaults);this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.datetime);e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input");this.setClass();this.setAttr("placeholder");this.$tpl.datetimepicker(this.options.datetimepicker);this.$input.off("focus keydown");this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date");this.$tpl.datetimepicker("update")},this))},value2input:function(e){this.$input.val(this.value2html(e));this.$tpl.datetimepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}});t.defaults=e.extend({},e.fn.editabletypes.datetime.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-medium",datetimepicker:{todayHighlight:false,autoclose:true}});e.fn.editabletypes.datetimefield=t})(window.jQuery);(function(e){var t=function(n){this.init("typeahead",n,t.defaults);this.options.typeahead=e.extend({},t.defaults.typeahead,{matcher:this.matcher,sorter:this.sorter,highlighter:this.highlighter,updater:this.updater},n.typeahead)};e.fn.editableutils.inherit(t,e.fn.editabletypes.list);e.extend(t.prototype,{renderList:function(){this.$input=this.$tpl.is("input")?this.$tpl:this.$tpl.find('input[type="text"]');this.options.typeahead.source=this.sourceData;this.$input.typeahead(this.options.typeahead);var t=this.$input.data("typeahead");t.render=e.proxy(this.typeaheadRender,t);t.select=e.proxy(this.typeaheadSelect,t);t.move=e.proxy(this.typeaheadMove,t);this.renderClear();this.setClass();this.setAttr("placeholder")},value2htmlFinal:function(t,n){if(this.getIsObjects()){var r=e.fn.editableutils.itemsByValue(t,this.sourceData);e(n).text(r.length?r[0].text:"")}else{e(n).text(t)}},html2value:function(e){return e?e:null},value2input:function(t){if(this.getIsObjects()){var n=e.fn.editableutils.itemsByValue(t,this.sourceData);this.$input.data("value",t).val(n.length?n[0].text:"")}else{this.$input.val(t)}},input2value:function(){if(this.getIsObjects()){var t=this.$input.data("value"),n=e.fn.editableutils.itemsByValue(t,this.sourceData);if(n.length&&n[0].text.toLowerCase()===this.$input.val().toLowerCase()){return t}else{return null}}else{return this.$input.val()}},getIsObjects:function(){if(this.isObjects===undefined){this.isObjects=false;for(var e=0;e<this.sourceData.length;e++){if(this.sourceData[e].value!==this.sourceData[e].text){this.isObjects=true;break}}}return this.isObjects},activate:e.fn.editabletypes.text.prototype.activate,renderClear:e.fn.editabletypes.text.prototype.renderClear,postrender:e.fn.editabletypes.text.prototype.postrender,toggleClear:e.fn.editabletypes.text.prototype.toggleClear,clear:function(){e.fn.editabletypes.text.prototype.clear.call(this);this.$input.data("value","")},matcher:function(t){return e.fn.typeahead.Constructor.prototype.matcher.call(this,t.text)},sorter:function(e){var t=[],n=[],r=[],i,s;while(i=e.shift()){s=i.text;if(!s.toLowerCase().indexOf(this.query.toLowerCase())){t.push(i)}else{if(~s.indexOf(this.query)){n.push(i)}else{r.push(i)}}}return t.concat(n,r)},highlighter:function(t){return e.fn.typeahead.Constructor.prototype.highlighter.call(this,t.text)},updater:function(e){this.$element.data("value",e.value);return e.text},typeaheadRender:function(t){var n=this;t=e(t).map(function(t,r){t=e(n.options.item).data("item",r);t.find("a").html(n.highlighter(r));return t[0]});if(this.options.autoSelect){t.first().addClass("active")}this.$menu.html(t);return this},typeaheadSelect:function(){var e=this.$menu.find(".active").data("item");if(this.options.autoSelect||e){this.$element.val(this.updater(e)).change()}return this.hide()},typeaheadMove:function(e){if(!this.shown){return}switch(e.keyCode){case 9:case 13:case 27:if(!this.$menu.find(".active").length){return}e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break}e.stopPropagation()}});t.defaults=e.extend({},e.fn.editabletypes.list.defaults,{tpl:'<input type="text">',typeahead:null,clear:true});e.fn.editabletypes.typeahead=t})(window.jQuery);(function(e){var t=function(e){this.init("address",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput);e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input")},value2html:function(t,n){if(!t){e(n).empty();return}var r=e("<div>").text(t.city).html()+", "+e("<div>").text(t.street).html()+" st., bld. "+e("<div>").text(t.building).html();e(n).html(r)},html2value:function(e){return null},value2str:function(e){var t="";if(e){for(var n in e){t=t+n+":"+e[n]+";"}}return t},str2value:function(e){return e},value2input:function(e){if(!e){return}this.$input.filter('[name="city"]').val(e.city);this.$input.filter('[name="street"]').val(e.street);this.$input.filter('[name="building"]').val(e.building)},input2value:function(){return{city:this.$input.filter('[name="city"]').val(),street:this.$input.filter('[name="street"]').val(),building:this.$input.filter('[name="building"]').val()}},activate:function(){this.$input.filter('[name="city"]').focus()},autosubmit:function(){this.$input.keydown(function(t){if(t.which===13){e(this).closest("form").submit()}})}});t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-address"><label><span>City: </span><input type="text" name="city" class="input-small"></label></div><div class="editable-address"><label><span>Street: </span><input type="text" name="street" class="input-small"></label></div><div class="editable-address"><label><span>Building: </span><input type="text" name="building" class="input-mini"></label></div>',inputclass:""});e.fn.editabletypes.address=t})(window.jQuery);(function(e){e.color={};e.color.make=function(t,n,r,i){var s={};s.r=t||0;s.g=n||0;s.b=r||0;s.a=i!=null?i:1;s.add=function(e,t){for(var n=0;n<e.length;++n){s[e.charAt(n)]+=t}return s.normalize()};s.scale=function(e,t){for(var n=0;n<e.length;++n){s[e.charAt(n)]*=t}return s.normalize()};s.toString=function(){if(s.a>=1){return"rgb("+[s.r,s.g,s.b].join(",")+")"}else{return"rgba("+[s.r,s.g,s.b,s.a].join(",")+")"}};s.normalize=function(){function e(e,t,n){return t<e?e:t>n?n:t}s.r=e(0,parseInt(s.r),255);s.g=e(0,parseInt(s.g),255);s.b=e(0,parseInt(s.b),255);s.a=e(0,s.a,1);return s};s.clone=function(){return e.color.make(s.r,s.b,s.g,s.a)};return s.normalize()};e.color.extract=function(t,n){var r;do{r=t.css(n).toLowerCase();if(r!=""&&r!="transparent"){break}t=t.parent()}while(!e.nodeName(t.get(0),"body"));if(r=="rgba(0, 0, 0, 0)"){r="transparent"}return e.color.parse(r)};e.color.parse=function(n){var r,i=e.color.make;if(r=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n)){return i(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10))}if(r=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n)){return i(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),parseFloat(r[4]))}if(r=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n)){return i(parseFloat(r[1])*2.55,parseFloat(r[2])*2.55,parseFloat(r[3])*2.55)}if(r=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n)){return i(parseFloat(r[1])*2.55,parseFloat(r[2])*2.55,parseFloat(r[3])*2.55,parseFloat(r[4]))}if(r=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n)){return i(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16))}if(r=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n)){return i(parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16))}var s=e.trim(n).toLowerCase();if(s=="transparent"){return i(255,255,255,0)}else{r=t[s]||[0,0,0];return i(r[0],r[1],r[2])}};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);(function(e){function n(t,n){var r=n.children("."+t)[0];if(r==null){r=document.createElement("canvas");r.className=t;e(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(n);if(!r.getContext){if(window.G_vmlCanvasManager){r=window.G_vmlCanvasManager.initElement(r)}else{throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.")}}}this.element=r;var i=this.context=r.getContext("2d");var s=window.devicePixelRatio||1,o=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1;this.pixelRatio=s/o;this.resize(n.width(),n.height());this.textContainer=null;this.text={};this._textCache={}}function r(t,r,s,o){function T(e,t){t=[x].concat(t);for(var n=0;n<e.length;++n){e[n].apply(this,t)}}function N(){var t={Canvas:n};for(var r=0;r<o.length;++r){var i=o[r];i.init(x,t);if(i.options){e.extend(true,a,i.options)}}}function C(n){e.extend(true,a,n);if(n&&n.colors){a.colors=n.colors}if(a.xaxis.color==null){a.xaxis.color=e.color.parse(a.grid.color).scale("a",.22).toString()}if(a.yaxis.color==null){a.yaxis.color=e.color.parse(a.grid.color).scale("a",.22).toString()}if(a.xaxis.tickColor==null){a.xaxis.tickColor=a.grid.tickColor||a.xaxis.color}if(a.yaxis.tickColor==null){a.yaxis.tickColor=a.grid.tickColor||a.yaxis.color}if(a.grid.borderColor==null){a.grid.borderColor=a.grid.color}if(a.grid.tickColor==null){a.grid.tickColor=e.color.parse(a.grid.color).scale("a",.22).toString()}var r,i,s,o={style:t.css("font-style"),size:Math.round(.8*(+t.css("font-size").replace("px","")||13)),variant:t.css("font-variant"),weight:t.css("font-weight"),family:t.css("font-family")};o.lineHeight=o.size*1.15;s=a.xaxes.length||1;for(r=0;r<s;++r){i=a.xaxes[r];if(i&&!i.tickColor){i.tickColor=i.color}i=e.extend(true,{},a.xaxis,i);a.xaxes[r]=i;if(i.font){i.font=e.extend({},o,i.font);if(!i.font.color){i.font.color=i.color}}}s=a.yaxes.length||1;for(r=0;r<s;++r){i=a.yaxes[r];if(i&&!i.tickColor){i.tickColor=i.color}i=e.extend(true,{},a.yaxis,i);a.yaxes[r]=i;if(i.font){i.font=e.extend({},o,i.font);if(!i.font.color){i.font.color=i.color}}}if(a.xaxis.noTicks&&a.xaxis.ticks==null){a.xaxis.ticks=a.xaxis.noTicks}if(a.yaxis.noTicks&&a.yaxis.ticks==null){a.yaxis.ticks=a.yaxis.noTicks}if(a.x2axis){a.xaxes[1]=e.extend(true,{},a.xaxis,a.x2axis);a.xaxes[1].position="top"}if(a.y2axis){a.yaxes[1]=e.extend(true,{},a.yaxis,a.y2axis);a.yaxes[1].position="right"}if(a.grid.coloredAreas){a.grid.markings=a.grid.coloredAreas}if(a.grid.coloredAreasColor){a.grid.markingsColor=a.grid.coloredAreasColor}if(a.lines){e.extend(true,a.series.lines,a.lines)}if(a.points){e.extend(true,a.series.points,a.points)}if(a.bars){e.extend(true,a.series.bars,a.bars)}if(a.shadowSize!=null){a.series.shadowSize=a.shadowSize}if(a.highlightColor!=null){a.series.highlightColor=a.highlightColor}for(r=0;r<a.xaxes.length;++r){D(m,r+1).options=a.xaxes[r]}for(r=0;r<a.yaxes.length;++r){D(g,r+1).options=a.yaxes[r]}for(var u in S){if(a.hooks[u]&&a.hooks[u].length){S[u]=S[u].concat(a.hooks[u])}}T(S.processOptions,[a])}function k(e){u=L(e);P();H()}function L(t){var n=[];for(var r=0;r<t.length;++r){var i=e.extend(true,{},a.series);if(t[r].data!=null){i.data=t[r].data;delete t[r].data;e.extend(true,i,t[r]);t[r].data=i.data}else{i.data=t[r]}n.push(i)}return n}function A(e,t){var n=e[t+"axis"];if(typeof n=="object"){n=n.n}if(typeof n!="number"){n=1}return n}function O(){return e.grep(m.concat(g),function(e){return e})}function M(e){var t={},n,r;for(n=0;n<m.length;++n){r=m[n];if(r&&r.used){t["x"+r.n]=r.c2p(e.left)}}for(n=0;n<g.length;++n){r=g[n];if(r&&r.used){t["y"+r.n]=r.c2p(e.top)}}if(t.x1!==undefined){t.x=t.x1}if(t.y1!==undefined){t.y=t.y1}return t}function _(e){var t={},n,r,i;for(n=0;n<m.length;++n){r=m[n];if(r&&r.used){i="x"+r.n;if(e[i]==null&&r.n==1){i="x"}if(e[i]!=null){t.left=r.p2c(e[i]);break}}}for(n=0;n<g.length;++n){r=g[n];if(r&&r.used){i="y"+r.n;if(e[i]==null&&r.n==1){i="y"}if(e[i]!=null){t.top=r.p2c(e[i]);break}}}return t}function D(t,n){if(!t[n-1]){t[n-1]={n:n,direction:t==m?"x":"y",options:e.extend(true,{},t==m?a.xaxis:a.yaxis)}}return t[n-1]}function P(){var t=u.length,n=-1,r;for(r=0;r<u.length;++r){var i=u[r].color;if(i!=null){t--;if(typeof i=="number"&&i>n){n=i}}}if(t<=n){t=n+1}var s,o=[],l=a.colors,c=l.length,h=0;for(r=0;r<t;r++){s=e.color.parse(l[r%c]||"#666");if(r%c==0&&r){if(h>=0){if(h<.5){h=-h-.2}else{h=0}}else{h=-h}}o[r]=s.scale("rgb",1+h)}var p=0,d;for(r=0;r<u.length;++r){d=u[r];if(d.color==null){d.color=o[p].toString();++p}else{if(typeof d.color=="number"){d.color=o[d.color].toString()}}if(d.lines.show==null){var v,y=true;for(v in d){if(d[v]&&d[v].show){y=false;break}}if(y){d.lines.show=true}}if(d.lines.zero==null){d.lines.zero=!!d.lines.fill}d.xaxis=D(m,A(d,"x"));d.yaxis=D(g,A(d,"y"))}}function H(){function x(e,t,n){if(t<e.datamin&&t!=-r){e.datamin=t}if(n>e.datamax&&n!=r){e.datamax=n}}var t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=Number.MAX_VALUE,i,s,o,a,l,c,h,p,d,v,m,g,y,b,w,E;e.each(O(),function(e,r){r.datamin=t;r.datamax=n;r.used=false});for(i=0;i<u.length;++i){c=u[i];c.datapoints={points:[]};T(S.processRawData,[c,c.data,c.datapoints])}for(i=0;i<u.length;++i){c=u[i];w=c.data;E=c.datapoints.format;if(!E){E=[];E.push({x:true,number:true,required:true});E.push({y:true,number:true,required:true});if(c.bars.show||c.lines.show&&c.lines.fill){var N=!!(c.bars.show&&c.bars.zero||c.lines.show&&c.lines.zero);E.push({y:true,number:true,required:false,defaultValue:0,autoscale:N});if(c.bars.horizontal){delete E[E.length-1].y;E[E.length-1].x=true}}c.datapoints.format=E}if(c.datapoints.pointsize!=null){continue}c.datapoints.pointsize=E.length;p=c.datapoints.pointsize;h=c.datapoints.points;var C=c.lines.show&&c.lines.steps;c.xaxis.used=c.yaxis.used=true;for(s=o=0;s<w.length;++s,o+=p){b=w[s];var k=b==null;if(!k){for(a=0;a<p;++a){g=b[a];y=E[a];if(y){if(y.number&&g!=null){g=+g;if(isNaN(g)){g=null}else{if(g==Infinity){g=r}else{if(g==-Infinity){g=-r}}}}if(g==null){if(y.required){k=true}if(y.defaultValue!=null){g=y.defaultValue}}}h[o+a]=g}}if(k){for(a=0;a<p;++a){g=h[o+a];if(g!=null){y=E[a];if(y.autoscale){if(y.x){x(c.xaxis,g,g)}if(y.y){x(c.yaxis,g,g)}}}h[o+a]=null}}else{if(C&&o>0&&h[o-p]!=null&&h[o-p]!=h[o]&&h[o-p+1]!=h[o+1]){for(a=0;a<p;++a){h[o+p+a]=h[o+a]}h[o+1]=h[o-p+1];o+=p}}}}for(i=0;i<u.length;++i){c=u[i];T(S.processDatapoints,[c,c.datapoints])}for(i=0;i<u.length;++i){c=u[i];h=c.datapoints.points;p=c.datapoints.pointsize;E=c.datapoints.format;var L=t,A=t,M=n,_=n;for(s=0;s<h.length;s+=p){if(h[s]==null){continue}for(a=0;a<p;++a){g=h[s+a];y=E[a];if(!y||y.autoscale===false||g==r||g==-r){continue}if(y.x){if(g<L){L=g}if(g>M){M=g}}if(y.y){if(g<A){A=g}if(g>_){_=g}}}}if(c.bars.show){var D;switch(c.bars.align){case"left":D=0;break;case"right":D=-c.bars.barWidth;break;case"center":D=-c.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+c.bars.align)}if(c.bars.horizontal){A+=D;_+=D+c.bars.barWidth}else{L+=D;M+=D+c.bars.barWidth}}x(c.xaxis,L,M);x(c.yaxis,A,_)}e.each(O(),function(e,r){if(r.datamin==t){r.datamin=null}if(r.datamax==n){r.datamax=null}})}function B(){t.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove();if(t.css("position")=="static"){t.css("position","relative")}l=new n("flot-base",t);h=new n("flot-overlay",t);d=l.context;v=h.context;p=e(h.element).unbind();var r=t.data("plot");if(r){r.shutdown();h.clear()}t.data("plot",x)}function j(){if(a.grid.hoverable){p.mousemove(lt);p.bind("mouseleave",ct)}if(a.grid.clickable){p.click(ht)}T(S.bindEvents,[p])}function F(){if(at){clearTimeout(at)}p.unbind("mousemove",lt);p.unbind("mouseleave",ct);p.unbind("click",ht);T(S.shutdown,[p])}function I(e){function t(e){return e}var n,r,i=e.options.transform||t,s=e.options.inverseTransform;if(e.direction=="x"){n=e.scale=w/Math.abs(i(e.max)-i(e.min));r=Math.min(i(e.max),i(e.min))}else{n=e.scale=E/Math.abs(i(e.max)-i(e.min));n=-n;r=Math.max(i(e.max),i(e.min))}if(i==t){e.p2c=function(e){return(e-r)*n}}else{e.p2c=function(e){return(i(e)-r)*n}}if(!s){e.c2p=function(e){return r+e/n}}else{e.c2p=function(e){return s(r+e/n)}}}function q(e){var t=e.options,n=e.ticks||[],r=t.labelWidth||0,i=t.labelHeight||0,s=r||e.direction=="x"?Math.floor(l.width/(n.length||1)):null;legacyStyles=e.direction+"Axis "+e.direction+e.n+"Axis",layer="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+legacyStyles,font=t.font||"flot-tick-label tickLabel";for(var o=0;o<n.length;++o){var u=n[o];if(!u.label){continue}var a=l.getTextInfo(layer,u.label,font,null,s);r=Math.max(r,a.width);i=Math.max(i,a.height)}e.labelWidth=t.labelWidth||r;e.labelHeight=t.labelHeight||i}function R(t){var n=t.labelWidth,r=t.labelHeight,i=t.options.position,s=t.options.tickLength,o=a.grid.axisMargin,u=a.grid.labelMargin,c=t.direction=="x"?m:g,h,p;var d=e.grep(c,function(e){return e&&e.options.position==i&&e.reserveSpace});if(e.inArray(t,d)==d.length-1){o=0}if(s==null){var v=e.grep(c,function(e){return e&&e.reserveSpace});p=e.inArray(t,v)==0;if(p){s="full"}else{s=5}}if(!isNaN(+s)){u+=+s}if(t.direction=="x"){r+=u;if(i=="bottom"){y.bottom+=r+o;t.box={top:l.height-y.bottom,height:r}}else{t.box={top:y.top+o,height:r};y.top+=r+o}}else{n+=u;if(i=="left"){t.box={left:y.left+o,width:n};y.left+=n+o}else{y.right+=n+o;t.box={left:l.width-y.right,width:n}}}t.position=i;t.tickLength=s;t.box.padding=u;t.innermost=p}function U(e){if(e.direction=="x"){e.box.left=y.left-e.labelWidth/2;e.box.width=l.width-y.left-y.right+e.labelWidth}else{e.box.top=y.top-e.labelHeight/2;e.box.height=l.height-y.bottom-y.top+e.labelHeight}}function z(){var t=a.grid.minBorderMargin,n={x:0,y:0},r,i;if(t==null){t=0;for(r=0;r<u.length;++r){t=Math.max(t,2*(u[r].points.radius+u[r].points.lineWidth/2))}}n.x=n.y=Math.ceil(t);e.each(O(),function(e,t){var r=t.direction;if(t.reserveSpace){n[r]=Math.ceil(Math.max(n[r],(r=="x"?t.labelWidth:t.labelHeight)/2))}});y.left=Math.max(n.x,y.left);y.right=Math.max(n.x,y.right);y.top=Math.max(n.y,y.top);y.bottom=Math.max(n.y,y.bottom)}function W(){var t,n=O(),r=a.grid.show;for(var i in y){var s=a.grid.margin||0;y[i]=typeof s=="number"?s:s[i]||0}T(S.processOffset,[y]);for(var i in y){if(typeof a.grid.borderWidth=="object"){y[i]+=r?a.grid.borderWidth[i]:0}else{y[i]+=r?a.grid.borderWidth:0}}e.each(n,function(e,t){t.show=t.options.show;if(t.show==null){t.show=t.used}t.reserveSpace=t.show||t.options.reserveSpace;X(t)});if(r){var o=e.grep(n,function(e){return e.reserveSpace});e.each(o,function(e,t){V(t);$(t);J(t,t.ticks);q(t)});for(t=o.length-1;t>=0;--t){R(o[t])}z();e.each(o,function(e,t){U(t)})}w=l.width-y.left-y.right;E=l.height-y.bottom-y.top;e.each(n,function(e,t){I(t)});if(r){Z()}ot()}function X(e){var t=e.options,n=+(t.min!=null?t.min:e.datamin),r=+(t.max!=null?t.max:e.datamax),i=r-n;if(i==0){var s=r==0?1:.01;if(t.min==null){n-=s}if(t.max==null||t.min!=null){r+=s}}else{var o=t.autoscaleMargin;if(o!=null){if(t.min==null){n-=i*o;if(n<0&&e.datamin!=null&&e.datamin>=0){n=0}}if(t.max==null){r+=i*o;if(r>0&&e.datamax!=null&&e.datamax<=0){r=0}}}}e.min=n;e.max=r}function V(t){var n=t.options;var r;if(typeof n.ticks=="number"&&n.ticks>0){r=n.ticks}else{r=.3*Math.sqrt(t.direction=="x"?l.width:l.height)}var s=(t.max-t.min)/r,o=-Math.floor(Math.log(s)/Math.LN10),u=n.tickDecimals;if(u!=null&&o>u){o=u}var a=Math.pow(10,-o),h=s/a,p;if(h<1.5){p=1}else{if(h<3){p=2;if(h>2.25&&(u==null||o+1<=u)){p=2.5;++o}}else{if(h<7.5){p=5}else{p=10}}}p*=a;if(n.minTickSize!=null&&p<n.minTickSize){p=n.minTickSize}t.delta=s;t.tickDecimals=Math.max(0,u!=null?u:o);t.tickSize=n.tickSize||p;if(n.mode=="time"&&!t.tickGenerator){throw new Error("Time mode requires the flot.time plugin.")}if(!t.tickGenerator){t.tickGenerator=function(e){var t=[],n=i(e.min,e.tickSize),r=0,s=Number.NaN,o;do{o=s;s=n+r*e.tickSize;t.push(s);++r}while(s<e.max&&s!=o);return t};t.tickFormatter=function(e,t){var n=t.tickDecimals?Math.pow(10,t.tickDecimals):1;var r=""+Math.round(e*n)/n;if(t.tickDecimals!=null){var i=r.indexOf(".");var s=i==-1?0:r.length-i-1;if(s<t.tickDecimals){return(s?r:r+".")+(""+n).substr(1,t.tickDecimals-s)}}return r}}if(e.isFunction(n.tickFormatter)){t.tickFormatter=function(e,t){return""+n.tickFormatter(e,t)}}if(n.alignTicksWithAxis!=null){var d=(t.direction=="x"?m:g)[n.alignTicksWithAxis-1];if(d&&d.used&&d!=t){var v=t.tickGenerator(t);if(v.length>0){if(n.min==null){t.min=Math.min(t.min,v[0])}if(n.max==null&&v.length>1){t.max=Math.max(t.max,v[v.length-1])}}t.tickGenerator=function(e){var t=[],n,r;for(r=0;r<d.ticks.length;++r){n=(d.ticks[r].v-d.min)/(d.max-d.min);n=e.min+n*(e.max-e.min);t.push(n)}return t};if(!t.mode&&n.tickDecimals==null){var y=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),b=t.tickGenerator(t);if(!(b.length>1&&/\..*0$/.test((b[1]-b[0]).toFixed(y)))){t.tickDecimals=y}}}}}function $(t){var n=t.options.ticks,r=[];if(n==null||typeof n=="number"&&n>0){r=t.tickGenerator(t)}else{if(n){if(e.isFunction(n)){r=n(t)}else{r=n}}}var i,s;t.ticks=[];for(i=0;i<r.length;++i){var o=null;var u=r[i];if(typeof u=="object"){s=+u[0];if(u.length>1){o=u[1]}}else{s=+u}if(o==null){o=t.tickFormatter(s,t)}if(!isNaN(s)){t.ticks.push({v:s,label:o})}}}function J(e,t){if(e.options.autoscaleMargin&&t.length>0){if(e.options.min==null){e.min=Math.min(e.min,t[0].v)}if(e.options.max==null&&t.length>1){e.max=Math.max(e.max,t[t.length-1].v)}}}function K(){l.clear();T(S.drawBackground,[d]);var e=a.grid;if(e.show&&e.backgroundColor){G()}if(e.show&&!e.aboveData){Y()}for(var t=0;t<u.length;++t){T(S.drawSeries,[d,u[t]]);et(u[t])}T(S.draw,[d]);if(e.show&&e.aboveData){Y()}l.render();dt()}function Q(e,t){var n,r,i,s,o=O();for(var u=0;u<o.length;++u){n=o[u];if(n.direction==t){s=t+n.n+"axis";if(!e[s]&&n.n==1){s=t+"axis"}if(e[s]){r=e[s].from;i=e[s].to;break}}}if(!e[s]){n=t=="x"?m[0]:g[0];r=e[t+"1"];i=e[t+"2"]}if(r!=null&&i!=null&&r>i){var a=r;r=i;i=a}return{from:r,to:i,axis:n}}function G(){d.save();d.translate(y.left,y.top);d.fillStyle=Et(a.grid.backgroundColor,E,0,"rgba(255, 255, 255, 0)");d.fillRect(0,0,w,E);d.restore()}function Y(){var t,n,r,i;d.save();d.translate(y.left,y.top);var s=a.grid.markings;if(s){if(e.isFunction(s)){n=x.getAxes();n.xmin=n.xaxis.min;n.xmax=n.xaxis.max;n.ymin=n.yaxis.min;n.ymax=n.yaxis.max;s=s(n)}for(t=0;t<s.length;++t){var o=s[t],u=Q(o,"x"),l=Q(o,"y");if(u.from==null){u.from=u.axis.min}if(u.to==null){u.to=u.axis.max}if(l.from==null){l.from=l.axis.min}if(l.to==null){l.to=l.axis.max}if(u.to<u.axis.min||u.from>u.axis.max||l.to<l.axis.min||l.from>l.axis.max){continue}u.from=Math.max(u.from,u.axis.min);u.to=Math.min(u.to,u.axis.max);l.from=Math.max(l.from,l.axis.min);l.to=Math.min(l.to,l.axis.max);if(u.from==u.to&&l.from==l.to){continue}u.from=u.axis.p2c(u.from);u.to=u.axis.p2c(u.to);l.from=l.axis.p2c(l.from);l.to=l.axis.p2c(l.to);if(u.from==u.to||l.from==l.to){d.beginPath();d.strokeStyle=o.color||a.grid.markingsColor;d.lineWidth=o.lineWidth||a.grid.markingsLineWidth;d.moveTo(u.from,l.from);d.lineTo(u.to,l.to);d.stroke()}else{d.fillStyle=o.color||a.grid.markingsColor;d.fillRect(u.from,l.to,u.to-u.from,l.from-l.to)}}}n=O();r=a.grid.borderWidth;for(var c=0;c<n.length;++c){var h=n[c],p=h.box,v=h.tickLength,m,g,b,S;if(!h.show||h.ticks.length==0){continue}d.lineWidth=1;if(h.direction=="x"){m=0;if(v=="full"){g=h.position=="top"?0:E}else{g=p.top-y.top+(h.position=="top"?p.height:0)}}else{g=0;if(v=="full"){m=h.position=="left"?0:w}else{m=p.left-y.left+(h.position=="left"?p.width:0)}}if(!h.innermost){d.strokeStyle=h.options.color;d.beginPath();b=S=0;if(h.direction=="x"){b=w+1}else{S=E+1}if(d.lineWidth==1){if(h.direction=="x"){g=Math.floor(g)+.5}else{m=Math.floor(m)+.5}}d.moveTo(m,g);d.lineTo(m+b,g+S);d.stroke()}d.strokeStyle=h.options.tickColor;d.beginPath();for(t=0;t<h.ticks.length;++t){var T=h.ticks[t].v;b=S=0;if(isNaN(T)||T<h.min||T>h.max||v=="full"&&(typeof r=="object"&&r[h.position]>0||r>0)&&(T==h.min||T==h.max)){continue}if(h.direction=="x"){m=h.p2c(T);S=v=="full"?-E:v;if(h.position=="top"){S=-S}}else{g=h.p2c(T);b=v=="full"?-w:v;if(h.position=="left"){b=-b}}if(d.lineWidth==1){if(h.direction=="x"){m=Math.floor(m)+.5}else{g=Math.floor(g)+.5}}d.moveTo(m,g);d.lineTo(m+b,g+S)}d.stroke()}if(r){i=a.grid.borderColor;if(typeof r=="object"||typeof i=="object"){if(typeof r!=="object"){r={top:r,right:r,bottom:r,left:r}}if(typeof i!=="object"){i={top:i,right:i,bottom:i,left:i}}if(r.top>0){d.strokeStyle=i.top;d.lineWidth=r.top;d.beginPath();d.moveTo(0-r.left,0-r.top/2);d.lineTo(w,0-r.top/2);d.stroke()}if(r.right>0){d.strokeStyle=i.right;d.lineWidth=r.right;d.beginPath();d.moveTo(w+r.right/2,0-r.top);d.lineTo(w+r.right/2,E);d.stroke()}if(r.bottom>0){d.strokeStyle=i.bottom;d.lineWidth=r.bottom;d.beginPath();d.moveTo(w+r.right,E+r.bottom/2);d.lineTo(0,E+r.bottom/2);d.stroke()}if(r.left>0){d.strokeStyle=i.left;d.lineWidth=r.left;d.beginPath();d.moveTo(0-r.left/2,E+r.bottom);d.lineTo(0-r.left/2,0);d.stroke()}}else{d.lineWidth=r;d.strokeStyle=a.grid.borderColor;d.strokeRect(-r/2,-r/2,w+r,E+r)}}d.restore()}function Z(){e.each(O(),function(e,t){if(!t.show||t.ticks.length==0){return}var n=t.box,r=t.direction+"Axis "+t.direction+t.n+"Axis",i="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+r,s=t.options.font||"flot-tick-label tickLabel",o,u,a,f,c;l.removeText(i);for(var h=0;h<t.ticks.length;++h){o=t.ticks[h];if(!o.label||o.v<t.min||o.v>t.max){continue}if(t.direction=="x"){f="center";u=y.left+t.p2c(o.v);if(t.position=="bottom"){a=n.top+n.padding}else{a=n.top+n.height-n.padding;c="bottom"}}else{c="middle";a=y.top+t.p2c(o.v);if(t.position=="left"){u=n.left+n.width-n.padding;f="right"}else{u=n.left+n.padding}}l.addText(i,u,a,o.label,s,null,null,f,c)}})}function et(e){if(e.lines.show){tt(e)}if(e.bars.show){it(e)}if(e.points.show){nt(e)}}function tt(e){function t(e,t,n,r,i){var s=e.points,o=e.pointsize,u=null,a=null;d.beginPath();for(var f=o;f<s.length;f+=o){var l=s[f-o],c=s[f-o+1],h=s[f],p=s[f+1];if(l==null||h==null){continue}if(c<=p&&c<i.min){if(p<i.min){continue}l=(i.min-c)/(p-c)*(h-l)+l;c=i.min}else{if(p<=c&&p<i.min){if(c<i.min){continue}h=(i.min-c)/(p-c)*(h-l)+l;p=i.min}}if(c>=p&&c>i.max){if(p>i.max){continue}l=(i.max-c)/(p-c)*(h-l)+l;c=i.max}else{if(p>=c&&p>i.max){if(c>i.max){continue}h=(i.max-c)/(p-c)*(h-l)+l;p=i.max}}if(l<=h&&l<r.min){if(h<r.min){continue}c=(r.min-l)/(h-l)*(p-c)+c;l=r.min}else{if(h<=l&&h<r.min){if(l<r.min){continue}p=(r.min-l)/(h-l)*(p-c)+c;h=r.min}}if(l>=h&&l>r.max){if(h>r.max){continue}c=(r.max-l)/(h-l)*(p-c)+c;l=r.max}else{if(h>=l&&h>r.max){if(l>r.max){continue}p=(r.max-l)/(h-l)*(p-c)+c;h=r.max}}if(l!=u||c!=a){d.moveTo(r.p2c(l)+t,i.p2c(c)+n)}u=h;a=p;d.lineTo(r.p2c(h)+t,i.p2c(p)+n)}d.stroke()}function n(e,t,n){var r=e.points,i=e.pointsize,s=Math.min(Math.max(0,n.min),n.max),o=0,u,a=false,f=1,l=0,c=0;while(true){if(i>0&&o>r.length+i){break}o+=i;var h=r[o-i],p=r[o-i+f],v=r[o],m=r[o+f];if(a){if(i>0&&h!=null&&v==null){c=o;i=-i;f=2;continue}if(i<0&&o==l+i){d.fill();a=false;i=-i;f=1;o=l=c+i;continue}}if(h==null||v==null){continue}if(h<=v&&h<t.min){if(v<t.min){continue}p=(t.min-h)/(v-h)*(m-p)+p;h=t.min}else{if(v<=h&&v<t.min){if(h<t.min){continue}m=(t.min-h)/(v-h)*(m-p)+p;v=t.min}}if(h>=v&&h>t.max){if(v>t.max){continue}p=(t.max-h)/(v-h)*(m-p)+p;h=t.max}else{if(v>=h&&v>t.max){if(h>t.max){continue}m=(t.max-h)/(v-h)*(m-p)+p;v=t.max}}if(!a){d.beginPath();d.moveTo(t.p2c(h),n.p2c(s));a=true}if(p>=n.max&&m>=n.max){d.lineTo(t.p2c(h),n.p2c(n.max));d.lineTo(t.p2c(v),n.p2c(n.max));continue}else{if(p<=n.min&&m<=n.min){d.lineTo(t.p2c(h),n.p2c(n.min));d.lineTo(t.p2c(v),n.p2c(n.min));continue}}var g=h,y=v;if(p<=m&&p<n.min&&m>=n.min){h=(n.min-p)/(m-p)*(v-h)+h;p=n.min}else{if(m<=p&&m<n.min&&p>=n.min){v=(n.min-p)/(m-p)*(v-h)+h;m=n.min}}if(p>=m&&p>n.max&&m<=n.max){h=(n.max-p)/(m-p)*(v-h)+h;p=n.max}else{if(m>=p&&m>n.max&&p<=n.max){v=(n.max-p)/(m-p)*(v-h)+h;m=n.max}}if(h!=g){d.lineTo(t.p2c(g),n.p2c(p))}d.lineTo(t.p2c(h),n.p2c(p));d.lineTo(t.p2c(v),n.p2c(m));if(v!=y){d.lineTo(t.p2c(v),n.p2c(m));d.lineTo(t.p2c(y),n.p2c(m))}}}d.save();d.translate(y.left,y.top);d.lineJoin="round";var r=e.lines.lineWidth,i=e.shadowSize;if(r>0&&i>0){d.lineWidth=i;d.strokeStyle="rgba(0,0,0,0.1)";var s=Math.PI/18;t(e.datapoints,Math.sin(s)*(r/2+i/2),Math.cos(s)*(r/2+i/2),e.xaxis,e.yaxis);d.lineWidth=i/2;t(e.datapoints,Math.sin(s)*(r/2+i/4),Math.cos(s)*(r/2+i/4),e.xaxis,e.yaxis)}d.lineWidth=r;d.strokeStyle=e.color;var o=st(e.lines,e.color,0,E);if(o){d.fillStyle=o;n(e.datapoints,e.xaxis,e.yaxis)}if(r>0){t(e.datapoints,0,0,e.xaxis,e.yaxis)}d.restore()}function nt(e){function t(e,t,n,r,i,s,o,u){var a=e.points,f=e.pointsize;for(var l=0;l<a.length;l+=f){var c=a[l],h=a[l+1];if(c==null||c<s.min||c>s.max||h<o.min||h>o.max){continue}d.beginPath();c=s.p2c(c);h=o.p2c(h)+r;if(u=="circle"){d.arc(c,h,t,0,i?Math.PI:Math.PI*2,false)}else{u(d,c,h,t,i)}d.closePath();if(n){d.fillStyle=n;d.fill()}d.stroke()}}d.save();d.translate(y.left,y.top);var n=e.points.lineWidth,r=e.shadowSize,i=e.points.radius,s=e.points.symbol;if(n==0){n=1e-4}if(n>0&&r>0){var o=r/2;d.lineWidth=o;d.strokeStyle="rgba(0,0,0,0.1)";t(e.datapoints,i,null,o+o/2,true,e.xaxis,e.yaxis,s);d.strokeStyle="rgba(0,0,0,0.2)";t(e.datapoints,i,null,o/2,true,e.xaxis,e.yaxis,s)}d.lineWidth=n;d.strokeStyle=e.color;t(e.datapoints,i,st(e.points,e.color),0,false,e.xaxis,e.yaxis,s);d.restore()}function rt(e,t,n,r,i,s,o,u,a,f,l,c){var h,p,d,v,m,g,y,b,w;if(l){b=g=y=true;m=false;h=n;p=e;v=t+r;d=t+i;if(p<h){w=p;p=h;h=w;m=true;g=false}}else{m=g=y=true;b=false;h=e+r;p=e+i;d=n;v=t;if(v<d){w=v;v=d;d=w;b=true;y=false}}if(p<u.min||h>u.max||v<a.min||d>a.max){return}if(h<u.min){h=u.min;m=false}if(p>u.max){p=u.max;g=false}if(d<a.min){d=a.min;b=false}if(v>a.max){v=a.max;y=false}h=u.p2c(h);d=a.p2c(d);p=u.p2c(p);v=a.p2c(v);if(o){f.beginPath();f.moveTo(h,d);f.lineTo(h,v);f.lineTo(p,v);f.lineTo(p,d);f.fillStyle=o(d,v);f.fill()}if(c>0&&(m||g||y||b)){f.beginPath();f.moveTo(h,d+s);if(m){f.lineTo(h,v+s)}else{f.moveTo(h,v+s)}if(y){f.lineTo(p,v+s)}else{f.moveTo(p,v+s)}if(g){f.lineTo(p,d+s)}else{f.moveTo(p,d+s)}if(b){f.lineTo(h,d+s)}else{f.moveTo(h,d+s)}f.stroke()}}function it(e){function t(t,n,r,i,s,o,u){var a=t.points,f=t.pointsize;for(var l=0;l<a.length;l+=f){if(a[l]==null){continue}rt(a[l],a[l+1],a[l+2],n,r,i,s,o,u,d,e.bars.horizontal,e.bars.lineWidth)}}d.save();d.translate(y.left,y.top);d.lineWidth=e.bars.lineWidth;d.strokeStyle=e.color;var n;switch(e.bars.align){case"left":n=0;break;case"right":n=-e.bars.barWidth;break;case"center":n=-e.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+e.bars.align)}var r=e.bars.fill?function(t,n){return st(e.bars,e.color,t,n)}:null;t(e.datapoints,n,n+e.bars.barWidth,0,r,e.xaxis,e.yaxis);d.restore()}function st(t,n,r,i){var s=t.fill;if(!s){return null}if(t.fillColor){return Et(t.fillColor,r,i,n)}var o=e.color.parse(n);o.a=typeof s=="number"?s:.4;o.normalize();return o.toString()}function ot(){t.find(".legend").remove();if(!a.legend.show){return}var n=[],r=[],i=false,s=a.legend.labelFormatter,o,l;for(var c=0;c<u.length;++c){o=u[c];if(o.label){l=s?s(o.label,o):o.label;if(l){r.push({label:l,color:o.color})}}}if(a.legend.sorted){if(e.isFunction(a.legend.sorted)){r.sort(a.legend.sorted)}else{if(a.legend.sorted=="reverse"){r.reverse()}else{var h=a.legend.sorted!="descending";r.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=h?1:-1})}}}for(var c=0;c<r.length;++c){var p=r[c];if(c%a.legend.noColumns==0){if(i){n.push("</tr>")}n.push("<tr>");i=true}n.push('<td class="legendColorBox"><div style="border:1px solid '+a.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+p.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+p.label+"</td>")}if(i){n.push("</tr>")}if(n.length==0){return}var d='<table style="font-size:smaller;color:'+a.grid.color+'">'+n.join("")+"</table>";if(a.legend.container!=null){e(a.legend.container).html(d)}else{var v="",m=a.legend.position,g=a.legend.margin;if(g[0]==null){g=[g,g]}if(m.charAt(0)=="n"){v+="top:"+(g[1]+y.top)+"px;"}else{if(m.charAt(0)=="s"){v+="bottom:"+(g[1]+y.bottom)+"px;"}}if(m.charAt(1)=="e"){v+="right:"+(g[0]+y.right)+"px;"}else{if(m.charAt(1)=="w"){v+="left:"+(g[0]+y.left)+"px;"}}var b=e('<div class="legend">'+d.replace('style="','style="position:absolute;'+v+";")+"</div>").appendTo(t);if(a.legend.backgroundOpacity!=0){var w=a.legend.backgroundColor;if(w==null){w=a.grid.backgroundColor;if(w&&typeof w=="string"){w=e.color.parse(w)}else{w=e.color.extract(b,"background-color")}w.a=1;w=w.toString()}var E=b.children();e('<div style="position:absolute;width:'+E.width()+"px;height:"+E.height()+"px;"+v+"background-color:"+w+';"> </div>').prependTo(b).css("opacity",a.legend.backgroundOpacity)}}}function ft(e,t,n){var r=a.grid.mouseActiveRadius,i=r*r+1,s=null,o=false,f,l,c;for(f=u.length-1;f>=0;--f){if(!n(u[f])){continue}var h=u[f],p=h.xaxis,d=h.yaxis,v=h.datapoints.points,m=p.c2p(e),g=d.c2p(t),y=r/p.scale,b=r/d.scale;c=h.datapoints.pointsize;if(p.options.inverseTransform){y=Number.MAX_VALUE}if(d.options.inverseTransform){b=Number.MAX_VALUE}if(h.lines.show||h.points.show){for(l=0;l<v.length;l+=c){var w=v[l],E=v[l+1];if(w==null){continue}if(w-m>y||w-m<-y||E-g>b||E-g<-b){continue}var S=Math.abs(p.p2c(w)-e),x=Math.abs(d.p2c(E)-t),T=S*S+x*x;if(T<i){i=T;s=[f,l/c]}}}if(h.bars.show&&!s){var N=h.bars.align=="left"?0:-h.bars.barWidth/2,C=N+h.bars.barWidth;for(l=0;l<v.length;l+=c){var w=v[l],E=v[l+1],k=v[l+2];if(w==null){continue}if(u[f].bars.horizontal?m<=Math.max(k,w)&&m>=Math.min(k,w)&&g>=E+N&&g<=E+C:m>=w+N&&m<=w+C&&g>=Math.min(k,E)&&g<=Math.max(k,E)){s=[f,l/c]}}}}if(s){f=s[0];l=s[1];c=u[f].datapoints.pointsize;return{datapoint:u[f].datapoints.points.slice(l*c,(l+1)*c),dataIndex:l,series:u[f],seriesIndex:f}}return null}function lt(e){if(a.grid.hoverable){pt("plothover",e,function(e){return e.hoverable!=false})}}function ct(e){if(a.grid.hoverable){pt("plothover",e,function(e){return false})}}function ht(e){pt("plotclick",e,function(e){return e.clickable!=false})}function pt(e,n,r){var i=p.offset(),s=n.pageX-i.left-y.left,o=n.pageY-i.top-y.top,u=M({left:s,top:o});u.pageX=n.pageX;u.pageY=n.pageY;var f=ft(s,o,r);if(f){f.pageX=parseInt(f.series.xaxis.p2c(f.datapoint[0])+i.left+y.left,10);f.pageY=parseInt(f.series.yaxis.p2c(f.datapoint[1])+i.top+y.top,10)}if(a.grid.autoHighlight){for(var l=0;l<ut.length;++l){var c=ut[l];if(c.auto==e&&!(f&&c.series==f.series&&c.point[0]==f.datapoint[0]&&c.point[1]==f.datapoint[1])){gt(c.series,c.point)}}if(f){mt(f.series,f.datapoint,e)}}t.trigger(e,[u,f])}function dt(){var e=a.interaction.redrawOverlayInterval;if(e==-1){vt();return}if(!at){at=setTimeout(vt,e)}}function vt(){at=null;v.save();h.clear();v.translate(y.left,y.top);var e,t;for(e=0;e<ut.length;++e){t=ut[e];if(t.series.bars.show){wt(t.series,t.point)}else{bt(t.series,t.point)}}v.restore();T(S.drawOverlay,[v])}function mt(e,t,n){if(typeof e=="number"){e=u[e]}if(typeof t=="number"){var r=e.datapoints.pointsize;t=e.datapoints.points.slice(r*t,r*(t+1))}var i=yt(e,t);if(i==-1){ut.push({series:e,point:t,auto:n});dt()}else{if(!n){ut[i].auto=false}}}function gt(e,t){if(e==null&&t==null){ut=[];dt();return}if(typeof e=="number"){e=u[e]}if(typeof t=="number"){var n=e.datapoints.pointsize;t=e.datapoints.points.slice(n*t,n*(t+1))}var r=yt(e,t);if(r!=-1){ut.splice(r,1);dt()}}function yt(e,t){for(var n=0;n<ut.length;++n){var r=ut[n];if(r.series==e&&r.point[0]==t[0]&&r.point[1]==t[1]){return n}}return-1}function bt(t,n){var r=n[0],i=n[1],s=t.xaxis,o=t.yaxis,u=typeof t.highlightColor==="string"?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();if(r<s.min||r>s.max||i<o.min||i>o.max){return}var a=t.points.radius+t.points.lineWidth/2;v.lineWidth=a;v.strokeStyle=u;var l=1.5*a;r=s.p2c(r);i=o.p2c(i);v.beginPath();if(t.points.symbol=="circle"){v.arc(r,i,l,0,2*Math.PI,false)}else{t.points.symbol(v,r,i,l,false)}v.closePath();v.stroke()}function wt(t,n){var r=typeof t.highlightColor==="string"?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),i=r,s=t.bars.align=="left"?0:-t.bars.barWidth/2;v.lineWidth=t.bars.lineWidth;v.strokeStyle=r;rt(n[0],n[1],n[2]||0,s,s+t.bars.barWidth,0,function(){return i},t.xaxis,t.yaxis,v,t.bars.horizontal,t.bars.lineWidth)}function Et(t,n,r,i){if(typeof t=="string"){return t}else{var s=d.createLinearGradient(0,r,0,n);for(var o=0,u=t.colors.length;o<u;++o){var a=t.colors[o];if(typeof a!="string"){var l=e.color.parse(i);if(a.brightness!=null){l=l.scale("rgb",a.brightness)}if(a.opacity!=null){l.a*=a.opacity}a=l.toString()}s.addColorStop(o/(u-1),a)}return s}}var u=[],a={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:true,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:false,radius:3,lineWidth:2,fill:true,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:false,fillColor:null,steps:false},bars:{show:false,lineWidth:2,barWidth:1,fill:true,fillColor:null,align:"left",horizontal:false,zero:true},shadowSize:3,highlightColor:null},grid:{show:true,aboveData:false,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:false,hoverable:false,autoHighlight:true,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},l=null,h=null,p=null,d=null,v=null,m=[],g=[],y={left:0,right:0,top:0,bottom:0},w=0,E=0,S={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},x=this;x.setData=k;x.setupGrid=W;x.draw=K;x.getPlaceholder=function(){return t};x.getCanvas=function(){return l.element};x.getPlotOffset=function(){return y};x.width=function(){return w};x.height=function(){return E};x.offset=function(){var e=p.offset();e.left+=y.left;e.top+=y.top;return e};x.getData=function(){return u};x.getAxes=function(){var t={},n;e.each(m.concat(g),function(e,n){if(n){t[n.direction+(n.n!=1?n.n:"")+"axis"]=n}});return t};x.getXAxes=function(){return m};x.getYAxes=function(){return g};x.c2p=M;x.p2c=_;x.getOptions=function(){return a};x.highlight=mt;x.unhighlight=gt;x.triggerRedrawOverlay=dt;x.pointOffset=function(e){return{left:parseInt(m[A(e,"x")-1].p2c(+e.x)+y.left,10),top:parseInt(g[A(e,"y")-1].p2c(+e.y)+y.top,10)}};x.shutdown=F;x.resize=function(){var e=t.width(),n=t.height();l.resize(e,n);h.resize(e,n)};x.hooks=S;N(x);C(s);B();k(r);W();K();j();var ut=[],at=null}function i(e,t){return t*Math.floor(e/t)}var t=Object.prototype.hasOwnProperty;n.prototype.resize=function(e,t){if(e<=0||t<=0){throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t)}var n=this.element,r=this.context,i=this.pixelRatio;if(this.width!=e){n.width=e*i;n.style.width=e+"px";this.width=e}if(this.height!=t){n.height=t*i;n.style.height=t+"px";this.height=t}r.restore();r.save();r.scale(i,i)};n.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};n.prototype.render=function(){var e=this._textCache;for(var n in e){if(t.call(e,n)){var r=this.getTextLayer(n),i=e[n];r.hide();for(var s in i){if(t.call(i,s)){var o=i[s];for(var u in o){if(t.call(o,u)){var a=o[u].positions;for(var f=0,l;l=a[f];f++){if(l.active){if(!l.rendered){r.append(l.element);l.rendered=true}}else{a.splice(f--,1);if(l.rendered){l.element.detach()}}}if(a.length==0){delete o[u]}}}}}r.show()}}};n.prototype.getTextLayer=function(t){var n=this.text[t];if(n==null){if(this.textContainer==null){this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)}n=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)}return n};n.prototype.getTextInfo=function(t,n,r,i,s){var o,u,a,l;n=""+n;if(typeof r==="object"){o=r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family}else{o=r}u=this._textCache[t];if(u==null){u=this._textCache[t]={}}a=u[o];if(a==null){a=u[o]={}}l=a[n];if(l==null){var c=e("<div></div>").html(n).css({position:"absolute","max-width":s,top:-9999}).appendTo(this.getTextLayer(t));if(typeof r==="object"){c.css({font:o,color:r.color})}else{if(typeof r==="string"){c.addClass(r)}}l=a[n]={width:c.outerWidth(true),height:c.outerHeight(true),element:c,positions:[]};c.detach()}return l};n.prototype.addText=function(e,t,n,r,i,s,o,u,a){var f=this.getTextInfo(e,r,i,s,o),l=f.positions;if(u=="center"){t-=f.width/2}else{if(u=="right"){t-=f.width}}if(a=="middle"){n-=f.height/2}else{if(a=="bottom"){n-=f.height}}for(var c=0,h;h=l[c];c++){if(h.x==t&&h.y==n){h.active=true;return}}h={active:true,rendered:false,element:l.length?f.element.clone():f.element,x:t,y:n};l.push(h);h.element.css({top:Math.round(n),left:Math.round(t),"text-align":u})};n.prototype.removeText=function(e,n,r,i,s,o){if(i==null){var u=this._textCache[e];if(u!=null){for(var a in u){if(t.call(u,a)){var f=u[a];for(var l in f){if(t.call(f,l)){var c=f[l].positions;for(var h=0,p;p=c[h];h++){p.active=false}}}}}}}else{var c=this.getTextInfo(e,i,s,o).positions;for(var h=0,p;p=c[h];h++){if(p.x==n&&p.y==r){p.active=false}}}};e.plot=function(t,n,i){var s=new r(e(t),n,i,e.plot.plugins);return s};e.plot.version="0.8.1";e.plot.plugins=[];e.fn.plot=function(t,n){return this.each(function(){e.plot(this,t,n)})}})(jQuery);(function(e){function r(r){function m(t,n,r){if(!h){h=true;s=t.getCanvas();o=e(s).parent();i=t.getOptions();t.setData(g(t.getData()))}}function g(t){var n=0,r=0,s=0,o=i.series.pie.combine.color,u=[];for(var a=0;a<t.length;++a){var f=t[a].data;if(e.isArray(f)&&f.length==1){f=f[0]}if(e.isArray(f)){if(!isNaN(parseFloat(f[1]))&&isFinite(f[1])){f[1]=+f[1]}else{f[1]=0}}else{if(!isNaN(parseFloat(f))&&isFinite(f)){f=[1,+f]}else{f=[1,0]}}t[a].data=[f]}for(var a=0;a<t.length;++a){n+=t[a].data[0][1]}for(var a=0;a<t.length;++a){var f=t[a].data[0][1];if(f/n<=i.series.pie.combine.threshold){r+=f;s++;if(!o){o=t[a].color}}}for(var a=0;a<t.length;++a){var f=t[a].data[0][1];if(s<2||f/n>i.series.pie.combine.threshold){u.push({data:[[1,f]],color:t[a].color,label:t[a].label,angle:f*Math.PI*2/n,percent:f/(n/100)})}}if(s>1){u.push({data:[[1,r]],color:o,label:i.series.pie.combine.label,angle:r*Math.PI*2/n,percent:r/(n/100)})}return u}function y(r,s){function S(){p.clearRect(0,0,v,m);o.children().filter(".pieLabel, .pieLabelBackground").remove()}function x(){var e=i.series.pie.shadow.left;var t=i.series.pie.shadow.top;var n=10;var r=i.series.pie.shadow.alpha;var s=i.series.pie.radius>1?i.series.pie.radius:u*i.series.pie.radius;if(s>=v/2-e||s*i.series.pie.tilt>=m/2-t||s<=n){return}p.save();p.translate(e,t);p.globalAlpha=r;p.fillStyle="#000";p.translate(a,l);p.scale(1,i.series.pie.tilt);for(var o=1;o<=n;o++){p.beginPath();p.arc(0,0,s,0,Math.PI*2,false);p.fill();s-=o}p.restore()}function T(){function f(e,t,i){if(e<=0||isNaN(e)){return}if(i){p.fillStyle=t}else{p.strokeStyle=t;p.lineJoin="round"}p.beginPath();if(Math.abs(e-Math.PI*2)>1e-9){p.moveTo(0,0)}p.arc(0,0,n,r,r+e/2,false);p.arc(0,0,n,r+e/2,r+e,false);p.closePath();r+=e;if(i){p.fill()}else{p.stroke()}}function h(){function f(t,n,s){if(t.data[0][1]==0){return true}var u=i.legend.labelFormatter,f,h=i.series.pie.label.formatter;if(u){f=u(t.label,t)}else{f=t.label}if(h){f=h(f,t)}var p=(n+t.angle+n)/2;var g=a+Math.round(Math.cos(p)*r);var y=l+Math.round(Math.sin(p)*r)*i.series.pie.tilt;var b="<span class='pieLabel' id='pieLabel"+s+"' style='position:absolute;top:"+y+"px;left:"+g+"px;'>"+f+"</span>";o.append(b);var w=o.children("#pieLabel"+s);var E=y-w.height()/2;var S=g-w.width()/2;w.css("top",E);w.css("left",S);if(0-E>0||0-S>0||m-(E+w.height())<0||v-(S+w.width())<0){return false}if(i.series.pie.label.background.opacity!=0){var x=i.series.pie.label.background.color;if(x==null){x=t.color}var T="top:"+E+"px;left:"+S+"px;";e("<div class='pieLabelBackground' style='position:absolute;width:"+w.width()+"px;height:"+w.height()+"px;"+T+"background-color:"+x+";'></div>").css("opacity",i.series.pie.label.background.opacity).insertBefore(w)}return true}var n=t;var r=i.series.pie.label.radius>1?i.series.pie.label.radius:u*i.series.pie.label.radius;for(var s=0;s<y.length;++s){if(y[s].percent>=i.series.pie.label.threshold*100){if(!f(y[s],n,s)){return false}}n+=y[s].angle}return true}var t=Math.PI*i.series.pie.startAngle;var n=i.series.pie.radius>1?i.series.pie.radius:u*i.series.pie.radius;p.save();p.translate(a,l);p.scale(1,i.series.pie.tilt);p.save();var r=t;for(var s=0;s<y.length;++s){y[s].startAngle=r;f(y[s].angle,y[s].color,true)}p.restore();if(i.series.pie.stroke.width>0){p.save();p.lineWidth=i.series.pie.stroke.width;r=t;for(var s=0;s<y.length;++s){f(y[s].angle,i.series.pie.stroke.color,false)}p.restore()}w(p);p.restore();if(i.series.pie.label.show){return h()}else{return true}}if(!o){return}var v=r.getPlaceholder().width(),m=r.getPlaceholder().height(),g=o.children().filter(".legend").children().width()||0;p=s;h=false;u=Math.min(v,m/i.series.pie.tilt)/2;l=m/2+i.series.pie.offset.top;a=v/2;if(i.series.pie.offset.left=="auto"){if(i.legend.position.match("w")){a+=g/2}else{a-=g/2}}else{a+=i.series.pie.offset.left}if(a<u){a=u}else{if(a>v-u){a=v-u}}var y=r.getData(),E=0;do{if(E>0){u*=n}E+=1;S();if(i.series.pie.tilt<=.8){x()}}while(!T()&&E<t);if(E>=t){S();o.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")}if(r.setSeries&&r.insertLegend){r.setSeries(y);r.insertLegend()}}function w(e){if(i.series.pie.innerRadius>0){e.save();var t=i.series.pie.innerRadius>1?i.series.pie.innerRadius:u*i.series.pie.innerRadius;e.globalCompositeOperation="destination-out";e.beginPath();e.fillStyle=i.series.pie.stroke.color;e.arc(0,0,t,0,Math.PI*2,false);e.fill();e.closePath();e.restore();e.save();e.beginPath();e.strokeStyle=i.series.pie.stroke.color;e.arc(0,0,t,0,Math.PI*2,false);e.stroke();e.closePath();e.restore()}}function E(e,t){for(var n=false,r=-1,i=e.length,s=i-1;++r<i;s=r){(e[r][1]<=t[1]&&t[1]<e[s][1]||e[s][1]<=t[1]&&t[1]<e[r][1])&&t[0]<(e[s][0]-e[r][0])*(t[1]-e[r][1])/(e[s][1]-e[r][1])+e[r][0]&&(n=!n)}return n}function S(e,t){var n=r.getData(),i=r.getOptions(),s=i.series.pie.radius>1?i.series.pie.radius:u*i.series.pie.radius,o,f;for(var c=0;c<n.length;++c){var h=n[c];if(h.pie.show){p.save();p.beginPath();p.moveTo(0,0);p.arc(0,0,s,h.startAngle,h.startAngle+h.angle/2,false);p.arc(0,0,s,h.startAngle+h.angle/2,h.startAngle+h.angle,false);p.closePath();o=e-a;f=t-l;if(p.isPointInPath){if(p.isPointInPath(e-a,t-l)){p.restore();return{datapoint:[h.percent,h.data],dataIndex:0,series:h,seriesIndex:c}}}else{var d=s*Math.cos(h.startAngle),v=s*Math.sin(h.startAngle),m=s*Math.cos(h.startAngle+h.angle/4),g=s*Math.sin(h.startAngle+h.angle/4),y=s*Math.cos(h.startAngle+h.angle/2),b=s*Math.sin(h.startAngle+h.angle/2),w=s*Math.cos(h.startAngle+h.angle/1.5),S=s*Math.sin(h.startAngle+h.angle/1.5),x=s*Math.cos(h.startAngle+h.angle),T=s*Math.sin(h.startAngle+h.angle),N=[[0,0],[d,v],[m,g],[y,b],[w,S],[x,T]],C=[o,f];if(E(N,C)){p.restore();return{datapoint:[h.percent,h.data],dataIndex:0,series:h,seriesIndex:c}}}p.restore()}}return null}function x(e){N("plothover",e)}function T(e){N("plotclick",e)}function N(e,t){var n=r.offset();var s=parseInt(t.pageX-n.left);var u=parseInt(t.pageY-n.top);var a=S(s,u);if(i.grid.autoHighlight){for(var f=0;f<v.length;++f){var l=v[f];if(l.auto==e&&!(a&&l.series==a.series)){k(l.series)}}}if(a){C(a.series,e)}var h={pageX:t.pageX,pageY:t.pageY};o.trigger(e,[h,a])}function C(e,t){var n=L(e);if(n==-1){v.push({series:e,auto:t});r.triggerRedrawOverlay()}else{if(!t){v[n].auto=false}}}function k(e){if(e==null){v=[];r.triggerRedrawOverlay()}var t=L(e);if(t!=-1){v.splice(t,1);r.triggerRedrawOverlay()}}function L(e){for(var t=0;t<v.length;++t){var n=v[t];if(n.series==e){return t}}return-1}function A(e,t){function s(e){if(e.angle<=0||isNaN(e.angle)){return}t.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")";t.beginPath();if(Math.abs(e.angle-Math.PI*2)>1e-9){t.moveTo(0,0)}t.arc(0,0,r,e.startAngle,e.startAngle+e.angle/2,false);t.arc(0,0,r,e.startAngle+e.angle/2,e.startAngle+e.angle,false);t.closePath();t.fill()}var n=e.getOptions();var r=n.series.pie.radius>1?n.series.pie.radius:u*n.series.pie.radius;t.save();t.translate(a,l);t.scale(1,n.series.pie.tilt);for(var i=0;i<v.length;++i){s(v[i].series)}w(t);t.restore()}var s=null,o=null,u=null,a=null,l=null,h=false,p=null;var v=[];r.hooks.processOptions.push(function(e,t){if(t.series.pie.show){t.grid.show=false;if(t.series.pie.label.show=="auto"){if(t.legend.show){t.series.pie.label.show=false}else{t.series.pie.label.show=true}}if(t.series.pie.radius=="auto"){if(t.series.pie.label.show){t.series.pie.radius=3/4}else{t.series.pie.radius=1}}if(t.series.pie.tilt>1){t.series.pie.tilt=1}else{if(t.series.pie.tilt<0){t.series.pie.tilt=0}}}});r.hooks.bindEvents.push(function(e,t){var n=e.getOptions();if(n.series.pie.show){if(n.grid.hoverable){t.unbind("mousemove").mousemove(x)}if(n.grid.clickable){t.unbind("click").click(T)}}});r.hooks.processDatapoints.push(function(e,t,n,r){var i=e.getOptions();if(i.series.pie.show){m(e,t,n,r)}});r.hooks.drawOverlay.push(function(e,t){var n=e.getOptions();if(n.series.pie.show){A(e,t)}});r.hooks.draw.push(function(e,t){var n=e.getOptions();if(n.series.pie.show){y(e,t)}})}var t=10;var n=.95;var i={series:{pie:{show:false,radius:"auto",innerRadius:0,startAngle:3/2,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(e,t){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+t.color+";'>"+e+"<br/>"+Math.round(t.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};e.plot.plugins.push({init:r,options:i,name:"pie",version:"1.1"})})(jQuery);$.expr[":"].fuelTextExactCI=$.expr.createPseudo?$.expr.createPseudo(function(e){return function(t){return fuelTextExactCI(t,e)}}):function(e,t,n){return fuelTextExactCI(e,n[3])};var Checkbox=function(e,t){this.$element=$(e);this.options=$.extend({},$.fn.checkbox.defaults,t);this.$label=this.$element.parent();this.$icon=this.$label.find("i");this.$chk=this.$label.find("input[type=checkbox]");this.setState(this.$chk);this.$chk.on("change",$.proxy(this.itemchecked,this))};Checkbox.prototype={constructor:Checkbox,setState:function(e){var t=e.is(":checked");var n=e.is(":disabled");this.$icon.removeClass("checked").removeClass("disabled");if(t===true){this.$icon.addClass("checked")}if(n===true){this.$icon.addClass("disabled")}},enable:function(){this.$chk.attr("disabled",false);this.$icon.removeClass("disabled")},disable:function(){this.$chk.attr("disabled",true);this.$icon.addClass("disabled")},toggle:function(){this.$chk.click()},itemchecked:function(e){var t=$(e.target);this.setState(t)}};$.fn.checkbox=function(e,t){var n;var r=this.each(function(){var r=$(this);var i=r.data("checkbox");var s=typeof e==="object"&&e;if(!i){r.data("checkbox",i=new Checkbox(this,s))}if(typeof e==="string"){n=i[e](t)}});return n===undefined?r:n};$.fn.checkbox.defaults={};$.fn.checkbox.Constructor=Checkbox;$(function(){$(window).on("load",function(){$(".checkbox-custom > input[type=checkbox]").each(function(){var e=$(this);if(e.data("checkbox")){return}e.checkbox(e.data())})})});var Combobox=function(e,t){this.$element=$(e);this.options=$.extend({},$.fn.combobox.defaults,t);this.$element.on("click","a",$.proxy(this.itemclicked,this));this.$element.on("change","input",$.proxy(this.inputchanged,this));this.$input=this.$element.find("input");this.$button=this.$element.find(".btn");this.setDefaultSelection()};Combobox.prototype={constructor:Combobox,selectedItem:function(){var e=this.$selectedItem;var t={};if(e){var n=this.$selectedItem.text();t=$.extend({text:n},this.$selectedItem.data())}else{t={text:this.$input.val()}}return t},selectByText:function(e){var t="li:fuelTextExactCI("+e+")";this.selectBySelector(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);if(typeof t[0]!=="undefined"){this.$selectedItem=t;this.$input.val(this.$selectedItem.text())}else{this.$selectedItem=null}},setDefaultSelection:function(){var e="li[data-selected=true]:first";var t=this.$element.find(e);if(t.length>0){this.selectBySelector(e);t.removeData("selected");t.removeAttr("data-selected")}},enable:function(){this.$input.removeAttr("disabled");this.$button.removeClass("disabled")},disable:function(){this.$input.attr("disabled",true);this.$button.addClass("disabled")},itemclicked:function(e){this.$selectedItem=$(e.target).parent();this.$input.val(this.$selectedItem.text()).trigger("change",{synthetic:true});var t=this.selectedItem();this.$element.trigger("changed",t);e.preventDefault()},inputchanged:function(e,t){if(t&&t.synthetic){return}var n=$(e.target).val();this.selectByText(n);var r=this.selectedItem();if(r.text.length===0){r={text:n}}this.$element.trigger("changed",r)}};$.fn.combobox=function(e,t){var n;var r=this.each(function(){var r=$(this);var i=r.data("combobox");var s=typeof e==="object"&&e;if(!i){r.data("combobox",i=new Combobox(this,s))}if(typeof e==="string"){n=i[e](t)}});return n===undefined?r:n};$.fn.combobox.defaults={};$.fn.combobox.Constructor=Combobox;$(function(){$(window).on("load",function(){$(".combobox").each(function(){var e=$(this);if(e.data("combobox")){return}e.combobox(e.data())})});$("body").on("mousedown.combobox.data-api",".combobox",function(e){var t=$(this);if(t.data("combobox")){return}t.combobox(t.data())})});var Radio=function(e,t){this.$element=$(e);this.options=$.extend({},$.fn.radio.defaults,t);this.$label=this.$element.parent();this.$icon=this.$label.find("i");this.$radio=this.$label.find("input[type=radio]");this.groupName=this.$radio.attr("name");this.setState(this.$radio);this.$radio.on("change",$.proxy(this.itemchecked,this))};Radio.prototype={constructor:Radio,setState:function(e,t){var n=e.is(":checked");var r=e.is(":disabled");if(n===true){this.$icon.addClass("checked")}if(r===true){this.$icon.addClass("disabled")}},resetGroup:function(){$("input[name="+this.groupName+"]").next().removeClass("checked")},enable:function(){this.$radio.attr("disabled",false);this.$icon.removeClass("disabled")},disable:function(){this.$radio.attr("disabled",true);this.$icon.addClass("disabled")},itemchecked:function(e){var t=$(e.target);this.resetGroup();this.setState(t)}};$.fn.radio=function(e,t){var n;var r=this.each(function(){var r=$(this);var i=r.data("radio");var s=typeof e==="object"&&e;if(!i){r.data("radio",i=new Radio(this,s))}if(typeof e==="string"){n=i[e](t)}});return n===undefined?r:n};$.fn.radio.defaults={};$.fn.radio.Constructor=Radio;$(function(){$(window).on("load",function(){$(".radio-custom > input[type=radio]").each(function(){var e=$(this);if(e.data("radio")){return}e.radio(e.data())})})});var Select=function(e,t){this.$element=$(e);this.options=$.extend({},$.fn.select.defaults,t);this.$element.on("click","a",$.proxy(this.itemclicked,this));this.$button=this.$element.find(".btn");this.$label=this.$element.find(".dropdown-label");this.setDefaultSelection();if(t.resize==="auto"){this.resize()}};Select.prototype={constructor:Select,itemclicked:function(e){this.$selectedItem=$(e.target).parent();this.$label.text(this.$selectedItem.text());var t=this.selectedItem();this.$element.trigger("changed",t);e.preventDefault()},resize:function(){var e=$("#selectTextSize")[0];if(!e){$("<div/>").attr({id:"selectTextSize"}).appendTo("body")}var t=0;var n=0;this.$element.find("a").each(function(){var e=$(this);var r=e.text();var i=$("#selectTextSize");i.text(r);n=i.outerWidth();if(n>t){t=n}});this.$label.width(t)},selectedItem:function(){var e=this.$selectedItem.text();return $.extend({text:e},this.$selectedItem.data())},selectByText:function(e){var t="li a:fuelTextExactCI("+e+")";this.selectBySelector(t)},selectByValue:function(e){var t='li[data-value="'+e+'"]';this.selectBySelector(t)},selectByIndex:function(e){var t="li:eq("+e+")";this.selectBySelector(t)},selectBySelector:function(e){var t=this.$element.find(e);this.$selectedItem=t;this.$label.text(this.$selectedItem.text())},setDefaultSelection:function(){var e="li[data-selected=true]:first";var t=this.$element.find(e);if(t.length===0){this.selectByIndex(0)}else{this.selectBySelector(e);t.removeData("selected");t.removeAttr("data-selected")}},enable:function(){this.$button.removeClass("disabled")},disable:function(){this.$button.addClass("disabled")}};$.fn.select=function(e,t){var n;var r=this.each(function(){var r=$(this);var i=r.data("select");var s=typeof e==="object"&&e;if(!i){r.data("select",i=new Select(this,s))}if(typeof e==="string"){n=i[e](t)}});return n===undefined?r:n};$.fn.select.defaults={};$.fn.select.Constructor=Select;$(function(){$(window).on("load",function(){$(".select").each(function(){var e=$(this);if(e.data("select")){return}e.select(e.data())})});$("body").on("mousedown.select.data-api",".select",function(e){var t=$(this);if(t.data("select")){return}t.select(t.data())})});var Spinner=function(e,t){this.$element=$(e);this.options=$.extend({},$.fn.spinner.defaults,t);this.$input=this.$element.find(".spinner-input");this.$element.on("keyup",this.$input,$.proxy(this.change,this));if(this.options.hold){this.$element.on("mousedown",".spinner-up",$.proxy(function(){this.startSpin(true)},this));this.$element.on("mouseup",".spinner-up, .spinner-down",$.proxy(this.stopSpin,this));this.$element.on("mouseout",".spinner-up, .spinner-down",$.proxy(this.stopSpin,this));this.$element.on("mousedown",".spinner-down",$.proxy(function(){this.startSpin(false)},this))}else{this.$element.on("click",".spinner-up",$.proxy(function(){this.step(true)},this));this.$element.on("click",".spinner-down",$.proxy(function(){this.step(false)},this))}this.switches={count:1,enabled:true};if(this.options.speed==="medium"){this.switches.speed=300}else{if(this.options.speed==="fast"){this.switches.speed=100}else{this.switches.speed=500}}this.lastValue=null;this.render();if(this.options.disabled){this.disable()}};Spinner.prototype={constructor:Spinner,render:function(){this.$input.val(this.options.value);this.$input.attr("maxlength",(this.options.max+"").split("").length)},change:function(){var e=this.$input.val();if(e/1){this.options.value=e/1}else{e=e.replace(/[^0-9]/g,"");this.$input.val(e);this.options.value=e/1}this.triggerChangedEvent()},stopSpin:function(){clearTimeout(this.switches.timeout);this.switches.count=1;this.triggerChangedEvent()},triggerChangedEvent:function(){var e=this.value();if(e===this.lastValue){return}this.lastValue=e;this.$element.trigger("changed",e);this.$element.trigger("change")},startSpin:function(e){if(!this.options.disabled){var t=this.switches.count;if(t===1){this.step(e);t=1}else{if(t<3){t=1.5}else{if(t<8){t=2.5}else{t=4}}}this.switches.timeout=setTimeout($.proxy(function(){this.iterator(e)},this),this.switches.speed/t);this.switches.count++}},iterator:function(e){this.step(e);this.startSpin(e)},step:function(e){var t=this.options.value;var n=e?this.options.max:this.options.min;if(e?t<n:t>n){var r=t+(e?1:-1)*this.options.step;if(e?r>n:r<n){this.value(n)}else{this.value(r)}}},value:function(e){if(!isNaN(parseFloat(e))&&isFinite(e)){e=parseFloat(e);this.options.value=e;this.$input.val(e);return this}else{return this.options.value}},disable:function(){this.options.disabled=true;this.$input.attr("disabled","");this.$element.find("button").addClass("disabled")},enable:function(){this.options.disabled=false;this.$input.removeAttr("disabled");this.$element.find("button").removeClass("disabled")}};$.fn.spinner=function(e,t){var n;var r=this.each(function(){var r=$(this);var i=r.data("spinner");var s=typeof e==="object"&&e;if(!i){r.data("spinner",i=new Spinner(this,s))}if(typeof e==="string"){n=i[e](t)}});return n===undefined?r:n};$.fn.spinner.defaults={value:1,min:1,max:999,step:1,hold:true,speed:"medium",disabled:false};$.fn.spinner.Constructor=Spinner;$(function(){$("body").on("mousedown.spinner.data-api",".spinner",function(e){var t=$(this);if(t.data("spinner")){return}t.spinner(t.data())})});var Search=function(e,t){this.$element=$(e);this.options=$.extend({},$.fn.search.defaults,t);this.$button=this.$element.find("button").on("click",$.proxy(this.buttonclicked,this));this.$input=this.$element.find("input").on("keydown",$.proxy(this.keypress,this)).on("keyup",$.proxy(this.keypressed,this));this.$icon=this.$element.find("i");this.activeSearch=""};Search.prototype={constructor:Search,search:function(e){this.$icon.attr("class","icon-remove");this.activeSearch=e;this.$element.trigger("searched",e)},clear:function(){this.$icon.attr("class","icon-search");this.activeSearch="";this.$input.val("");this.$element.trigger("cleared")},action:function(){var e=this.$input.val();var t=e===""||e===this.activeSearch;if(this.activeSearch&&t){this.clear()}else{if(e){this.search(e)}}},buttonclicked:function(e){e.preventDefault();if($(e.currentTarget).is(".disabled, :disabled")){return}this.action()},keypress:function(e){if(e.which===13){e.preventDefault()}},keypressed:function(e){var t,n;if(e.which===13){e.preventDefault();this.action()}else{t=this.$input.val();n=t&&t===this.activeSearch;this.$icon.attr("class",n?"icon-remove":"icon-search")}},disable:function(){this.$input.attr("disabled","disabled");this.$button.addClass("disabled")},enable:function(){this.$input.removeAttr("disabled");this.$button.removeClass("disabled")}};$.fn.search=function(e){return this.each(function(){var t=$(this);var n=t.data("search");var r=typeof e==="object"&&e;if(!n){t.data("search",n=new Search(this,r))}if(typeof e==="string"){n[e]()}})};$.fn.search.defaults={};$.fn.search.Constructor=Search;$(function(){$("body").on("mousedown.search.data-api",".search",function(){var e=$(this);if(e.data("search")){return}e.search(e.data())})});var Datagrid=function(e,t){this.$element=$(e);this.$thead=this.$element.find("thead");this.$tfoot=this.$element.find("tfoot");this.$footer=this.$element.find("tfoot th");this.$footerchildren=this.$footer.children().show().css("visibility","hidden");this.$topheader=this.$element.find("thead th");this.$searchcontrol=this.$element.find(".datagrid-search");this.$filtercontrol=this.$element.find(".filter");this.$pagesize=this.$element.find(".grid-pagesize");this.$pageinput=this.$element.find(".grid-pager input");this.$pagedropdown=this.$element.find(".grid-pager .dropdown-menu");this.$prevpagebtn=this.$element.find(".grid-prevpage");this.$nextpagebtn=this.$element.find(".grid-nextpage");this.$pageslabel=this.$element.find(".grid-pages");this.$countlabel=this.$element.find(".grid-count");this.$startlabel=this.$element.find(".grid-start");this.$endlabel=this.$element.find(".grid-end");this.$tbody=$("<tbody>").insertAfter(this.$thead);this.$colheader=$("<tr>").appendTo(this.$thead);this.options=$.extend(true,{},$.fn.datagrid.defaults,t);if(this.$pagesize.hasClass("select")){this.options.dataOptions.pageSize=parseInt(this.$pagesize.select("selectedItem").value,10)}else{this.options.dataOptions.pageSize=parseInt(this.$pagesize.val(),10)}if(this.$searchcontrol.length<=0){this.$searchcontrol=this.$element.find(".search")}this.columns=this.options.dataSource.columns();this.$nextpagebtn.on("click",$.proxy(this.next,this));this.$prevpagebtn.on("click",$.proxy(this.previous,this));this.$searchcontrol.on("searched cleared",$.proxy(this.searchChanged,this));this.$filtercontrol.on("changed",$.proxy(this.filterChanged,this));this.$colheader.on("click","th",$.proxy(this.headerClicked,this));if(this.$pagesize.hasClass("select")){this.$pagesize.on("changed",$.proxy(this.pagesizeChanged,this))}else{this.$pagesize.on("change",$.proxy(this.pagesizeChanged,this))}this.$pageinput.on("change",$.proxy(this.pageChanged,this));this.renderColumns();if(this.options.stretchHeight){this.initStretchHeight()}this.renderData()};Datagrid.prototype={constructor:Datagrid,renderColumns:function(){var e=this;this.$footer.attr("colspan",this.columns.length);this.$topheader.attr("colspan",this.columns.length);var t="";$.each(this.columns,function(e,n){t+='<th data-property="'+n.property+'"';if(n.sortable){t+=' class="sortable"'}t+=">"+n.label+"</th>"});e.$colheader.append(t)},updateColumns:function(e,t){var n=t==="asc"?"icon-chevron-up":"icon-chevron-down";this.$colheader.find("i").remove();this.$colheader.find("th").removeClass("sorted");$("<i>").addClass(n).appendTo(e);e.addClass("sorted")},updatePageDropdown:function(e){var t="";for(var n=1;n<=e.pages;n++){t+="<li><a>"+n+"</a></li>"}this.$pagedropdown.html(t)},updatePageButtons:function(e){if(e.page===1){this.$prevpagebtn.attr("disabled","disabled")}else{this.$prevpagebtn.removeAttr("disabled")}if(e.page===e.pages){this.$nextpagebtn.attr("disabled","disabled")}else{this.$nextpagebtn.removeAttr("disabled")}},renderData:function(){var e=this;this.$tbody.html(this.placeholderRowHTML(this.options.loadingHTML));this.options.dataSource.data(this.options.dataOptions,function(t){var n=t.count===1?e.options.itemText:e.options.itemsText;var r="";e.$footerchildren.css("visibility",function(){return t.count>0?"visible":"hidden"});e.$pageinput.val(t.page);e.$pageslabel.text(t.pages);e.$countlabel.text(t.count+" "+n);e.$startlabel.text(t.start);e.$endlabel.text(t.end);e.updatePageDropdown(t);e.updatePageButtons(t);$.each(t.data,function(t,n){r+="<tr>";$.each(e.columns,function(e,t){r+="<td>"+n[t.property]+"</td>"});r+="</tr>"});if(!r){r=e.placeholderRowHTML("0 "+e.options.itemsText)}e.$tbody.html(r);e.stretchHeight();e.$element.trigger("loaded")})},placeholderRowHTML:function(e){return'<tr><td style="text-align:center;padding:20px;border-bottom:none;" colspan="'+this.columns.length+'">'+e+"</td></tr>"},headerClicked:function(e){var t=$(e.target);if(!t.hasClass("sortable")){return}var n=this.options.dataOptions.sortDirection;var r=this.options.dataOptions.sortProperty;var i=t.data("property");if(r===i){this.options.dataOptions.sortDirection=n==="asc"?"desc":"asc"}else{this.options.dataOptions.sortDirection="asc";this.options.dataOptions.sortProperty=i}this.options.dataOptions.pageIndex=0;this.updateColumns(t,this.options.dataOptions.sortDirection);this.renderData()},pagesizeChanged:function(e,t){if(t){this.options.dataOptions.pageSize=parseInt(t.value,10)}else{this.options.dataOptions.pageSize=parseInt($(e.target).val(),10)}this.options.dataOptions.pageIndex=0;this.renderData()},pageChanged:function(e){var t=parseInt($(e.target).val(),10);t=isNaN(t)?1:t;var n=this.$pageslabel.text();this.options.dataOptions.pageIndex=t>n?n-1:t-1;this.renderData()},searchChanged:function(e,t){this.options.dataOptions.search=t;this.options.dataOptions.pageIndex=0;this.renderData()},filterChanged:function(e,t){this.options.dataOptions.filter=t;this.renderData()},previous:function(){this.options.dataOptions.pageIndex--;this.renderData()},next:function(){this.options.dataOptions.pageIndex++;this.renderData()},reload:function(){this.options.dataOptions.pageIndex=0;this.renderData()},initStretchHeight:function(){this.$gridContainer=this.$element.parent();this.$element.wrap('<div class="datagrid-stretch-wrapper">');this.$stretchWrapper=this.$element.parent();this.$headerTable=$("<table>").attr("class",this.$element.attr("class"));this.$footerTable=this.$headerTable.clone();this.$headerTable.prependTo(this.$gridContainer).addClass("datagrid-stretch-header");this.$thead.detach().appendTo(this.$headerTable);this.$sizingHeader=this.$thead.clone();this.$sizingHeader.find("tr:first").remove();this.$footerTable.appendTo(this.$gridContainer).addClass("datagrid-stretch-footer");this.$tfoot.detach().appendTo(this.$footerTable)},stretchHeight:function(){if(!this.$gridContainer){return}this.setColumnWidths();var e=this.$gridContainer.height();var t=this.$headerTable.outerHeight();var n=this.$footerTable.outerHeight();var r=t+n;this.$stretchWrapper.height(e-r)},setColumnWidths:function(){function n(n,r){if(n===t-1){return}$(r).width(e.eq(n).width())}if(!this.$sizingHeader){return}this.$element.prepend(this.$sizingHeader);var e=this.$sizingHeader.find("th");var t=e.length;this.$colheader.find("th").each(n);this.$tbody.find("tr:first > td").each(n);this.$sizingHeader.detach()}};$.fn.datagrid=function(e){return this.each(function(){var t=$(this);var n=t.data("datagrid");var r=typeof e==="object"&&e;if(!n){t.data("datagrid",n=new Datagrid(this,r))}if(typeof e==="string"){n[e]()}})};$.fn.datagrid.defaults={dataOptions:{pageIndex:0,pageSize:10},loadingHTML:'<div class="progress progress-striped active" style="width:50%;margin:auto;"><div class="bar" style="width:100%;"></div></div>',itemsText:"items",itemText:"item"};$.fn.datagrid.Constructor=Datagrid;var Wizard=function(e,t){var n;this.$element=$(e);this.options=$.extend({},$.fn.wizard.defaults,t);this.currentStep=1;this.numSteps=this.$element.find("li").length;this.$prevBtn=this.$element.find("button.btn-prev");this.$nextBtn=this.$element.find("button.btn-next");n=this.$nextBtn.children().detach();this.nextText=$.trim(this.$nextBtn.text());this.$nextBtn.append(n);this.$prevBtn.on("click",$.proxy(this.previous,this));this.$nextBtn.on("click",$.proxy(this.next,this));this.$element.on("click","li.complete",$.proxy(this.stepclicked,this))};Wizard.prototype={constructor:Wizard,setState:function(){var e=this.currentStep>1;var t=this.currentStep===1;var n=this.currentStep===this.numSteps;this.$prevBtn.attr("disabled",t===true||e===false);var r=this.$nextBtn.data();if(r&&r.last){this.lastText=r.last;if(typeof this.lastText!=="undefined"){var i=n!==true?this.nextText:this.lastText;var s=this.$nextBtn.children().detach();this.$nextBtn.text(i).append(s)}}var o=this.$element.find("li");o.removeClass("active").removeClass("complete");o.find("span.badge").removeClass("badge-info").removeClass("badge-success");var u="li:lt("+(this.currentStep-1)+")";var a=this.$element.find(u);a.addClass("complete");a.find("span.badge").addClass("badge-success");var f="li:eq("+(this.currentStep-1)+")";var l=this.$element.find(f);l.addClass("active");l.find("span.badge").addClass("badge-info");var c=l.data().target;$(".step-pane").removeClass("active");$(c).addClass("active");this.$element.trigger("changed")},stepclicked:function(e){var t=$(e.currentTarget);var n=$(".steps li").index(t);var r=$.Event("stepclick");this.$element.trigger(r,{step:n+1});if(r.isDefaultPrevented()){return}this.currentStep=n+1;this.setState()},previous:function(){var e=this.currentStep>1;if(e){var t=$.Event("change");this.$element.trigger(t,{step:this.currentStep,direction:"previous"});if(t.isDefaultPrevented()){return}this.currentStep-=1;this.setState()}},next:function(){var e=this.currentStep+1<=this.numSteps;var t=this.currentStep===this.numSteps;if(e){var n=$.Event("change");this.$element.trigger(n,{step:this.currentStep,direction:"next"});if(n.isDefaultPrevented()){return}this.currentStep+=1;this.setState()}else{if(t){this.$element.trigger("finished")}}},selectedItem:function(e){return{step:this.currentStep}}};$.fn.wizard=function(e,t){var n;var r=this.each(function(){var r=$(this);var i=r.data("wizard");var s=typeof e==="object"&&e;if(!i){r.data("wizard",i=new Wizard(this,s))}if(typeof e==="string"){n=i[e](t)}});return n===undefined?r:n};$.fn.wizard.defaults={};$.fn.wizard.Constructor=Wizard;$(function(){$("body").on("mousedown.wizard.data-api",".wizard",function(){var e=$(this);if(e.data("wizard")){return}e.wizard(e.data())})});$(document).ready(function(){$("#on-top-link").click(function(){$("body,html").animate({scrollTop:0},800);return false});$(".box-header").each(function(){var e=$(this).next();if(e.hasClass("box")&&!e.hasClass("non-collapsible")){$(this).append('<a href="#" class="box-collapse pull-right">hide&nbsp;&nbsp;<i class="icon-caret-up"></i></a>').append('<a href="#" class="box-expand pull-right" style="display: none">show&nbsp;&nbsp;<i class="icon-caret-down"></i></a>')}});$(document).on("click","a.box-collapse",function(){var e=$(this).hide(100,"linear");e.parent(".box-header").next(".box").slideUp(400,function(){$(".box-expand",e.parent(".box-header")).show(100,"linear")});return false}).on("click","a.box-expand",function(){var e=$(this).hide(100,"linear");e.parent(".box-header").next(".box").slideDown(400,function(){$(".box-collapse",e.parent(".box-header")).show(100,"linear")});return false})});$(document).on("click.collapse.data-api","[data-toggle=collapse]",function(e){self=$(".nav-button");if(self.hasClass("collapsed")){self.removeClass("active")}else{self.addClass("active")}});(function(){var e={_object:null,_left_panel:null,_scrolling:false,_dropdowns:{},_opened_dropdown:null,destroyScroll:function(){if(e._currScroll==="v"&&e._object!==null){e._object.destroy();e._object=null}else{if(e._currScroll==="h"){$("#left-panel .active").unbind("click");$("#left-panel").removeClass("open")}}},_setup:function(t){e.destroyScroll();var n=$("#left-panel");if(t==="v"){n.css({height:"100%",position:"fixed",top:0,left:0});if(!e._object){$("#left-panel a").click(function(){if(e._scrolling){return false}})}e._setupDropdowns();e._object=new iScroll("left-panel-content",{hScroll:false,vScroll:true,onScrollMove:function(){e._scrolling=true;e._hideOpenedDropdowns()},onScrollEnd:function(){e._scrolling=false}})}else{n.css({height:"36px",position:"relative",top:0,left:0});e._setupHorizontalMenu()}e._currScroll=t},_update:function(){if(String(e._left_panel.css("z-index"))!=="1020"&&e._currScroll!=="v"){e._setup("v")}else{if(String(e._left_panel.css("z-index"))==="1020"&&e._currScroll!=="h"){e._setup("h")}}if(e._currScroll==="v"&&e._opened_dropdown!==null){e._setDropdownTopPosition(e._opened_dropdown)}},_initDropdowns:function(){$(".lp-dropdown-toggle").each(function(){var t=$(this),n=t.attr("id");e._dropdowns[n]={toggler:t,menu:$(".lp-dropdown-menu[data-dropdown-owner="+n+"]")};e._dropdowns[n]["width"]=e._calculateDropdownWidth(n);e._dropdowns[n].wrapper=$('<div class="lp-dropdown-wrapper" data-dropdown-owner="'+n+'" />').appendTo($("body"));e._dropdowns[n].wrapper.append($('<div class="arrow" />'));if(e._dropdowns[n].menu.hasClass("simple")){e._dropdowns[n].wrapper.addClass("simple")}});$("html").on("click.dropdown.data-api",function(){e._hideOpenedDropdowns()});$("html").on("click",".lp-dropdown-wrapper",function(e){e.stopPropagation()});$(".lp-dropdown-toggle").click(function(){e._hideOpenedDropdowns();e._setDropdownTopPosition($(this).attr("id"));e._opened_dropdown=$(this).attr("id");$(this).addClass("open");$(".lp-dropdown-wrapper[data-dropdown-owner="+$(this).attr("id")+"]").addClass("open");return false})},_setupDropdowns:function(){$("#lp-active").unbind("click").remove();var t;for(var n in e._dropdowns){t=e._dropdowns[n];t.wrapper.append(t.menu);t.wrapper.css({left:$("#left-panel li").width()+10});$("a",t.menu).each(function(){$(this).html(jQuery.data(this,"link_html"))});t.menu.css({width:t.width});$(".active",t.menu).css({display:"block"});t.wrapper.css({width:t.width});if(t.menu.hasClass("simple")){$("li, li a",t.menu).css({display:"block",width:"100%"})}}},_setupHorizontalMenu:function(){var t=$("#left-panel");var n;for(var r in e._dropdowns){n=e._dropdowns[r];n.toggler.parent().append(n.menu);n.toggler.removeClass("open");n.wrapper.removeClass("open");n.menu.css({width:"100%"});n.wrapper.css({width:"100%"});$(".active",n.menu).css({display:"none"});$("a",n.menu).each(function(){var e=$(this);jQuery.data(this,"link_html",e.html());e.text(n.toggler.text()+" / "+e.text())})}$('<a href="#" id="lp-active" />').prependTo(t).bind("click",function(){if(t.hasClass("open")){t.css({height:37})}else{t.css({height:$("#left-panel-content ul").innerHeight()+37})}t.toggleClass("open");return false}).text($($(".active",t).length==1?".active":".active .active",t).text())},_hideOpenedDropdowns:function(){$(".lp-dropdown-wrapper.open").removeClass("open");$(".lp-dropdown-toggle.open").removeClass("open");e._opened_dropdown=null},_calculateDropdownWidth:function(t){var n=0;if(e._dropdowns[t].menu.hasClass("simple")){var r=e._dropdowns[t].menu.parent(),i=$('<div id="calculateDropdownWidth" />').css({position:"absolute",width:3e3,left:-1e4}).appendTo("body").append(e._dropdowns[t].menu);$("li a",e._dropdowns[t].menu).each(function(){if(n<$(this).width()){n=$(this).width()}});n+=50;r.append(e._dropdowns[t].menu);i.remove()}else{$("li",e._dropdowns[t].menu).each(function(){n+=$(this).width()})}return n},_setDropdownTopPosition:function(t){var n=e._dropdowns[t];if(n.menu.hasClass("simple")){var r=n.toggler.parents("li"),i=r.offset().top,s=r.height(),o=n.wrapper.height(),u=$(window).height(),a=$(document).scrollTop();var f,l;if(o>s){if(u>i+o-a){f=i;l=s/2-6}else{f=u-o+a;if(f+o<s+i){f=s+i-o}l=i-f+s/2-6}}else{f=i+s/2-o/2;l=o/2-6}n.wrapper.css({top:f-a});$(".arrow",n.wrapper).css({"margin-top":l})}else{n.wrapper.css({top:n.toggler.offset().top-$(document).scrollTop()})}}};$(document).ready(function(){e._initDropdowns();e._left_panel=$("#left-panel");e._update()});$(window).resize(e._update)})();(function($){$.fn.simplePlot=function(graph_data,plot_options,options){function showTooltip(e,t,n){var r=$('<div id="tooltip">'+n+"</div>").appendTo("body");if(e+20+r.width()>wrapper.offset().left+wrapper.width()){e-=40+r.width()}else{e+=20}r.css({top:t-16,left:e}).fadeIn()}var settings=$.extend(true,{},{pointsRadius:4,height:null,heightRatio:.5,tooltipText:"x - y"},options||{});var plot_settings=$.extend(true,{},{series:{shadowSize:0},grid:{color:"#646464",borderColor:"transparent",borderWidth:20,hoverable:true},xaxis:{tickColor:"transparent"},legend:{show:false}},plot_options||{});var data=[],wrapper=null,graph_container=null,current_width=null,plot_obj=null,timer=null,available_colors=["#71c73e","#77b7c5","#d54848","#6c42e5","#e8e64e","#dd56e6","#ecad3f","#618b9d","#b68b68","#36a766","#3156be","#00b3ff","#646464","#a946e8","#9d9d9d"];for(var i=0;i<graph_data.length;i++){data.push($.extend({},graph_data[i]))}return this.each(function(){$(this).wrap('<div class="graph-wrapper" />').wrap('<div class="graph-container" />');graph_container=$(this).parent(".graph-container");wrapper=graph_container.parent(".graph-wrapper");wrapper.prepend('<div class="graph-info" />');var graph_info=$(".graph-info",wrapper);var updateContainerSize=function(){var e=wrapper.innerWidth();if(e==current_width){return}var t=settings.height===null?Math.ceil(e*settings.heightRatio):settings.height;graph_container.css({width:e,height:t});current_width=e;if(plot_obj){plot_obj.getPlaceholder().css({width:e,height:t});plot_obj.resize();plot_obj.setupGrid();plot_obj.draw()}};updateContainerSize();if(!data.length){return}for(var i=0,dataItem=data[0];i<data.length;dataItem=data[++i]){if(dataItem.color===undefined){dataItem.color=available_colors.shift()}if(dataItem.filledPoints===true){$.extend(true,dataItem,{points:{radius:settings.pointsRadius,fillColor:dataItem.color}});delete dataItem.filledPoints}graph_info.append($('<span><i style="background: '+dataItem.color+'"></i>'+dataItem.label+"</span>"))}plot_obj=$.plot($(this),data,plot_settings);if(plot_settings.series.pie===undefined){var previousPoint=null;$(this).bind("plothover",function(event,pos,item){if(item){if(previousPoint!=item.dataIndex){previousPoint=item.dataIndex;$("#tooltip").remove();var x=item.datapoint[0],y=item.datapoint[1];showTooltip(item.pageX,item.pageY,eval(settings.tooltipText))}}else{$("#tooltip").remove();previousPoint=null}})}$(window).resize(function(){if(timer){clearTimeout(timer)}timer=setTimeout(function(){timer=null;updateContainerSize()},300)})})}})(jQuery);(function(e){e.fn.extend({limiter:function(t,n){function r(e,n){var r=e.value.length;if(r>t){e.value=e.value.substr(0,t);r=t}n.html(t-r)}e(this).on("keyup focus",function(){r(this,n)});r(e(this)[0],n)}})})(jQuery);(function(e){e.fn.extend({afTasks:function(t){if(!t||t&&typeof t!=="string"){t=e.extend({},e.afTasks._callbacks,t||{})}this.each(function(){var n=null;if(t&&typeof t==="string"){n=e.data(this,"afTasks");if(t==="clearCompletedTasks"){n.clearCompletedTasks(this)}return}e.data(this,"afTasks",new e.afTasks(this,t))});return}});e.afTasks=function(t,n){var r=this;this.callbacks=n;this.clearCompletedTasks=function(t){e(".completed",e(t)).hide(200,function(){e(this).remove()});this.callbacks.clearCallback(t)};e(".widget-tasks").on("click",".task input[type=checkbox]",function(n){e(this).parents(".task").toggleClass("completed");if(e(this).parents(".task").hasClass("completed")){r.callbacks.completeCallback(t,n)}else{r.callbacks.cancelCallback(t,n)}});e(".widget-tasks").on("click",".task a",function(){e("input",e(this).prev("div")).click();return false})};e.afTasks._callbacks={completeCallback:function(e,t){},cancelCallback:function(e,t){},clearCallback:function(e){}}})(jQuery);(function(e){e.fn.extend({afStarsRating:function(t,n){if(!t||t&&typeof t!=="string"){t=e.extend({},e.afStarsRating.options,t||{})}this.each(function(){var r=null;if(t&&typeof t==="string"){r=e.data(this,"afStarsRating");if(t==="setCurrentRating"){r.setCurrentRating(n)}return}e.data(this,"afStarsRating",new e.afStarsRating(e(this),t))});return}});e.afStarsRating=function(t,n){this.options=n;var r=this,i=e('<ul class="widget-stars-rating" />');for(var s=0;s<this.options.stars_count;s++){i.append('<li><a href="#" title="" class="icon-star"></a></li>')}t.append(i);e(".widget-stars-rating a",t).on("mouseenter",function(){e(".widget-stars-rating li",t).removeClass(r.options.class_active);e(this).parent().addClass(r.options.class_active).prevAll("li").addClass(r.options.class_active)}).on("mouseleave",function(){r.setCurrentRating(r.options.current_rating)}).on("click",function(){r.options.onSetRating(this,e(this).parent().prevAll("li").length+1);return false});this.setCurrentRating=function(n){r.options.current_rating=n;if(n-Math.floor(n)>r.options.lower_limit){n=Math.ceil(n)}else{n=Math.floor(n)}e(".widget-stars-rating li",t).removeClass(r.options.class_active).slice(0,n).addClass(r.options.class_active)};this.setCurrentRating(this.options.current_rating)};e.afStarsRating.options={stars_count:5,current_rating:0,class_active:"active",lower_limit:.35,onSetRating:function(e,t){}}})(jQuery);(function(e){e.fn.extend({afStream:function(t,n){if(!t||t&&typeof t!=="string"){t=e.extend({},e.afStream.options,t||{})}this.each(function(){var r=null;if(t&&typeof t==="string"){r=e.data(this,"afStream");switch(t){case"addEvent":r.addEvent(n);break;case"updateTime":r.updateTime(true);break;case"showEvents":r.showEvents(n);break;case"hideEvents":r.hideEvents(n);break;case"showAllEvents":r.showAllEvents();break;case"hideAllEvents":r.hideAllEvents();break;case"clearAllEvents":r.clearAllEvents();break;case"setUpdateInterval":r.setUpdateInterval(n);break;case"setShowLimit":r.setShowLimit(n);break}return}e.data(this,"afStream",new e.afStream(e(this),t))});return}});e.afStream=function(t,n){this.options=n;this._update_timer=null;var r=this;this.options._available_events=[];for(var i in this.options.event_types){this.options._available_events.push(i)}if(typeof this.options.show_only!=="array"){this.options.show_only=e.merge([],this.options._available_events)}t.append('<div class="stream-empty">No events</div>');if(this.options.height){t.css({height:this.options.height,overflow:"hidden"})}this.addEvent=function(n){if(!n.type||!n.message||r.options._available_events.indexOf(n.type)===-1){return}var i=e(n.icon?n.icon:r.options.event_types[n.type].icon?r.options.event_types[n.type].icon:"<div />").addClass("stream-icon"),s=e(r.options.template.replace(/\#\{\{type\}\}/ig,n.type).replace(/\#\{\{time\}\}/ig,timeAgo(n.time=!n.time?new Date:n.time)).replace(/\#\{\{caption\}\}/ig,n.caption?n.caption:r.options.event_types[n.type].caption).replace(/\#\{\{message\}\}/ig,n.message)).prepend(i);e(".stream-empty",t).hide();r.updateTime(true);if(r.options.show_only.indexOf(n.type)===-1){s.css({display:"none"});t.prepend(s)}else{t.prepend(s);s.animate({opacity:1},{duration:1e3})}s.each(function(){e.data(this,"stream-time",n.time)});u();if(r._update_timer){clearTimeout(r._update_timer);r._update_timer=null}if(r.options.update_interval){r._update_timer=setTimeout(o,r.options.update_interval*1e3)}r.options.onEventAdd(t)};var s=function(e){if(typeof e==="string"){e=e.replace(/\s+?/ig,"").split(",")}else{if(typeof e!=="array"){e=[]}}for(var t=0;t<e.length;t++){if(r.options._available_events.indexOf(e[t])===-1){e.splice(t,1)}}return e};this.showEvents=function(n){var i=s(n);for(var o=0;o<i.length;o++){if(r.options.show_only.indexOf(i[o])===-1){r.options.show_only.push(i[o]);e(".stream-event-"+i[o],t).css({display:"block"}).animate({opacity:1},{duration:500})}}u()};this.hideEvents=function(n){var i=s(n);for(var o=0;o<i.length;o++){if(r.options.show_only.indexOf(i[o])!==-1){r.options.show_only.splice(r.options.show_only.indexOf(i[o]),1);e(".stream-event-"+i[o],t).animate({opacity:0},{duration:500,complete:function(){e(this).css({display:"none"})}})}}u()};this.showAllEvents=function(){r.showEvents(r.options._available_events)};this.hideAllEvents=function(){r.hideEvents(r.options._available_events)};this.clearAllEvents=function(){e(".stream-event",t).remove();e(".stream-empty",t).show()};this.setUpdateInterval=function(e){r.options.update_interval=parseInt(e,10);if(r._update_timer){clearTimeout(r._update_timer);r._update_timer=null}if(r.options.update_interval){r._update_timer=setTimeout(o,r.options.update_interval*1e3)}};this.setShowLimit=function(e){r.options.show_limit=parseInt(e,10);u()};this.updateTime=function(n){n=typeof n!=="undefined"?n:false;e(".stream-event",t).each(function(){e(".stream-time",e(this)).text(timeAgo(e.data(this,"stream-time")))});r.options.onTimeUpdate(t);if(!n&&r.options.time_update_interval){setTimeout(r.updateTime,r.options.time_update_interval*1e3)}};if(this.options.time_update_interval){setTimeout(this.updateTime,this.options.time_update_interval*1e3)}var o=function(){r.options.onUpdate(t);if(r._update_timer){clearTimeout(r._update_timer);r._update_timer=null}if(r.options.update_interval){r._update_timer=setTimeout(o,r.options.update_interval*1e3)}};if(this.options.update_interval){this._update_timer=setTimeout(o,this.options.update_interval*1e3)}var u=function(){var n=e(".stream-event",t).filter(":visible");if(n.length===0){return}if(r.options.show_limit&&n.length>r.options.show_limit){n.slice(r.options.show_limit).remove()}if(r.options.height){var i,s=t.offset().top+r.options.height;while((i=n.last()).offset().top>s){i.remove()}}}};e.afStream.options={update_interval:0,time_update_interval:10,height:0,show_limit:0,template:'<div class="stream-event stream-event-#{{type}}"><div class="stream-time">#{{time}}</div><div class="stream-caption">#{{caption}}</div><div class="stream-message">#{{message}}</div></div>',event_types:{},show_only:"all",_available_events:[],onUpdate:function(e){},onEventAdd:function(e){},onTimeUpdate:function(e){}}})(jQuery);(function(e){e.fn.extend({afMap:function(t){if(!t||t&&typeof t!=="string"){t=e.extend({width:"100%",height:300,fullPage:false,mapOptions:{}},t||{})}this.each(function(){var n=null;if(t&&typeof t==="string"){n=e.data(this,"afMap");if(t==="clearCompletedTasks"){n.clearCompletedTasks(this)}return}e.data(this,"afMap",new e.afMap(this,t))});return}});e.afMap=function(t,n){var r=this,i;this.e=e(t);this.options=n;this.resize=function(){var t=e("#left-panel"),n=String(t.css("z-index")),i=e("#main-navbar").height(),s=0,o=0,u=0;if(n!=="1020"){s=e("#left-panel").width();o=e(window).width()-s;u=e(window).height()-i}else{if(n==="1020"){i=i+36;s=0,o=e(window).width(),u=e(window).height()-i}}r.e.css({position:"absolute",top:i,left:s,width:o,height:u})};if(this.options.fullPage){this.resize();e(window).resize(this.resize)}else{if(this.options.width!==null){this.e.css("width",this.options.width)}if(this.options.height!==null){this.e.css("height",this.options.height)}}google.maps.event.addDomListener(window,"load",function(){r.map=new google.maps.Map(r.e.get(0),r.options.mapOptions)})}})(jQuery)